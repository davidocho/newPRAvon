function certonaRecommendations(n){ProductModule.productScope.LoadRecommendedProducts(n.resonance)}function dropdownFormatting(n){var t=n.element,i=$(t).data("imagesrc"),r=$(t).data("displayimage");return i&&r===!0?"<img src='"+i+"' alt='' />"+n.text:n.text}function Autofill(){return{require:"ngModel",link:function(n,t,i,r){n.$on("autofill:update",function(){r.$setViewValue(t.val())})}}}function BagQtyValidDirective(){return{require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){return/^[0-9]\d{0,1}$/.test(n)?(r.$setValidity("avonQtyValid",!0),n):(r.$setValidity("avonQtyValid",!1),undefined)})}}}function BagQtyChangeDirective(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){t.bind("keyup input",function(){r.$modelValue!=null&&onBagChangeQtyThrottled(n,t,i,r)})}}}function CaretFix(){return{restrict:"AC",link:function(n,t){var i=$(t);i.on("focus",function(){setTimeout(function(){var n=i[0],t;typeof n.selectionStart=="number"?n.selectionStart=n.selectionEnd=n.value.length:typeof n.createTextRange!="undefined"&&(n.focus(),t=n.createTextRange(),t.collapse(!1),t.select())},100)})}}}function CompileDirective(n){return function(t,i,r){t.$watch(function(n){return n.$eval(r.compile)},function(r){r&&(i.html(r),n(i.contents())(t))})}}function ConfirmFieldDirective(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){n.$watch(i.ngModel,function(){var t=n.$eval(i.confirmField),u=n[t.form],f=u[t.matchWith].$viewValue,e=u[i.name].$viewValue;f!==e?r.$setValidity("fieldMatch",!1):r.$setValidity("fieldMatch",!0)})}}}function ExpandableDirective(){return{restrict:"A",link:function(n,t,i){var r=$(t);r.addClass("Expandable");r.on("click",function(n){if(!i.expandable||i.expandable!=="false"){var t=$(n.target);t.parents(".ExpandableContent").closest(".Expandable")[0]!=r[0]&&r.toggleClass("Expanded")}});r.on("click",".ExpandableClose",function(){r.removeClass("Expanded")})}}}function FallbackSrcDirective(n){return{restrict:"A",link:function(t,i,r){i.on("load",function(){var r=i.attr("src"),t=new Image,u;if(t.src=r,t.width*t.height==1){i.trigger("error");return}u={element:i,src:r};n.$broadcast("FallbackSrc.ImageFound",u)});i.on("error",function(){var u,t;if(!n.IsPhantom&&(u=new Image,u.src=i.attr("src"),!(u.width*u.height>1))){t=angular.element(this);try{r.fallbackSrc.length>0?(t.attr("src",r.fallbackSrc),r.dontShow&&r.dontShow==="true"&&n.$broadcast("FallbackSrc.FallbackImageLoaded",t)):(t.css("display","none"),t.attr("data-removed","1"),n.$broadcast("FallbackSrc.NoImageFound",t))}catch(f){t.css("display","none");t.attr("data-removed","1");n.$broadcast("FallbackSrc.NoImageFound",t)}finally{t.off("error")}}})}}}function FocusMe(n){return{require:"ngModel",scope:{trigger:"@focusMe"},link:function(t,i){t.$watch("trigger",function(t){t==="true"&&n(function(){i[0].focus()})})}}}function ImgDelaySrcDirective(){return{restrict:"A",scope:!1,link:function(n,t){var r=t.attr("img-delay"),u=parseFloat(r||"1"),i=t.find("+ .ImagePlaceholder");_.delay(function(){if(!t.attr("img-loaded")){t.attr("img-loaded","true");var n=t.attr("img-delay-src");t.attr("src",n);t.on("load",function(){var n=t.attr("style");n&&n.indexOf("display")>=0?t.attr("style",n.replace("none","block")):t.attr("style","display: block");i.length&&_.defer(function(){t.waitForImages({finished:function(){t.trigger("resize");i.addClass("MainImageLoaded");_.delay(function(){i.remove();removeDelayDirectiveContainerStretchStyle(t)},2e3)},waitForAll:!0})})})}},u*1e3)}}}function removeDelayDirectiveContainerStretchStyle(n){var c=n.closest(".LPMImageContainer"),u=c[0],e,f,o,i,s,t,h,r;u&&(u.style.width=null,u.style.height=null);e=n.closest(".article-image-container");f=e[0];f&&(f.style.height=null);o=n.closest(".blog-post-header-image");i=o[0];i&&(i.style.width=null,i.style.height=null);s=n.closest(".image-container");t=s[0];t&&(t.style.width=null,t.style.height=null,t.style.position=null,t.style.margin=null);h=n.closest(".CouponImage");r=h[0];r&&(r.style.width=null,r.style.height=null)}function IncludeRepIdDirective(n){return{restrict:"A",link:function(t,i,r){AvonModule.AvonScope.SessionService.WhenReady().then(function(){var t=r.src;if(t){t.match(/[?&]repid=/gi)||(t+=t.indexOf("?")<0?"?repid=":"&repid=");r.$set("src",n.appendRepIdToPassedUrl(t));return}})}}}function input(){return{require:"?ngModel",priority:1,restrict:"E",link:function(n,t,i,r){if(r&&i.type==="email"){r.$parsers.pop();var u=function(n){var i=r.$name,t=!n||/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(n);return r.$setValidity("email",t),n};r.$parsers.push(u)}}}}function inputMaxlength(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){function f(n){var i=$(t).parent().find(".CharsRemaining");i.length&&i.html((u-n).toString())}function e(n){if(n.length>u){var t=n.substring(0,u);r.$setViewValue(t);r.$render();n=t}return f(n.length),n}var u=Number(i.inputMaxlength);$(t).attr("maxlength",u);_.defer(function(){f($(t).val().length)});r.$parsers.push(e)}}}function inputWaterMark(){return{require:"?ngModel",priority:1,restrict:"E",link:function(n,t,i,r){if(r&&(i.type==="email"||i.type==="text"||i.type==="password"||i.type==="tel")){if(t.parent(".InputContainer").find("label").length==0||t.hasClass("NoInlineWaterMark"))return;t.parent(".InputContainer").addClass("inlineWaterMark");_.defer(function(){var n=!t.val()||t.val().length==0;n===!1&&t.parent(".InputContainer").hasClass("applyInlineWaterMark")==!1&&t.parent(".InputContainer").addClass("applyInlineWaterMark")});t.bind("focus",function(){var n=t.parent(".InputContainer");n.hasClass("applyInlineWaterMark")==!1&&n.addClass("applyInlineWaterMark")}).bind("blur",function(){if(!t.val()||t.val().length==0){var n=t.parent(".InputContainer");n.removeClass("applyInlineWaterMark")}})}}}}function linenumberField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.linenumberField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var i=n.charCode||n.keyCode||0,r=!0,f=$(this),u;switch(i){case 8:case 9:case 13:case 46:case 37:case 39:r=!0;break;default:n.shiftKey===!0&&(r=!1);r&&(u=f.data("maxlength")||t.attr("maxlength"),$.isNumeric(u)&&u>0&&f.val().length>=u&&(r=!1));r&&(r=i>=48&&i<=57||i>=96&&i<=105||i===173||i===45||i===189||i===109);n.ctrlKey===!0&&(r=!0)}return r?!0:(n.preventDefault(),!1)})}}}function numericField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.numericField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var r=n.charCode||n.keyCode||0,i=!0,f=$(this),u,e;switch(r){case 8:case 9:case 13:case 46:case 37:case 39:i=!0;break;default:n.shiftKey===!0&&(i=!1);i&&(u=f.data("maxlength")||t.attr("maxlength"),e=f.val().length-(t.get()[0].selectionEnd-t.get()[0].selectionStart),$.isNumeric(u)&&u>0&&e>=u&&(i=!1));i&&(i=r>=48&&r<=57||r>=96&&r<=105);n.ctrlKey===!0&&(i=!0);n.metaKey===!0&&(i=!0)}return i?!0:(n.preventDefault(),!1)})}}}function phoneNumber(n,t){return{restrict:"A",require:"ngModel",priority:1,link:{post:function(i,r,u,f){var e=function(){for(var t=r.val().replace(/[^0-9.]/g,""),i=r[0].selectionStart;t[0]==="0"||t[0]==="1";)t=t.substr(1);r.val(n("telephone")(t,!1));(i===4||i===8)&&i++;r[0].selectionStart=i;r[0].selectionEnd=i;f.$setViewValue(t)};f.$parsers.push(function(n){return n.replace(/[^0-9.]/g,"")});f.$render=function(){(f.$viewValue==="1"||f.$viewValue==="0")&&(f.$viewValue="");r.val(n("telephone")(f.$viewValue,!1))};r.bind("keydown",function(n){var i=n.keyCode;i===91||15<i&&i<19||37<=i&&i<=40||t.defer(e)});r.bind("paste cut",function(){t.defer(e)})}}}}function phonenumberField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.phonenumberField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var i=n.keyCode||n.which||0,r=!0,f=$(this),u;switch(i){case 8:case 9:case 13:case 46:case 37:case 39:r=!0;break;default:n.shiftKey===!0&&(r=!1);r&&(u=f.data("maxlength")||t.attr("maxlength"),$.isNumeric(u)&&u>0&&f.val().length>=u&&(r=!1));r=r&&f.val().length>0?i>=48&&i<=57||i>=96&&i<=105||n.which==40||n.which==41||i===173||i===45||i===189||i===109:i>=48&&i<=57||i>=96&&i<=105||n.which==40||n.which==41;n.ctrlKey===!0&&(r=!0)}return r?!0:(n.preventDefault(),!1)})}}}function preventDefault(){return{restrict:"AC",link:function(n,t){t.on("click",function(n){return n.preventDefault(),!1})}}}function SecondaryImageDirective(n){return{restrict:"A",link:function(t,i){i[0].onload=function(){var t=i.attr("src"),f=t.lastIndexOf("_"),e=t.lastIndexOf("."),r={element:i,src:t},o=t.substring(f+1,e),u=parseInt(o);isNaN(u)?n.$broadcast("SecondaryImage.ImageFound",r,0):n.$broadcast("SecondaryImage.ImageFound",r,u)};i.on("error",function(){var r=new Image,u;if(r.src=i.attr("src"),!(r.width*r.height>1)){u=angular.element(this);try{var t=r.src,e=t.lastIndexOf("_"),o=t.lastIndexOf("."),f=t.substring(e+1,o);parseInt(f)<10?(t=t.substring(0,e+1)+(parseInt(f)+1)+t.substring(o),u.attr("src",t)):parseInt(f)>=10&&n.$broadcast("SecondaryImage.NoImageFound",u)}catch(s){n.$broadcast("SecondaryImage.NoImageFound",u)}}})}}}function SelectRegularExpressionValidator(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){n.$watch(i.ngModel,function(t){var u=n.$eval(i.ngPattern),f=new RegExp(u);f.test(t)?r.$setValidity("invalidValue",!0):r.$setValidity("invalidValue",!1)})}}}function SingleExpandableDirective(){return{restrict:"A",link:function(n,t){var i=$(t);i.addClass("SingleExpandable");$(document).on("click",function(){$(".SingleExpandable.Expanded").removeClass("Expanded")});i.on("click",function(n){n.stopPropagation();var t=$(n.target);t.hasClass("ExpandableClose")?i.removeClass("Expanded"):(t[0]==i[0]||t.parents(".SingleExpandable")[0]!=i[0])&&($(".SingleExpandable.Expanded").removeClass("Expanded"),i.toggleClass("Expanded"))})}}}function textareaWaterMark(){return{restrict:"E",require:"ngModel",link:function(n,t){t.parent(".InputContainer").find("label").length==0||t.hasClass("NoInlineWaterMark")||(t.parent(".InputContainer").addClass("inlineWaterMark textareaInlineWaterMark"),_.defer(function(){var n=!t.val()||t.val().length==0;n===!1&&t.parent(".InputContainer").hasClass("applyInlineWaterMark")==!1&&t.parent(".InputContainer").addClass("applyInlineWaterMark")}),t.bind("focus",function(){var n=t.parent(".InputContainer");n.hasClass("applyInlineWaterMark")==!1&&(n.addClass("applyInlineWaterMark"),t.data("placeholder",t.attr("placeholder")).attr("placeholder",""))}).bind("blur",function(){if(!t.val()||t.val().length==0){var n=t.parent(".InputContainer");n.removeClass("applyInlineWaterMark");t.attr("placeholder",t.data("placeholder"))}}))}}}function ViewmoreDirective(){return{restrict:"E",link:function(n,t,i){var r=$(t),s=i.moretext||"Read More�",e=i.lesstext,o=i.href,u=i.applyclass,f;u=u?" "+u:"";f=function(){var n=r.find(".ViewMoreContainer").height(),t=r.find(".ViewMoreContent").height();n>=t?r.addClass("FullyVisible"):r.removeClass("FullyVisible")};n.$watch(function(){r.hasClass("Expanded")||f()});r.addClass("ViewMore");r.wrapInner("<div class='ViewMoreContent'><\/div>");r.wrapInner("<div class='ViewMoreContainer"+u+"'><\/div>");r.append("<div class='fadeout'><\/div>");r.append("<div class='ViewMoreBtn'>");r.append("<a class='ViewMoreButton'>"+s+"<\/a>");e&&r.append("<a class='ViewLessButton'>"+e+"<\/a>");r.append("<\/div>");r.find(".ViewMoreButton").click(function(){o?n.RedirectToUrl(o,!0):(r.removeClass("FullyVisible"),r.addClass("Expanded"))});r.find(".ViewLessButton").click(function(){r.removeClass("Expanded")});f()}}}function validateAddress(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^[\\0-9A-Za-zñÑáÁéÉíÍóÓúÚüÜ\\/\\.\\'\\,\\#\\ \\s\\-]+$/.test(n);return r.$setValidity("validateAddress",t),n})}}}function validateCity(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){var u=function(n){var i=r.$name,t=!n||/^[A-Za-zñÑáÁéÉíÍóÓúÚüÜ\.\-\ ]+$/.test(n);return r.$setValidity("validateCity",t),n};r.$parsers.unshift(u);r.$formatters.unshift(u)}}}function validateMustqqualto(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(t){var u=i.validateMustequalto,f=_.find(n,function(n){return n&&n[u]}),e=f[u].$viewValue,o=!t||t===e;return r.$setValidity("mustequalto",o),t})}}}function validateName(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^(-)?[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\\s\\ \\.]+(-)?[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\\s\\ \\.]*(-)?$/.test(n);return r.$setValidity("validateName",t),n})}}}function validatePhone(){return{restrict:"A",require:"ngModel",priority:0,scope:{field:"@validatePhone",maxlength:"@maxlength"},link:{pre:function(n,t,i,r){r.$parsers.unshift(function(t){n.maxlength||(n.maxlength=3);t.length===10&&t.indexOf("-")===-1&&(t=t.substr(0,3)+"-"+t.substr(3,3)+"-"+t.substr(6,4));var i=new RegExp("^[0-9-]{"+n.maxlength+"}$"),u=!t||i.test(t);return r.$setValidity("format",u),t&&n.field==="Area"&&parseInt(t.substr(0,1))<2&&r.$setValidity("format",!1),t})}}}}function validateRegex(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var f=r.$name,t=new RegExp(i.validateRegex),u=!n||t.test(n);return r.$setValidity("regex",u),n})}}}function validateZipcode(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^\d{5}|\d{9}$/.test(n);return r.$setValidity("validateZipcode",t),n})}}}function validateZipCodeRecognized(n){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){u.zipCodesValidated=[];var f=i,e=function(t){t=t.toString();var i=!0;return n.get("/api/validation/isrecognizedzipcode/"+t,{cache:!1}).then(function(n){n.data.valid||(i=!1)},function(){return!0}),i};u.$parsers.unshift(function(n){var o=u.$name,r=!0,t,i;return(o==="CheckoutStep1Model_BillingZip"&&(t=f.closest("form"),t&&(i=t.find("input#SharedAddressDetailsInput"),i&&(r=!i[0].checked))),!n||n.length<5)?(u.$setValidity("validateZipcodeRecognized",!0),n):(r&&(e(n)?u.$setValidity("validateZipcodeRecognized",!0):u.$setValidity("validateZipcodeRecognized",!1)),n)})}}}function validateZipcodeRequired(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){var u=function(n){var u=r.$name,i=$(t).closest("form");i.hasClass("ZipCodeRequired")?n?r.$setValidity("zipcoderequired",!0):r.$setValidity("zipcoderequired",!1):r.$setValidity("zipcoderequired",!0)};r.$parsers.unshift(function(n){return u(n),n});r.$formatters.unshift(function(n){return u(n),n})}}}var JSON,__extends,AvonSiteArea,AjaxError,BrandType,CategoryType,CanBuy,CreditCardDisplayMode,CreditCardType,DeliveryType,FindARepSearchType,ImageType,InterestType,Month,OrderStatus,OrderType,PaymentType,ShippingOptionCode,PromoConditionalRuleReason,TabToggleMode,VariantType,RestrictedAutoRepType,CarouselType,BootstrapEnvironment,CustomerType,WishListItemActionButton,WishListShareType,DualPurchase,ConsolidationOption,AddressType,BagServiceModule,SessionServiceModule,CdnServiceModule,UrlServiceModule,BaseAngularController,BaseAnimations,AllCategoryModule,EnglishMessages,SpanishMessages,ModalServiceModule,ResetPasswordModel,LoginServiceModule,SubscribeServiceModule,AvonModule,ContactModule,EarmarkModule,EmailSignupFormSubmittedModule,FundraiserBannerModule,ProductServiceModule,ProductModule,MiniSiteModule,NotifyMeModule,PageTimeoutWarningModule,ProductDetailModule,ProductListServiceModule,ProductListControlModule,SearchResultsModule,SimpleProductListModule,SiteMapModule,SubscribeModule,VideoShareModule,WelcomeBackModule,SocialShareServiceModule,WishListItem,WishListServiceModule,WishListModule,WishListEmailShareModule,AccordionModule,HtmlEllipsisModule,AutoFocusModule,AvonFormModule,onBagChangeQtyThrottled,CarouselModule,clearServerValidationModule,ElevateZoomModule,ImageAspectModule,ModalDirectiveModule,OnLoadDirectiveModule,PinchZoomCanvasModule,ProductImagesCarouselModule,StackGridModule,TooltipModule,ApplyCouponType,CouponValidationCode,AddressHelper,AutoReplenishStatusCode,AutoReplenishStatusCodeHelper,CreditCardUpdateStatus,BreadcrumbTypes,EmailSubscriptionSource,ProductCategorySection,Level,SortOption,SearchTermType,SliderFacetModelNames,Language,Platform,VideoType,QuizScreenType,TrackingAddToCartType,TrackingEventType,AnalyticsServiceModule,AutoReplenishModule,CelebrosServiceModule,ChangeRepServiceModule,ConfirmationServiceModule,ContactServiceModule,CustomerServiceModule,FacebookServiceModule,FundraiserModule,OnlineStoreModule,HistoryServiceModule,LpmContextMenuServiceModule,NavigationModule,NotifyMeSerivceModule,RegistrationServiceModule,SearchServiceModule,SiteAreaServiceModule,SweepstakesModule,TrackingServiceModule,StringExtensions,ArrayExtensions,Geocode,ProductHelper,Directives,ValidateNotAvailableSoonModule,ValidateSkuNotSubscribedModule,ValidateZipCodeAndGetDetailsModule;JSON||(JSON={}),function(){"use strict";function i(n){return n<10?"0"+n:n}function o(n){return e.lastIndex=0,e.test(n)?'"'+n.replace(e,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var s,l,h,a,v=n,c,e=f[i];e&&typeof e=="object"&&typeof e.toJSON=="function"&&(e=e.toJSON(i));typeof t=="function"&&(e=t.call(f,i,e));switch(typeof e){case"string":return o(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(n+=r,c=[],Object.prototype.toString.apply(e)==="[object Array]"){for(a=e.length,s=0;s<a;s+=1)c[s]=u(s,e)||"null";return h=c.length===0?"[]":n?"[\n"+n+c.join(",\n"+n)+"\n"+v+"]":"["+c.join(",")+"]",n=v,h}if(t&&typeof t=="object")for(a=t.length,s=0;s<a;s+=1)typeof t[s]=="string"&&(l=t[s],h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));else for(l in e)Object.prototype.hasOwnProperty.call(e,l)&&(h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));return h=c.length===0?"{}":n?"{\n"+n+c.join(",\n"+n)+"\n"+v+"}":"{"+c.join(",")+"}",n=v,h}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return u("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(n,t){var r,u,i=n[t];if(i&&typeof i=="object")for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(u=walk(i,r),u!==undefined?i[r]=u:delete i[r]);return reviver.call(n,t,i)}var j;if(text=String(text),f.lastIndex=0,f.test(text)&&(text=text.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse");})}(),function(){var y=this,lt=y._,e={},r=Array.prototype,nt=Object.prototype,at=Function.prototype,p=r.push,t=r.slice,o=r.concat,f=nt.toString,vt=nt.hasOwnProperty,tt=r.forEach,it=r.map,rt=r.reduce,ut=r.reduceRight,ft=r.filter,et=r.every,ot=r.some,s=r.indexOf,st=r.lastIndexOf,yt=Array.isArray,pt=Object.keys,w=at.bind,n=function(t){return t instanceof n?t:this instanceof n?(this._wrapped=t,void 0):new n(t)},i,b,k,h,c,d,l,a,u,ht,ct,v;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports._=n):y._=n;n.VERSION="1.5.2";i=n.each=n.forEach=function(t,i,r){var u,f;if(null!=t)if(tt&&t.forEach===tt)t.forEach(i,r);else if(t.length===+t.length){for(u=0,f=t.length;f>u;u++)if(i.call(r,t[u],u,t)===e)return}else for(var o=n.keys(t),u=0,f=o.length;f>u;u++)if(i.call(r,t[o[u]],o[u],t)===e)return};n.map=n.collect=function(n,t,r){var u=[];return null==n?u:it&&n.map===it?n.map(t,r):(i(n,function(n,i,f){u.push(t.call(r,n,i,f))}),u)};b="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(t,r,u,f){var e=arguments.length>2;if(null==t&&(t=[]),rt&&t.reduce===rt)return f&&(r=n.bind(r,f)),e?t.reduce(r,u):t.reduce(r);if(i(t,function(n,t,i){e?u=r.call(f,u,n,t,i):(u=n,e=!0)}),!e)throw new TypeError(b);return u};n.reduceRight=n.foldr=function(t,r,u,f){var o=arguments.length>2,e,s;if(null==t&&(t=[]),ut&&t.reduceRight===ut)return f&&(r=n.bind(r,f)),o?t.reduceRight(r,u):t.reduceRight(r);if(e=t.length,e!==+e&&(s=n.keys(t),e=s.length),i(t,function(n,i,h){i=s?s[--e]:--e;o?u=r.call(f,u,t[i],i,h):(u=t[i],o=!0)}),!o)throw new TypeError(b);return u};n.find=n.detect=function(n,t,i){var r;return k(n,function(n,u,f){if(t.call(i,n,u,f))return(r=n,!0)}),r};n.filter=n.select=function(n,t,r){var u=[];return null==n?u:ft&&n.filter===ft?n.filter(t,r):(i(n,function(n,i,f){t.call(r,n,i,f)&&u.push(n)}),u)};n.reject=function(t,i,r){return n.filter(t,function(n,t,u){return!i.call(r,n,t,u)},r)};n.every=n.all=function(t,r,u){r||(r=n.identity);var f=!0;return null==t?f:et&&t.every===et?t.every(r,u):(i(t,function(n,t,i){if(!(f=f&&r.call(u,n,t,i)))return e}),!!f)};k=n.some=n.any=function(t,r,u){r||(r=n.identity);var f=!1;return null==t?f:ot&&t.some===ot?t.some(r,u):(i(t,function(n,t,i){if(f||(f=r.call(u,n,t,i)))return e}),!!f)};n.contains=n.include=function(n,t){return null==n?!1:s&&n.indexOf===s?n.indexOf(t)!=-1:k(n,function(n){return n===t})};n.invoke=function(i,r){var u=t.call(arguments,2),f=n.isFunction(r);return n.map(i,function(n){return(f?r:n[r]).apply(n,u)})};n.pluck=function(t,i){return n.map(t,function(n){return n[i]})};n.where=function(t,i,r){return n.isEmpty(i)?r?void 0:[]:n[r?"find":"filter"](t,function(n){for(var t in i)if(i[t]!==n[t])return!1;return!0})};n.findWhere=function(t,i){return n.where(t,i,!0)};n.max=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!r&&n.isEmpty(t))return-1/0;var f={computed:-1/0,value:-1/0};return i(t,function(n,t,i){var e=r?r.call(u,n,t,i):n;e>f.computed&&(f={value:n,computed:e})}),f.value};n.min=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!r&&n.isEmpty(t))return 1/0;var f={computed:1/0,value:1/0};return i(t,function(n,t,i){var e=r?r.call(u,n,t,i):n;e<f.computed&&(f={value:n,computed:e})}),f.value};n.shuffle=function(t){var u,f=0,r=[];return i(t,function(t){u=n.random(f++);r[f-1]=r[u];r[u]=t}),r};n.sample=function(t,i,r){return arguments.length<2||r?t[n.random(t.length-1)]:n.shuffle(t).slice(0,Math.max(0,i))};h=function(t){return n.isFunction(t)?t:function(n){return n[t]}};n.sortBy=function(t,i,r){var u=h(i);return n.pluck(n.map(t,function(n,t,i){return{value:n,index:t,criteria:u.call(r,n,t,i)}}).sort(function(n,t){var i=n.criteria,r=t.criteria;if(i!==r){if(i>r||i===void 0)return 1;if(r>i||r===void 0)return-1}return n.index-t.index}),"value")};c=function(t){return function(r,u,f){var e={},o=null==u?n.identity:h(u);return i(r,function(n,i){var u=o.call(f,n,i,r);t(e,u,n)}),e}};n.groupBy=c(function(t,i,r){(n.has(t,i)?t[i]:t[i]=[]).push(r)});n.indexBy=c(function(n,t,i){n[t]=i});n.countBy=c(function(t,i){n.has(t,i)?t[i]++:t[i]=1});n.sortedIndex=function(t,i,r,u){var e;r=null==r?n.identity:h(r);for(var s=r.call(u,i),f=0,o=t.length;o>f;)e=f+o>>>1,r.call(u,t[e])<s?f=e+1:o=e;return f};n.toArray=function(i){return i?n.isArray(i)?t.call(i):i.length===+i.length?n.map(i,n.identity):n.values(i):[]};n.size=function(t){return null==t?0:t.length===+t.length?t.length:n.keys(t).length};n.first=n.head=n.take=function(n,i,r){if(null!=n)return null==i||r?n[0]:t.call(n,0,i)};n.initial=function(n,i,r){return t.call(n,0,n.length-(null==i||r?1:i))};n.last=function(n,i,r){if(null!=n)return null==i||r?n[n.length-1]:t.call(n,Math.max(n.length-i,0))};n.rest=n.tail=n.drop=function(n,i,r){return t.call(n,null==i||r?1:i)};n.compact=function(t){return n.filter(t,n.identity)};d=function(t,r,u){return r&&n.every(t,n.isArray)?o.apply(u,t):(i(t,function(t){n.isArray(t)||n.isArguments(t)?r?p.apply(u,t):d(t,r,u):u.push(t)}),u)};n.flatten=function(n,t){return d(n,t,[])};n.without=function(i){return n.difference(i,t.call(arguments,1))};n.uniq=n.unique=function(t,r,u,f){n.isFunction(r)&&(f=u,u=r,r=!1);var s=u?n.map(t,u,f):t,o=[],e=[];return i(s,function(i,u){(r?u&&e[e.length-1]===i:n.contains(e,i))||(e.push(i),o.push(t[u]))}),o};n.union=function(){return n.uniq(n.flatten(arguments,!0))};n.intersection=function(i){var r=t.call(arguments,1);return n.filter(n.uniq(i),function(t){return n.every(r,function(i){return n.indexOf(i,t)>=0})})};n.difference=function(i){var u=o.apply(r,t.call(arguments,1));return n.filter(i,function(t){return!n.contains(u,t)})};n.zip=function(){for(var i=n.max(n.pluck(arguments,"length").concat(0)),r=new Array(i),t=0;i>t;t++)r[t]=n.pluck(arguments,""+t);return r};n.object=function(n,t){if(null==n)return{};for(var r={},i=0,u=n.length;u>i;i++)t?r[n[i]]=t[i]:r[n[i][0]]=n[i][1];return r};n.indexOf=function(t,i,r){if(null==t)return-1;var u=0,f=t.length;if(r){if("number"!=typeof r)return u=n.sortedIndex(t,i),t[u]===i?u:-1;u=0>r?Math.max(0,f+r):r}if(s&&t.indexOf===s)return t.indexOf(i,r);for(;f>u;u++)if(t[u]===i)return u;return-1};n.lastIndexOf=function(n,t,i){var u,r;if(null==n)return-1;if(u=null!=i,st&&n.lastIndexOf===st)return u?n.lastIndexOf(t,i):n.lastIndexOf(t);for(r=u?i:n.length;r--;)if(n[r]===t)return r;return-1};n.range=function(n,t,i){arguments.length<=1&&(t=n||0,n=0);i=arguments[2]||1;for(var r=Math.max(Math.ceil((t-n)/i),0),u=0,f=new Array(r);r>u;)f[u++]=n,n+=i;return f};l=function(){};n.bind=function(i,r){var u,f;if(w&&i.bind===w)return w.apply(i,t.call(arguments,1));if(!n.isFunction(i))throw new TypeError;return u=t.call(arguments,2),f=function(){var e,n;return(this instanceof f)?(l.prototype=i.prototype,e=new l,l.prototype=null,n=i.apply(e,u.concat(t.call(arguments))),Object(n)===n?n:e):i.apply(r,u.concat(t.call(arguments)))}};n.partial=function(n){var i=t.call(arguments,1);return function(){return n.apply(this,i.concat(t.call(arguments)))}};n.bindAll=function(r){var u=t.call(arguments,1);if(0===u.length)throw new Error("bindAll must be passed function names");return i(u,function(t){r[t]=n.bind(r[t],r)}),r};n.memoize=function(t,i){var r={};return i||(i=n.identity),function(){var u=i.apply(this,arguments);return n.has(r,u)?r[u]:r[u]=t.apply(this,arguments)}};n.delay=function(n,i){var r=t.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},i)};n.defer=function(i){return n.delay.apply(n,[i,1].concat(t.call(arguments,1)))};n.throttle=function(n,t,i){var f,e,o,r=null,u=0,s;return i||(i={}),s=function(){u=i.leading===!1?0:new Date;r=null;o=n.apply(f,e)},function(){var h=new Date,c;return u||i.leading!==!1||(u=h),c=t-(h-u),f=this,e=arguments,0>=c?(clearTimeout(r),r=null,u=h,o=n.apply(f,e)):r||i.trailing===!1||(r=setTimeout(s,c)),o}};n.debounce=function(n,t,i){var r,u,f,o,e;return function(){f=this;u=arguments;o=new Date;var s=function(){var h=new Date-o;t>h?r=setTimeout(s,t-h):(r=null,i||(e=n.apply(f,u)))},h=i&&!r;return r||(r=setTimeout(s,t)),h&&(e=n.apply(f,u)),e}};n.once=function(n){var t,i=!1;return function(){return i?t:(i=!0,t=n.apply(this,arguments),n=null,t)}};n.wrap=function(n,t){return function(){var i=[n];return p.apply(i,arguments),t.apply(this,i)}};n.compose=function(){var n=arguments;return function(){for(var t=arguments,i=n.length-1;i>=0;i--)t=[n[i].apply(this,t)];return t[0]}};n.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}};n.keys=pt||function(t){var i,r;if(t!==Object(t))throw new TypeError("Invalid object");i=[];for(r in t)n.has(t,r)&&i.push(r);return i};n.values=function(t){for(var r=n.keys(t),u=r.length,f=new Array(u),i=0;u>i;i++)f[i]=t[r[i]];return f};n.pairs=function(t){for(var r=n.keys(t),u=r.length,f=new Array(u),i=0;u>i;i++)f[i]=[r[i],t[r[i]]];return f};n.invert=function(t){for(var u={},r=n.keys(t),i=0,f=r.length;f>i;i++)u[t[r[i]]]=r[i];return u};n.functions=n.methods=function(t){var i=[];for(var r in t)n.isFunction(t[r])&&i.push(r);return i.sort()};n.extend=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]=t[i]}),n};n.pick=function(n){var u={},f=o.apply(r,t.call(arguments,1));return i(f,function(t){t in n&&(u[t]=n[t])}),u};n.omit=function(i){var f={},e=o.apply(r,t.call(arguments,1));for(var u in i)n.contains(e,u)||(f[u]=i[u]);return f};n.defaults=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]===void 0&&(n[i]=t[i])}),n};n.clone=function(t){return n.isObject(t)?n.isArray(t)?t.slice():n.extend({},t):t};n.tap=function(n,t){return t(n),n};a=function(t,i,r,u){var l,v,h,c,e,o,s;if(t===i)return 0!==t||1/t==1/i;if(null==t||null==i)return t===i;if(t instanceof n&&(t=t._wrapped),i instanceof n&&(i=i._wrapped),l=f.call(t),l!=f.call(i))return!1;switch(l){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:0==t?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if("object"!=typeof t||"object"!=typeof i)return!1;for(v=r.length;v--;)if(r[v]==t)return u[v]==i;if(h=t.constructor,c=i.constructor,h!==c&&!(n.isFunction(h)&&h instanceof h&&n.isFunction(c)&&c instanceof c))return!1;if(r.push(t),u.push(i),e=0,o=!0,"[object Array]"==l){if(e=t.length,o=e==i.length)for(;e--&&(o=a(t[e],i[e],r,u)););}else{for(s in t)if(n.has(t,s)&&(e++,!(o=n.has(i,s)&&a(t[s],i[s],r,u))))break;if(o){for(s in i)if(n.has(i,s)&&!e--)break;o=!e}}return r.pop(),u.pop(),o};n.isEqual=function(n,t){return a(n,t,[],[])};n.isEmpty=function(t){if(null==t)return!0;if(n.isArray(t)||n.isString(t))return 0===t.length;for(var i in t)if(n.has(t,i))return!1;return!0};n.isElement=function(n){return!(!n||1!==n.nodeType)};n.isArray=yt||function(n){return"[object Array]"==f.call(n)};n.isObject=function(n){return n===Object(n)};i(["Arguments","Function","String","Number","Date","RegExp"],function(t){n["is"+t]=function(n){return f.call(n)=="[object "+t+"]"}});n.isArguments(arguments)||(n.isArguments=function(t){return!(!t||!n.has(t,"callee"))});"function"!=typeof/./&&(n.isFunction=function(n){return"function"==typeof n});n.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))};n.isNaN=function(t){return n.isNumber(t)&&t!=+t};n.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==f.call(n)};n.isNull=function(n){return null===n};n.isUndefined=function(n){return n===void 0};n.has=function(n,t){return vt.call(n,t)};n.noConflict=function(){return y._=lt,this};n.identity=function(n){return n};n.times=function(n,t,i){for(var u=Array(Math.max(0,n)),r=0;n>r;r++)u[r]=t.call(i,r);return u};n.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};u={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};u.unescape=n.invert(u.escape);ht={escape:new RegExp("["+n.keys(u.escape).join("")+"]","g"),unescape:new RegExp("("+n.keys(u.unescape).join("|")+")","g")};n.each(["escape","unescape"],function(t){n[t]=function(n){return null==n?"":(""+n).replace(ht[t],function(n){return u[t][n]})}});n.result=function(t,i){if(null==t)return void 0;var r=t[i];return n.isFunction(r)?r.call(t):r};n.mixin=function(t){i(n.functions(t),function(i){var r=n[i]=t[i];n.prototype[i]=function(){var t=[this._wrapped];return p.apply(t,arguments),v.call(this,r.apply(n,t))}})};ct=0;n.uniqueId=function(n){var t=++ct+"";return n?n+t:t};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var g=/(.)^/,wt={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},bt=/\\|'|\r|\n|\t|\u2028|\u2029/g;n.template=function(t,i,r){var f,e;r=n.defaults({},r,n.templateSettings);var h=new RegExp([(r.escape||g).source,(r.interpolate||g).source,(r.evaluate||g).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(h,function(n,i,r,f,e){return u+=t.slice(o,e).replace(bt,function(n){return"\\"+wt[n]}),i&&(u+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),f&&(u+="';\n"+f+"\n__p+='"),o=e+n.length,n});u+="';\n";r.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{f=new Function(r.variable||"obj","_",u)}catch(s){throw s.source=u,s;}return i?f(i,n):(e=function(t){return f.call(this,t,n)},e.source="function("+(r.variable||"obj")+"){\n"+u+"}",e)};n.chain=function(t){return n(t).chain()};v=function(t){return this._chain?n(t).chain():t};n.mixin(n);i(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=r[t];n.prototype[t]=function(){var n=this._wrapped;return i.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],v.call(this,n)}});i(["concat","join","slice"],function(t){var i=r[t];n.prototype[t]=function(){return v.call(this,i.apply(this._wrapped,arguments))}});n.extend(n.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){n[n.Shop=0]="Shop";n[n.Blog=1]="Blog"}(AvonSiteArea||(AvonSiteArea={})),function(n){n[n.None=0]="None";n[n.ValidationErrors=1]="ValidationErrors";n[n.Exception=500]="Exception";n[n.InvalidParameter=3]="InvalidParameter"}(AjaxError||(AjaxError={})),function(n){n[n.None=0]="None";n[n.Facet=1]="Facet";n[n.Minor=2]="Minor";n[n.Major=3]="Major";n[n.Mega=4]="Mega"}(BrandType||(BrandType={})),function(n){n[n.Category=1]="Category";n[n.Brand=2]="Brand"}(CategoryType||(CategoryType={})),function(n){n[n.Unknown=999]="Unknown";n[n.NotForIndividualSale=0]="NotForIndividualSale";n[n.Available=1]="Available";n[n.NoLongerAvailable=2]="NoLongerAvailable";n[n.AvailableSoon=3]="AvailableSoon";n[n.ConditionalProduct=5]="ConditionalProduct";n[n.AutoReplenishmentOnly=7]="AutoReplenishmentOnly";n[n.NotAvailableOnTheOnlineStore=9]="NotAvailableOnTheOnlineStore"}(CanBuy||(CanBuy={})),function(n){n[n.Standard=0]="Standard";n[n.StoredCreditCardSelection=1]="StoredCreditCardSelection";n[n.StoredCreditCardAdd=2]="StoredCreditCardAdd";n[n.StoredCreditCardEdit=3]="StoredCreditCardEdit"}(CreditCardDisplayMode||(CreditCardDisplayMode={})),function(n){n[n.Unknown=0]="Unknown";n[n.Visa=1]="Visa";n[n.MasterCard=2]="MasterCard";n[n.Discover=3]="Discover";n[n.Amex=4]="Amex"}(CreditCardType||(CreditCardType={})),function(n){n[n.None=0]="None";n[n.RepOrDirect=1]="RepOrDirect";n[n.RepOnly=2]="RepOnly";n[n.DirectOnly=3]="DirectOnly"}(DeliveryType||(DeliveryType={})),function(n){n[n.ByName=0]="ByName";n[n.ByAddress=1]="ByAddress"}(FindARepSearchType||(FindARepSearchType={})),function(n){n[n.Original=0]="Original";n[n.XtraLarge=700]="XtraLarge";n[n.Large=420]="Large";n[n.Medium=240]="Medium";n[n.Small=67]="Small";n[n.XtraSmall=50]="XtraSmall"}(ImageType||(ImageType={})),function(n){n[n.Interest=0]="Interest";n[n.Reason=1]="Reason"}(InterestType||(InterestType={})),function(n){n[n.Jan=1]="Jan";n[n.Feb=2]="Feb";n[n.Mar=3]="Mar";n[n.Apr=4]="Apr";n[n.May=5]="May";n[n.Jun=6]="Jun";n[n.Jul=7]="Jul";n[n.Aug=8]="Aug";n[n.Sep=9]="Sep";n[n.Oct=10]="Oct";n[n.Nov=11]="Nov";n[n.Dec=12]="Dec"}(Month||(Month={})),function(n){n[n.OrderProcessing=1]="OrderProcessing";n[n.OrderShipped=2]="OrderShipped";n[n.CreditCardDenied=3]="CreditCardDenied";n[n.NotAvailable=4]="NotAvailable";n[n.AuthorizingCreditCard=5]="AuthorizingCreditCard";n[n.ReferredToCustomerServices=6]="ReferredToCustomerServices";n[n.InvalidShippingAddress=7]="InvalidShippingAddress";n[n.Cancelled=8]="Cancelled";n[n.OrderReturn=9]="OrderReturn";n[n.OrderOnHold=10]="OrderOnHold";n[n.PartialCredit=11]="PartialCredit";n[n.PartialReturn=12]="PartialReturn"}(OrderStatus||(OrderStatus={})),function(n){n[n.Customer=0]="Customer";n[n.Representative=1]="Representative"}(OrderType||(OrderType={})),function(n){n[n.Unknown=0]="Unknown";n[n.CreditCard=1]="CreditCard";n[n.PayPal=2]="PayPal"}(PaymentType||(PaymentType={})),function(n){n[n.notyetspecified=0]="notyetspecified";n[n.shipping_method_1=1]="shipping_method_1";n[n.shipping_method_2=2]="shipping_method_2";n[n.shipping_method_3=3]="shipping_method_3";n[n.shipping_method_4=4]="shipping_method_4";n[n.shipping_method_10=10]="shipping_method_10";n[n.rep_delivery=11]="rep_delivery"}(ShippingOptionCode||(ShippingOptionCode={})),function(n){n[n.NotApplicable=0]="NotApplicable";n[n.CannotBuy=1]="CannotBuy";n[n.CanBuyWhenXaddedToYourBag=2]="CanBuyWhenXaddedToYourBag";n[n.CanBuyWhenSpentX=3]="CanBuyWhenSpentX";n[n.CanBuyWhenXConditionsMet=4]="CanBuyWhenXConditionsMet"}(PromoConditionalRuleReason||(PromoConditionalRuleReason={})),function(n){n[n.OnTabClick=0]="OnTabClick";n[n.OnTabMouseEnter=1]="OnTabMouseEnter";n[n.OnTabMouseLeave=2]="OnTabMouseLeave"}(TabToggleMode||(TabToggleMode={})),function(n){n[n.Fragrance=0]="Fragrance";n[n.Shade=1]="Shade";n[n.Size=2]="Size";n[n.Spf=3]="Spf";n[n.Subscription=4]="Subscription";n[n.Version=5]="Version";n[n.None=6]="None"}(VariantType||(VariantType={})),function(n){n[n.None=0]="None";n[n.IslandState=1]="IslandState";n[n.AlaskaHawaiiNoHazmat=2]="AlaskaHawaiiNoHazmat";n[n.AlaskaHawaiiSomeHazmat=3]="AlaskaHawaiiSomeHazmat";n[n.AlaskaHawaiiAllHazmat=4]="AlaskaHawaiiAllHazmat"}(RestrictedAutoRepType||(RestrictedAutoRepType={})),function(n){n[n.CrossSells=0]="CrossSells";n[n.CustomerBuys=1]="CustomerBuys"}(CarouselType||(CarouselType={})),function(n){n[n.Desktop=0]="Desktop";n[n.Tablet=1]="Tablet";n[n.Mobile=2]="Mobile"}(BootstrapEnvironment||(BootstrapEnvironment={})),function(n){n[n.AttachedEcommerce=0]="AttachedEcommerce";n[n.UnattachedEcommerce=1]="UnattachedEcommerce";n[n.TraditionalShopper=2]="TraditionalShopper";n[n.GuestShopper=3]="GuestShopper";n[n.Lead=4]="Lead";n[n.Unknown=5]="Unknown";n[n.RegisteredCustomerAsGuest=6]="RegisteredCustomerAsGuest"}(CustomerType||(CustomerType={})),function(n){n[n.AddToBag=0]="AddToBag";n[n.AddSubscriptionToBag=1]="AddSubscriptionToBag";n[n.NotifyMe=2]="NotifyMe";n[n.Remove=3]="Remove";n[n.SubscriptionInTheBag=4]="SubscriptionInTheBag";n[n.AlreadySubscribed=5]="AlreadySubscribed"}(WishListItemActionButton||(WishListItemActionButton={})),function(n){n[n.Email=0]="Email";n[n.Facebook=1]="Facebook";n[n.Twitter=2]="Twitter"}(WishListShareType||(WishListShareType={})),function(n){n[n.OneTime=0]="OneTime";n[n.AutoReplenishment=1]="AutoReplenishment"}(DualPurchase||(DualPurchase={})),function(n){n[n.ShipToday=0]="ShipToday";n[n.ShipNextScheduledDate=1]="ShipNextScheduledDate"}(ConsolidationOption||(ConsolidationOption={})),function(n){n[n.Billing=0]="Billing";n[n.Shipping=1]="Shipping"}(AddressType||(AddressType={})),function(n){var t=function(){function n(){}return n.prototype.centerModal=function(){$(".ModalContainer").center()},n.prototype.redirectTo=function(n){var t=top.location.href==n;top.location.href=n;t&&top.location.hash&&($("html, body").animate({scrollTop:0},0),top.location.reload())},n.prototype.showModal=function(n,t,i){var u,f,e,r;u=$("#popupBackground");u.length===0&&($("body").append('<div id="popupBackground"><\/div>'),u=$("#popupBackground"));$("body").addClass("ModalVisible");u.show();f=t.toString()+"px";e=i.toString()+"px";r=$("#"+n);r.show();r.css("width",f);r.css("height",e);r.center()},n.prototype.hideModal=function(n){n!==""&&($("#popupBackground").hide(),$("#"+n).hide(),$("body").removeClass("ModalVisible"))},n}();n.Common=t}(AvonModule||(AvonModule={})),function(n){var t=function(){function t(){this.buttonKeys={EnterKey:13}}return t.prototype.scrollToTop=function(n){var t=0;isMobile()&&(t=1);$("html, body").animate({scrollTop:t},400,"swing",function(){typeof n=="function"&&n.call(this)})},t.prototype.isQapEnvironment=function(){return location.href.indexOf("qap.avon.com")>-1},t.prototype.isQafEnvironment=function(){var n=!1;return $.each(["qaf.avon.com","qaffeat.avon.com","qafpatch.avon.com"],function(t,i){if(location.href.indexOf(i)>-1)return n=!0,!1}),n},t.prototype.isLocalEnvironment=function(){return location.href.indexOf("localhost.avon.com")>-1},t.prototype.rebindAjaxForm=function(n){this.setupFormElements(n);this.setDefaultFormAction(n)},t.prototype.setupFormElements=function(n){var t=$(n),i=$(".FormItem select",t);$("input.NumberInput").handleNumberInput()},t.prototype.setDefaultFormAction=function(t){var i=t.find(".DefaultButton").first();i.length>0&&(t.keypress(function(t){if(t.which===this.buttonKeys.EnterKey&&!n.AvonScope.isLoading)return $("input").blur(),i.focus(),i.click(),!1}),t.find(".SelectBoxed").live("enter",function(){n.AvonScope.isLoading||(i.focus(),i.click())}))},t}();n.CommonMvc=t}(AvonModule||(AvonModule={}));"console"in window||(console={log:function(){}}),function(n){var t=function(){function t(){this.setBreadcrumbs=!0;this.ShowProductList=null;this.CategoryDeepLinksModel=null;this.IsDescendantMegaBrand=null;this.ProductPromotionSpots=null;this.common=new n.Common;this.commonMvc=new n.CommonMvc}return t}();n.Avon=t}(AvonModule||(AvonModule={}));var AVON=new AvonModule.Avon,isMobile=function(){"use strict";return(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/BlackBerry/)||navigator.userAgent.match(/Phone/i))!=null||window.IsMobile},isMobileSite=$("html").hasClass("IsMobileSite");app=isMobile()?angular.module("avonShopApp",["ngAria","ngSanitize","hmTouchEvents","rzModule","ui.bootstrap","ngclipboard"]):angular.module("avonShopApp",["ngAria","ngSanitize","hmTouchEvents","ui.select2","rzModule","ui.bootstrap","ngclipboard"]);angular.element(document).ready(function(){blankshield($("a[target='_blank']"))});app.config(["$compileProvider",function(n){n.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel):/);n.debugInfoEnabled(!1)}]);app.config(["$ariaProvider",function(n){n.config({ariaHidden:!0,ariaChecked:!0,ariaDisabled:!0,ariaRequired:!0,ariaInvalid:!0,ariaMultiline:!0,ariaValue:!0,tabindex:!1,bindKeypress:!0})}]);app.preloadedSafeLoadImages=!1;app.safeLoadImages=function(n){var t=n.find("img[data-src]").not(".ImageNotFound").not(".ImageLoading"),i="/images/Responsive/Product/PhotoNotAvailable.png";t.length&&(app.preloadedSafeLoadImages||(app.preloadedSafeLoadImages=!0,app.preloadImage(i),app.preloadImage("/images/Responsive/Common/Loading.gif")),t.each(function(){var n=$(this),t=n.data("src");t!="loaded"&&(n.addClass("ImageLoading"),n.data("alt",n.attr("alt")),n.attr("alt"," "))}),t.each(function(){var n=$(this),t=n.data("src");if(t!="loaded"){n.on("load",function(){var t=$(this);t.hasClass("ImageNotFound")||(t.attr("alt",n.data("alt")),t.data("src","loaded"));t.removeClass("ImageLoading");t.data("alt","")});if(!AvonModule.AvonScope.IsPhantom)n.on("error",function(){var n=$(this);n.removeClass("ImageLoading");n.addClass("ImageNotFound");n.data("alt","");n.attr("alt","Image not found");n.attr("src",i);n.trigger("ImageNotFound")});n.attr("src",t)}}))};app.preloadImage=function(n){$("<img/>")[0].src=n};app.serializeDate=function(n){return n.toISOString()};app.parseDate=function(n){var t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(n);return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],0))};app.GetQuerystringParameterByName=function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t==null?"":decodeURIComponent(t[1].replace(/\+/g," "))};String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})};String.prototype.formatUrlNugget=function(){return(this||"").toLowerCase().replace(/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,"a").replace(/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,"e").replace(/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,"i").replace(/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,"o").replace(/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g,"u").replace(/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g,"n").replace(/[^a-zA-Z0-9\/\\\+\s+-]/g,"").replace(/[\/\\\s+]/g,"-").replace("--","-").replace("--","-")};String.prototype.format||(String.prototype.format=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return this.replace(/{(\d+)}/g,function(n,i){return typeof t[i]!="undefined"?t[i]:n})}),function(n){var t,i="facebook-jssdk",r;n.getElementById(i)||(t=n.createElement("script"),t.id=i,t.async=!0,r=$("html").hasClass("LangES")?"es_ES":"en_US",t.src="//connect.facebook.net/"+r+"/sdk.js#xfbml=1&version=v2.10",n&&n.getElementsByTagName("head")[0].appendChild(t))}(document);var fbInitDone=!1,fbAsyncInit=function(){fbInitDone||(fbInitDone=!0,window.FB.init({appId:"841975755828277",status:!0,cookie:!0,xfbml:!0,version:"v2.11"}))},AddBagItem=function(){function n(){}return n}(),BaseAvonService=function(){function n(t,i,r){n.rootScope=t;n.http=i;n.q=r}return n.prototype.PostJson=function(t,i,r,u,f,e){var c=this,o,h,l,s;return r===void 0&&(r=null),u===void 0&&(u=!0),f===void 0&&(f=!0),e===void 0&&(e=null),f&&n.rootScope.$broadcast("Do.ResetPageIdleTime"),o={"Content-Type":"application/json; charset=utf-8","Avon-Post-Type":"angular","X-Requested-With":"XMLHttpRequest"},angular.extend(o,e),r&&(h=r.find('input[name="__RequestVerificationToken"]'),h.length&&(l=h.val(),o.__RequestVerificationToken=l)),s=n.http({url:t,cache:!1,dataType:"json",method:"POST",data:JSON.stringify(i),headers:o}),s.success(function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);_.delay(function(){c.ProcessAvonResponse(t)},10)}),s.error(function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);_.delay(function(){c.ProcessAvonResponse(t)},10)}),s},n.prototype.GetJson=function(t,i,r,u,f){i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!0);f===void 0&&(f=!0);f&&n.rootScope.$broadcast("Do.ResetPageIdleTime");var e=n.q.defer(),o=this;return $.ajax({async:i,cache:r,type:"GET",url:t,dataType:"json",beforeSend:function(n){n.setRequestHeader("X-Requested-With","XMLHttpRequest")},success:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.resolve(t);_.delay(function(){o.ProcessAvonResponse(t)},10)},error:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.reject(t);_.delay(function(){o.ProcessAvonResponse(t)},10)}}),e.promise},n.prototype.GetHtml=function(t,i,r,u,f){i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!0);f===void 0&&(f=!0);f&&n.rootScope.$broadcast("Do.ResetPageIdleTime");var e=n.q.defer(),o=this;return $.ajax({async:i,cache:r,type:"GET",url:t,dataType:"html",success:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.resolve(t)},error:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.reject(t);_.delay(function(){o.ProcessAvonResponse(t)},10)}}),e.promise},n.prototype.getBaseUrl=function(){var n=window.location.host;return window.location.protocol+"//"+n},n.prototype.RedirectToErrorPage=function(n){window.location.href="/error500.htm?id="+n},n.prototype.ProcessAvonResponse=function(t){var i,r;if(typeof t=="string"&&t.indexOf('id="page-error500"')>=0){this.RedirectToErrorPage("");return}if(i=t,typeof i.responseJSON!="undefined"&&(i=i.responseJSON),typeof i.responseText!="undefined"&&(i=JSON.parse(i.responseText)),!i.Processed)if(i.Processed=!0,typeof i.AngularResponse=="undefined")n.rootScope.Redirecting||t.status!=200&&t.status!=304||typeof t.status!="undefined"&&t.status!==null&&t.status!==0&&this.RedirectToErrorPage("AjaxError:"+t.status);else switch(i.ErrorCode){case AjaxError.None:i.IdToReplace?BaseAngularController.ProcessAjaxReplacement(i):i.RedirectUrl!==null&&i.RedirectUrl!==""?(n.rootScope.isLoading||n.rootScope.ShowLoading(AVON.messages.spinner_loading),AVON.common.redirectTo(i.RedirectUrl)):i.OpenModalId?(r={AllowExit:!1,Model:null,KeepLoaded:!1,UrlToLoad:null},i.ModalOptions&&(r=i.ModalOptions),n.rootScope.ShowLoading(AVON.messages.spinner_loading),$("#"+i.OpenModalId).trigger("modal",r)):i.Processed=!1;break;case AjaxError.ValidationErrors:i.Processed=!1;break;case AjaxError.Exception:this.RedirectToErrorPage(i.ErrorId)}},n}(),TrackingServiceModule;(function(n){var t=function(n){function t(t,i,r,u){var e=this,f;n.call(this,t,i,r);this.$rootScope=t;this.$window=u;f=_.once(function(){e.Initialize()});t.$on("AvonController.PageCompete",function(){f()})}return __extends(t,n),Object.defineProperty(t.prototype,"UTagData",{get:function(){return this.$window.utag_data},enumerable:!0,configurable:!0}),t.prototype.TrackEvent=function(n){this.UTagLink(n)},t.prototype.TrackEventItem=function(n){var t,r,u,f;switch(n.Type){case TrackingEventType.CartCheckout1:this.UTagLink({event_name:"checkout_billing_shipping"});break;case TrackingEventType.CartCheckout2:this.UTagLink({event_name:"checkout_billing_shipping"});break;case TrackingEventType.CartNewCustAcct:this.UTagLink({event_name:"new_customer_account_created",visitor_customer_id:AvonModule.AvonScope.Session.Customer.CustomerId});break;case TrackingEventType.CartViewBag:this.UTagLink({event_name:"cart_view"});this.UTagData.event_name="cart_view";break;case TrackingEventType.CartViewBagCheckoutButtonClick:this.UTagLink({event_name:"order_checkout",product_fsc:this.UTagData.product_fsc,product_sku:this.UTagData.product_sku,product_quantity:this.UTagData.product_quantity,checkout_button_type:"checkout"});break;case TrackingEventType.CartViewBagPayPalButtonClick:this.UTagLink({event_name:"order_checkout",product_fsc:this.UTagData.product_fsc,product_sku:this.UTagData.product_sku,product_quantity:this.UTagData.product_quantity,checkout_button_type:"paypal"});break;case TrackingEventType.CartViewBagSignInModal:this.UTagLink({event_name:"order_checkout_signin_modal"});break;case TrackingEventType.CartViewBagPayPalModal:t="paypal express modal";this.UTagLink({event_name:t});this.UTagData.order_payment_vendor_status=t;break;case TrackingEventType.CartViewBagPayPalContinue:t="paypal click modal continue";this.UTagLink({event_name:t});this.UTagData.order_payment_vendor_status=t;break;case TrackingEventType.CartViewBagPayPalCancel:t="paypal click modal cancel";this.UTagLink({event_name:t});this.UTagData.order_payment_vendor_status=t;break;case TrackingEventType.EmailConfirmMsg:this.UTagLink({event_name:"email_subscribe_success",email_subscription_type:"footer"});break;case TrackingEventType.EmailPopupServed:this.UTagLink({event_name:"email_modal_display"});break;case TrackingEventType.EmailPopupSubscribed:this.UTagLink({event_name:"email_subscribe_success",email_subscription_type:"modal"});break;case TrackingEventType.FarRecommendaRep:case TrackingEventType.FarLocateMyRep:this.FindARep(n);break;case TrackingEventType.ForgotPassword:this.UTagLink({event_name:"forget_password"});break;case TrackingEventType.HowMayIAssistThankYou:this.UTagData.howmayiassist=n.Data;break;case TrackingEventType.UpdateItemInBag:this.UTagData.product_finding_method=n.Data.findingMethod;this.UTagLink({event_name:"cart_add",product_fsc:[n.Data.Fsc],product_sku:[n.Data.Sku],product_quantity:[n.Data.Quantity],product_finding_method:n.Data.findingMethod});break;case TrackingEventType.LoginSuccessful:this.UTagLink({event_name:"customer_sign_in_success",visitor_customer_id:AvonModule.AvonScope.Session.Customer.CustomerId});break;case TrackingEventType.ProductImageView:r=this.UTagData.product_image_urls?this.UTagData.product_image_urls:[];n.Data&&(u=n.Data.imageIndexes,f=n.Data.profileNumber,u.forEach(function(n){var i=n>1?"_"+n:"",t="prod_"+f+"_xl"+i+".jpg";_.contains(r,t)||r.push(t)}));this.UTagData.product_image_urls=r;break;case TrackingEventType.QuickShopProductView:this.QuickShopModal();break;case TrackingEventType.RegistrationFullPage:this.UTagLink({event_name:"checkout_register_fullpage"});break;case TrackingEventType.SearchResults:var e=n.Data,o=location.href,i=document.referrer;i&&(i.indexOf("?")>-1&&(i=i.split("?")[0]),o=i.replace(/^[^:]+:\/\/[^/]+/,"").replace(/#.*/,""));this.UTagView({event_name:"site_search",site_search_query:e.SearchTerm,site_search_results:n.Data===0?"ZERO":e.SearchResultsCount,site_search_status:n.Data===0?"FAIL":"SUCCESS",site_search_page:o});break;case TrackingEventType.ShopbyProductNumberSearchResults:this.UTagLink({event_name:"shop_product_number_search",shop_by_product_number_campaign:n.Data.campaignNumber,shop_by_product_number_query:n.Data.searchTerm,shop_by_product_number_results:n.Data.resultsNo});break;case TrackingEventType.WishListItemsAdded:this.UTagData.product_finding_method=n.Data.findingMethod;this.UTagLink({event_name:"wishlist_add",product_sku:n.Data.trackingItems,wishlist_state:n.Data.wishListState,product_finding_method:n.Data.findingMethod});break;case TrackingEventType.WishListShared:this.UTagLink({event_name:"wishlist_shared",product_sku:n.Data.trackingItems,social_share_method:n.Data.shareMethod})}},t.prototype.TrackCartRemoveEvent=function(n,t,i,r){this.TrackEvent({event_name:"cart_remove",product_fsc:[n],product_sku:[t],product_business_segment_name:[i.toLowerCase()],product_business_unit_name:[r.toLowerCase()]})},t.prototype.TrackProductViewEvent=function(){var n=this.GetTrackingProductCategory();this.TrackEvent({event_name:"product_view",product_brand_name:this.UTagData.product_brand_name,product_category_name:n})},t.prototype.GetTrackingProductCategory=function(){var n=this.$rootScope.GetValueFromSessionStorage("AvonBreadcrumbs");if(!n)return"";while(!n[n.length-1].HasUrl)n.pop();return _.map(n,function(n){return n.Text}).splice(1).join(">")},t.prototype.UTagLink=function(n){var t=this;n&&(n.server_platform=this.UTagData.server_platform,_.delay(function(){t.WindowUtagLink(n)},250))},t.prototype.WindowUtagLink=function(n){this.$window.utag&&this.$window.utag.link(n)},t.prototype.UTagView=function(n){var t=this;n&&(n.server_platform=this.UTagData.server_platform,_.delay(function(){t.WindowUtagView(n)},250))},t.prototype.WindowUtagView=function(n){this.$window.utag&&this.$window.utag.view(n)},t.prototype.Initialize=function(){var r=$('.Slide[data-module="Featured Shops:"]'),u,n,t,i;r.length>0&&_.each(r,function(n){var t=$(n),i=t.find("img");t.attr("data-module",t.attr("data-module")+i.prop("alt"))});u=$(".ContentModule.GenericGrid");u.each(function(n,t){var i=$(t),r=i.find("div.StackCell");r.each(function(n,t){var i=$(t);i.each(function(n,t){var r=$(t),u=r.find(".ProductItemContainer"),f=u.attr("data-productid");i.attr("data-module",i.attr("data-module")+f)})})});n=$('img[alt="Promotion Banner"]');n.length>0&&n.attr("data-module","promobar");t=$('a[title="Details &amp; Exclusions"]');t.length>0&&t.attr("data-nav","promodetails");i=$("#BeautyProfileContainer a");i.length>0&&i.attr("data-actions","vmo:tryitnow")},t.prototype.FindARep=function(n){this.UTagData.find_a_rep_search_type=n.Data.searchType?n.Data.searchType:"";this.UTagData.find_a_rep_search_city=n.Data.model.City?n.Data.model.City:"";this.UTagData.find_a_rep_search_state=n.Data.model.State?n.Data.model.State:"";this.UTagData.find_a_rep_search_postal=n.Data.model.ZipCode?n.Data.model.ZipCode:"";this.UTagData.find_a_rep_search_status=n.Data.status?n.Data.status:"";this.UTagData.find_a_rep_search_results=n.Data.totalReps?n.Data.totalReps:0;this.UTagLink({event_name:"find_a_rep",find_a_rep_search_city:this.UTagData.find_a_rep_search_city,find_a_rep_search_postal:this.UTagData.find_a_rep_search_postal,find_a_rep_search_state:this.UTagData.find_a_rep_search_state,find_a_rep_search_results:this.UTagData.find_a_rep_search_results,find_a_rep_search_status:this.UTagData.find_a_rep_search_status,find_a_rep_search_type:this.UTagData.find_a_rep_search_type})},t.prototype.QuickShopModal=function(){this.UTagLink({event_name:"product_quickshop_view",content_page_name:this.UTagData.content_page_name,content_page_type:this.UTagData.content_page_type,product:this.UTagData.product,product_availability_status:this.UTagData.product_availability_status,product_business_segment_name:this.UTagData.product_business_segment_name.toLowerCase(),product_business_unit_name:this.UTagData.product_business_unit_name.toLowerCase(),product_category_name:this.UTagData.product_category_name,product_brand_name:this.UTagData.product_brand_name,product_discount_percent:this.UTagData.product_discount_percent,product_finding_method:this.UTagData.product_finding_method,product_fsc:this.UTagData.product_fsc,product_image_count:this.UTagData.product_image_count,product_image_urls:this.UTagData.product_image_urls,product_line_number:this.UTagData.product_line_number,product_list_price:this.UTagData.product_list_price,product_name:this.UTagData.product_name,product_new_status:this.UTagData.product_new_status,product_page_url_path:this.UTagData.product_page_url_path,product_pfid:this.UTagData.product_pfid,product_price:this.UTagData.product_price,product_profile:this.UTagData.product_profile,product_promotion_status:this.UTagData.product_promotion_status,product_quantity:this.UTagData.product_quantity,product_reviews_count:this.UTagData.product_reviews_count,prodcut_reviews_rating:this.UTagData.product_reviews_rating,product_sale_price:this.UTagData.product_sale_price,product_sale_status:this.UTagData.product_sale_status,product_seo_name:this.UTagData.product_seo_name,product_shopbyproductlist:this.UTagData.product_shopbyproductlist,product_sku:this.UTagData.product_sku})},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.TrackingService=t})(TrackingServiceModule||(TrackingServiceModule={}));app.service("trackingService",TrackingServiceModule.TrackingService),function(n){var t=function(n){function t(t,i,r,u,f){n.call(this,t,i,f);this.$rootScope=t;this.$http=i;this.trackingService=r;this.addToBagTrackingService=u}return __extends(t,n),t.prototype.update=function(n){var t=this;return this.PostJson("/api/bag/update",n).success(function(n){var i=n.Data;t.$rootScope.$broadcast("BagService.Update",i)})},t.prototype.ApplyCoupon=function(n,t){var i=this;return this.PostJson("/api/bag/applycoupon",{couponCode:n,isPaymentPage:t}).then(function(n){return n.data.Data&&(n.data.Data.Type=ApplyCouponType.Add,i.$rootScope.$broadcast("BagService.ApplyCouponSuccess",n.data)),n.data.Data})},t.prototype.RemoveCoupon=function(n){var t=this;return this.PostJson("/api/bag/removecoupon",{isPaymentPage:n}).then(function(n){var i=n.data.Data;return i&&(i.Type=ApplyCouponType.Remove,t.$rootScope.$broadcast("BagService.ApplyCouponSuccess",n.data)),n.data.Data})},t.prototype.setPromoCoupon=function(n){this.PostJson("/api/bag/setpromocoupon",{couponCode:n})},t.prototype.updateAutoReplenishmentConsolidationItems=function(){var n=this;return this.PostJson("/api/bag/updateautoreplenishmentconsolidationitems",{}).success(function(){n.$rootScope.$broadcast("BagService.UpdateAutoReplenishmentConsolidationItems")})},t.prototype.autoSubscribeToBagItems=function(n){return this.PostJson("/api/myaccount/autosubscribetoitems",{autoSubscribeToItems:n})},t.prototype.changeRepModal=function(n){this.PostJson("/api/bag/changerep",{returnUrl:n})},t.prototype.addItemToBag=function(n,t,i,r){var u=this;return this.PostJson("/api/bag/additemtobag",{bagItem:n,displayModal:t,fromSavedForLater:r}).success(function(n){var t=n.Data;t&&t.ItemsAdded.length>0&&(u.$rootScope.$broadcast("BagService.AddToBagSuccess",t),u.addToBagTrackingService.TrackItemsAddedToBag(t.ItemsAdded,i,u.$rootScope.Session.Cart.OrderDetails.SubTotal,u.$rootScope.Session.Cart.OrderDetails.ItemCount))}).error(function(){}).then(function(n){return n.Data})},t.prototype.addMultipleItemsToBag=function(n,t,i,r){var u=this;return r===void 0&&(r=!1),this.PostJson("/api/bag/addmultipleitemstobag",{bagItems:n,displayModal:t,displayBasicModal:r}).success(function(n){var t=n.Data;t&&t.ItemsAdded.length>0&&(u.$rootScope.$broadcast("BagService.AddToBagSuccess",t),u.addToBagTrackingService.TrackItemsAddedToBag(t.ItemsAdded,i,u.$rootScope.Session.Cart.OrderDetails.SubTotal,u.$rootScope.Session.Cart.OrderDetails.ItemCount))}).error(function(){})},t.prototype.swapVariants=function(n){var t=this;this.PostJson("/api/bag/SwapVariants",{cartItem:n}).success(function(n){t.$rootScope.$broadcast("BagService.SwapVariantsSuccess",n)}).error(function(){})},t.prototype.lineEntryAddSingleProductToBag=function(n){var t=this,i=[];i.push(n);this.PostJson("/api/bag/lineentryaddtobag",{bagItems:i,conditionalProducts:[]}).success(function(n){var i=n.Data;i&&(t.$rootScope.$broadcast("BagService.LineEntryAddSingleProductToBag",n),t.addToBagTrackingService.TrackItemsAddedToBag(i.ItemsAdded,TrackingAddToCartType.ShopByProductNumber,t.$rootScope.Session.Cart.OrderDetails.SubTotal,t.$rootScope.Session.Cart.OrderDetails.ItemCount))})},t.prototype.lineEntryAddProductsToBag=function(n){var t=this;this.PostJson("/api/bag/lineentryaddtobag",{bagItems:n,conditionalProducts:[]},null,!1).success(function(n){var i=n.Data;i!==null&&(t.$rootScope.$broadcast("BagService.LineEntryAddProductsToBag",n),t.addToBagTrackingService.TrackItemsAddedToBag(i.ItemsAdded,TrackingAddToCartType.ShopByProductNumber,t.$rootScope.Session.Cart.OrderDetails.SubTotal,t.$rootScope.Session.Cart.OrderDetails.ItemCount))}).error(function(){})},t.prototype.addItemToWishlist=function(n){var t=this;this.PostJson("/api/bag/additemtowishlist",{productId:n}).success(function(n){n&&t.$rootScope.$broadcast("BagService.AddToWishlistSuccess",n)})},t.prototype.recalculateBag=function(n){var t=this;this.PostJson("/api/bag/recalculate",{calculateShippingCosts:!0,removeUnavailableProducts:!0,shippingMethod:n}).success(function(n){t.$rootScope.$broadcast("BagService.RecalculateSuccess",n)})},t.prototype.getBag=function(){var n=this;this.GetJson("/api/bag/getbag",!0,!1).then(function(t){n.$rootScope.$broadcast("BagService.GetBagSuccess",t)})},t.prototype.RunPreCheckoutTests=function(){var n=this;this.PostJson("/api/bag/precheckouttests",{}).success(function(t){n.$rootScope.$broadcast("BagService.RunPreCheckoutTests",t)})},t.$inject=["$rootScope","$http","trackingService","addToBagTrackingService","$q"],t}(BaseAvonService);n.BagService=t}(BagServiceModule||(BagServiceModule={}));app.service("bagService",BagServiceModule.BagService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u;this.blankSession={Customer:this.getEmptyCustomer(),Rep:this.getEmptyRep(),LpmPreview:{Hash:0,IsPreviewMode:!1,PreviewAtDate:null},Cart:this.getEmptyCart(),NewHashes:this.getEmptyNewHashes(),ShopperSession:{BillingAddress:AddressHelper.CreateEmptyMyAddressModel(),ShippingAddress:AddressHelper.CreateEmptyMyAddressModel()},AutoReplenishSubscriptions:[],AutoReplenishmentConsolidation:[],Search:{SessionId:"",LogHandle:""},WebSessionId:"",PayPal:{IsAuthenticated:!1},Fundraiser:null}}return __extends(t,n),t.prototype.UpdateBreadcrumbsInSession=function(n){this.PostJson("/api/session/updatebreadcrumbs",{breadcrumbs:n},null,!1)},t.prototype.Initialize=function(){this.$rootScope.SessionReady=!1;this.$rootScope.Session={};this.$rootScope.ExtendDeep(this.$rootScope.Session,this.blankSession);var n=this.$rootScope.GetValueFromSessionStorage(t.sessionName);n?(this.$rootScope.ExtendDeep(this.$rootScope.Session,n),this.$rootScope.SessionReady=!0,AVON.SessionHashes?(this.$rootScope.Session.NewHashes=AVON.SessionHashes,this.UpdateIfOld(this.$rootScope.Session.NewHashes)):this.UpdateFromServer()):this.UpdateFromServer()},t.prototype.UpdateIfOld=function(n){var r,i;return(r=this.$rootScope.Session.Customer.Hash!=n.CustomerHash||this.$rootScope.Session.Cart.Hash!=n.CartHash||this.$rootScope.Session.Rep.Hash!=n.RepHash||this.$rootScope.Session.LpmPreview.Hash!=n.LpmPreviewHash||(this.$rootScope.Session.Fundraiser?this.$rootScope.Session.Fundraiser.Hash:0)!=n.FundraiserHash,r)?(this.$rootScope.Session.NewHashes=n,this.$rootScope.SetValueIntoSessionStorage(t.sessionName,this.$rootScope.Session),this.UpdateFromServer()):(i=$.Deferred(),i.resolve(),i.promise())},t.prototype.UpdateFromServer=function(){var n=this;return t.waitingForServer||(this.$rootScope.SessionReady=!1,t.waitingForServer=$.Deferred(),this.$rootScope.Session.Customer.Hash!=this.$rootScope.Session.NewHashes.CustomerHash,this.$rootScope.Session.Cart.Hash!=this.$rootScope.Session.NewHashes.CartHash,this.$rootScope.Session.Rep.Hash!=this.$rootScope.Session.NewHashes.RepHash,this.GetJson("/api/session/usersession",!0,!1,!1).then(function(i){i.ErrorCode===AjaxError.None?(n.$rootScope.Session=i.Data,n.$rootScope.Session.NewHashes=i.SessionHashes,n.$rootScope.SetValueIntoSessionStorage(t.sessionName,n.$rootScope.Session),n.$rootScope.SessionReady=!0,n.$rootScope.SafeApply(),t.waitingForServer.resolve(n.$rootScope.Session),n.$rootScope.$broadcast("SessionService.SessionUpdated",n.$rootScope.Session),n.trackingService.UTagData&&!n.$rootScope.IsConfirmationPage()&&(n.trackingService.UTagData.cart_subtotal=n.$rootScope.Session.Cart.OrderDetails.SubTotal.toString(),n.trackingService.UTagData.cart_total_quantity=n.$rootScope.Session.Cart.OrderDetails.ItemCount.toString())):t.waitingForServer.reject(n.$rootScope.Session);t.waitingForServer=null})),t.waitingForServer.promise()},t.prototype.UpdateModel=function(n){this.$rootScope.Session=n;this.$rootScope.Session.NewHashes={CartHash:n.Cart.Hash,CustomerHash:n.Customer.Hash,RepHash:n.Rep.Hash,LpmPreviewHash:n.LpmPreview.Hash};this.$rootScope.SetValueIntoSessionStorage(t.sessionName,this.$rootScope.Session);this.$rootScope.SessionReady=!0;this.$rootScope.SafeApply();this.$rootScope.$broadcast("SessionService.SessionUpdated",this.$rootScope.Session)},t.prototype.WhenReady=function(){if(t.waitingForServer)return t.waitingForServer.promise();var n=$.Deferred();return n.resolve(this.$rootScope.Session),n.promise()},t.prototype.GetPwpLogInPixel=function(){var n=this;this.GetJson("/api/session/pwploginpixel",!0,!1,!1).then(function(t){if(t.ErrorCode===AjaxError.None){var i=t.Data;i.DoLogin&&n.$rootScope.$broadcast("SessionService.PwpLogInLogOutPixelReceived",i.PixelUrl)}})},t.prototype.GetPwpLogOutPixel=function(){var n=this;this.GetJson("/api/session/pwplogoutpixel",!0,!1,!1).then(function(t){if(t.ErrorCode===AjaxError.None){var i=t.Data;i.DoLogout&&n.$rootScope.$broadcast("SessionService.PwpLogInLogOutPixelReceived",i.PixelUrl)}})},t.prototype.KeepAlive=function(){this.GetJson("/api/session/keepalive",!0,!1,!1,!1)},t.prototype.SetLanguage=function(n,t){t=t.toLowerCase().replace(/setlang=((en)|(es)|(1)|(2))[\&]?/g,"");t=t.replace(/\?$/,"");this.$rootScope.SetClientLanguage(n);this.$rootScope.ShowLoading(AVON.messages.spinner_loading);this.PostJson("/api/session/setlanguage",{language:n,redirectUrl:t},null,!1)},t.prototype.SwitchView=function(n){var t=window.location.href;this.$rootScope.ShowLoading(AVON.messages.spinner_loading);this.PostJson("/api/viewswitcher/switchview",{mobile:n,returnUrl:t},null,!1)},t.prototype.getEmptyCustomer=function(){return{Hash:0,FirstName:"",LastName:"",Email:"",Phone:"",PasswordHint:"",IsLoggedIn:!1,FacebookId:"0",IsFacebookUser:!1,IsPasswordSet:!1,IsPayPalCustomerLoggedIn:!1,IsAttached:!1,IsEligibleForGuestCheckout:!1,DeliveryType:DeliveryType.DirectOnly,Campaign:AVON.campaign,CustomerId:0,ShopperId:"",BillingAddress:AddressHelper.CreateEmptyAddressModel(),ShippingAddress:AddressHelper.CreateEmptyAddressModel(),EmailSignUpLastShown:"",IsNewVisitor:!1,IsEarmarkClosedPermanently:!1,HideWelcomeBackModal:!1,WishList:null,DidA2HSBannerIOSShow:!1,IsA2HSBannerIOSDismissed:!1}},t.prototype.getEmptyRep=function(){return{Hash:0,Id:0,Name:"",FirstName:"",LastName:"",Address:"",CityStateZip:"",CityState:"",HomepageUrl:"",Phone:"",AlternativePhone:"",WebUrl:"",Status:"",IsInPilot:!1,IsGemini:!1}},t.prototype.getEmptyCart=function(){return{Hash:0,GiftMessage:{IsSet:!1,To:"",From:"",Message:""},OrderDetails:{ItemCount:0,HasHazmatItems:!1,HasRepOnlyItems:!1,HasDirectOnlyItems:!1,HasAutoReplenishItems:!1,HasNonDiscountableItems:!1,RepDeliveryEnabled:!0,DirectDeliveryEnabled:!0,IsShippingOverriddenToFree:!0,Discount:"",EstimatedTax:0,MerchandiseTotal:0,Shipping:0,ShippingSurcharge:0,SubTotal:0,HasRestrictedDeliveryItems:!1,Total:0},ShowPayPalExpress:!1,Campaigns:[],ConditionalProducts:[],OutOfStockProducts:[],UnDeliverableProducts:[],Coupon:{Code:"",Discount:null,DiscountType:null,Message:"",ErrorMessage:"",GiftAward:null},FreeShippingDetails:{IsQualified:!1,ShortFall:"",IsAvailable:!1},MiniBagItems:[],MiniBagOverflow:0,QtyItemsInCart:0,EstimatedTaxZipCode:""}},t.prototype.getEmptyNewHashes=function(){return{CustomerHash:-1,CartHash:-1,RepHash:-1,LpmPreviewHash:-1,AutoReplenishmentSubscription:-1,AutoReplenishmentConsolidation:-1,FundraiserHash:-1}},t.$inject=["$rootScope","$http","$q","trackingService"],t.waitingForServer=null,t.sessionName="AvonShopSession",t}(BaseAvonService);n.SessionService=t}(SessionServiceModule||(SessionServiceModule={}));app.service("sessionService",SessionServiceModule.SessionService),function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,u);this.generateHashCode=function(n){var t=0;try{t=n.split("").reduce(function(n,t){return n=(n<<5)-n+t.charCodeAt(0),n&n},0);t<0&&(t*=-1)}catch(i){t=0}return t};t.rootScope=i;t.http=r;t.q=u;t.SessionService=f;t.clientConfiguration=AVON.ClientConfiguration}return __extends(t,n),t.prototype.getHost=function(n){var i=this.generateHashCode(n),r=AVON.ClientConfiguration.CdnHostPaths.length;return"//"+t.clientConfiguration.CdnHostPaths[i%r]+"/"},t.prototype.mediaImage=function(n){if(!n)return null;"/media/"!==t.clientConfiguration.LpmMediaFolder&&(n=n.replace("/media/",t.clientConfiguration.LpmMediaFolder));var i=this.getHost(n);return n.substr(0,1)=="/"&&(n=n.substr(1)),i+n},t.prototype.productImage=function(n,i,r){var f=i>1?"_"+(i-1):"",e="/prod_"+n+"_xl"+f+".jpg",u=this.getHost(n)+t.clientConfiguration.CdnPaths.Product.replace("[LANG]",AVON.LanguageCode)+e;return typeof r!="undefined"&&r!=null&&r!==0&&(u=u+"?w="+r),u},t.prototype.getProductImageBasedOnNameOrProfile=function(n,t,i,r){return t?this.getProductImage(t,i):this.productImage(n,r,i)},t.prototype.productImageXtraLarge=function(n){return this.getProductImage(n,ImageType.XtraLarge)},t.prototype.productImageLarge=function(n){return this.getProductImage(n,ImageType.Large)},t.prototype.productImageMedium=function(n){return this.getProductImage(n,ImageType.Medium)},t.prototype.productImageSmall=function(n){return this.getProductImage(n,ImageType.Small)},t.prototype.productImageXtraSmall=function(n){return this.getProductImage(n,ImageType.XtraSmall)},t.prototype.getProductImage=function(n,i){return n?this.getHost(n)+t.clientConfiguration.CdnPaths.Product.replace("[LANG]",AVON.LanguageCode)+"/"+n+"?w="+i:"/images/Responsive/Product/PhotoNotAvailable.png"},t.prototype.promoImage=function(n){return this.getHost(n.toString())+t.clientConfiguration.CdnPaths.Promotion.replace("[LANG]",AVON.LanguageCode)+"/promo_"+n+".jpg"},t.prototype.variantImage=function(n){return this.getHost(n)+t.clientConfiguration.CdnPaths.Variant.replace("[LANG]",AVON.LanguageCode)+"/shade_"+n+".gif"},t.prototype.representativeImage=function(n,t){return n?t?this.getHost(n)+"representative/"+n+".jpg?timestamp="+Date.now():this.getHost(n)+"representative/"+n+".jpg":null},t.prototype.fundraiserOrganisationImage=function(n,t){return n?t?this.getHost(n)+"fundraiser/"+n+".jpg?timestamp="+Date.now():this.getHost(n)+"fundraiser/"+n+".jpg":null},t.prototype.brochureImage=function(n){return this.getHost(n)+"catalog/"+AVON.campaign.toString().substring(0,4)+"/"+AVON.campaign.toString().substring(4,6)+"/"+AVON.LanguageCode+"/"+n},t.prototype.variantProductImage=function(n,i){return this.getHost(n)+t.clientConfiguration.CdnPaths.VariantProductImage.replace("[LANG]",AVON.LanguageCode)+"/VARIANT_"+n+".jpg?w="+i},t.$inject=["$rootScope","$http","$q","sessionService","trackingService"],t}(BaseAvonService);n.CdnService=t}(CdnServiceModule||(CdnServiceModule={}));app.service("cdnService",CdnServiceModule.CdnService),function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,u);this.$window=f;t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.Action=function(n,i){for(var e,u=[],f=2;f<arguments.length;f++)u[f-2]=arguments[f];n=n.toLowerCase();i=i.toLowerCase();var o=$("html").attr("lang").substr(0,2),r="",s=_.find(t.rootScope.ClientConfiguration.RouteTranslations,function(t){return t.Controller==i&&(t.Action==n||t.Action=="index"&&n=="")&&t.Language==o});if(s?r=s.Url:(r=o=="es"&&r.indexOf("/es/")===-1?"/es/":"/",r=n=="index"?r+i:r+i+"/"+n),r=r.replace(/{.*}/,""),r=r.replace(/\?.*/,""),r=r.replace(/\/*$/,""),u)for(e=0;e<u.length;e++)r+="/"+u[e];return r},t.prototype.ActionWithQueryString=function(n,i,r){for(var f,e=[],u=3;u<arguments.length;u++)e[u-3]=arguments[u];return f=this.Action(n,i,e),r.length>0&&(f+="?"+t.QueryStringParametersToString(r)),f},t.prototype.AddQueryStringParametersToUrl=function(n,i){var r,u;return i&&i.length>0?(u=n.indexOf("?")>=0?"&":"?",r=""+n+u+t.QueryStringParametersToString(i)):r=n,r},t.prototype.RemoveQueryStringParameterFromUrl=function(n,t){var u,f=n.split("?"),r,o,s;if(f.length>=2){var e=f[1].split("#"),h=encodeURIComponent(t)+"=",i=e[0].split(/[&;]/g);for(r=i.length;r-->0;)i[r].lastIndexOf(h,0)!==-1&&i.splice(r,1);o=i.length>0?"?"+i.join("&"):"";s=e.length>1?"#"+e.slice(1).join("#"):"";u=""+f[0]+o+s}else u=n;return u},t.prototype.GetQueryStringParameterValue=function(n,t){var r=encodeURIComponent(t),u=new RegExp("(?<=[?&])"+r+"=([^&#]+)","gmi"),i=u.exec(n);return i?i[1]:null},t.QueryStringParametersToString=function(n){var f="",r,i,u,t,e;if(n&&n.length>0){for(r=[],i=0,u=n;i<u.length;i++)t=u[i],t.Key&&(e=t.Value?t.Value:"",r.push(encodeURIComponent(t.Key.toLowerCase())+"="+encodeURIComponent(e.toLowerCase())));f+=r.join("&")}return f},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.UrlService=t}(UrlServiceModule||(UrlServiceModule={}));app.service("urlService",UrlServiceModule.UrlService);BaseAngularController=function(){function n(n,t,i){t===void 0&&(t=null);i===void 0&&(i=null);this.ConvertDateStringsToDates=function(n){var i,t,u,r;if(typeof n=="object")for(i in n)n.hasOwnProperty(i)&&(t=n[i],typeof t=="string"&&(u=t.match(this.regexIso8601))?(r=Date.parse(u[0]),isNaN(r)||(n[i]=new Date(r))):typeof t=="object"&&this.ConvertDateStringsToDates(t));return n};n.SafeApply=function(n){var t=this.$root.$$phase;t=="$apply"||t=="$digest"?n&&typeof n=="function"&&n():this.$apply(n)};n.HomePageUrl=AVON.languageId===Language.Spanish?"/es/":"/";n.DisplayCountryName=function(n){var t=AVON.Countries,i;return!t||t.length===0?n:(i=_.find(t,function(t){return t.IsoCode===n}),i)?i.Name:n};n.SignInPageUrl=function(t){var i=n.HomePageUrl+"signin";return t&&(i+="?mode="+t),i};n.SetValueIntoSessionStorage=function(n,t){try{window.sessionStorage[n]=JSON.stringify(t)}catch(i){}};n.GetValueFromSessionStorage=function(n){try{return JSON.parse(window.sessionStorage[n])}catch(t){return null}};n.ShowWishListTooltip=function(t){n.ShowTooltip(t)};n.HideWishListTooltip=function(t){n.HideTooltip(t)};n.ShowTooltip=function(t){var r=$(angular.element(t.currentTarget)[0]),i=r.find(".OverlayContainer");!i||AVON.IsTabletDevice||n.IsMobile||i.addClass("active")};n.HideTooltip=function(n){var i=$(angular.element(n.currentTarget)[0]),t=i.find(".OverlayContainer");t&&t.removeClass("active")};n.HideLineNumber=function(n){return _.contains(["991-025","000-000"],n)};n.UpdateInlineWaterMark=function(){$(".InputContainer.inlineWaterMark").each(function(){var n=$(this),t=n.find("input");t.val()&&t.val().length>0?n.hasClass("applyInlineWaterMark")===!1&&n.addClass("applyInlineWaterMark"):n.hasClass("applyInlineWaterMark")&&t.is(":focus")===!1&&n.removeClass("applyInlineWaterMark")})};n.SetCreditCardType=function(t){if(t){if(!t.CardNumber){t.Type="";return}var i=n.AutoDetectCreditCardType(t.CardNumber);t.Type=i!==CreditCardType.Unknown?i:""}};n.AutoDetectCreditCardType=function(n){return!n||n.length===0?CreditCardType.Unknown:new RegExp("^4[0-9]{6,}$").test(n)?CreditCardType.Visa:new RegExp("^5[1-5][0-9]{5,}$").test(n)||new RegExp("^(222[1-9]|2[3-6][0-9]{2}|27[0-1][0-9]|2720)[0-9]{2,}$").test(n)?CreditCardType.MasterCard:new RegExp("^3[47][0-9]{5,}$").test(n)?CreditCardType.Amex:new RegExp("^6(?:011|5[0-9]{2})[0-9]{3,}$").test(n)?CreditCardType.Discover:CreditCardType.Unknown};n.GetCreditCardTypeImageClass=function(n){if(!n||!n.Type||n.Type==CreditCardType.Unknown)return"";switch(n.Type){case CreditCardType.Amex:return"creditCardTypeImage imageForAmex";case CreditCardType.Discover:return"creditCardTypeImage imageForDiscover";case CreditCardType.MasterCard:return"creditCardTypeImage imageForMasterCard";case CreditCardType.Visa:return"creditCardTypeImage imageForVisa";default:return""}};n.IsCreditCardTypeKnown=function(t){return t?t.CardNumber?t.CardNumber.length>6&&(t.Type==""||t.Type==CreditCardType.Unknown||n.AutoDetectCreditCardType(t.CardNumber)===CreditCardType.Unknown)?!0:!1:!1:!1};n.ExtendDeep=function(t){return angular.forEach(arguments,function(i){i!==t&&angular.forEach(i,function(i,r){t[r]&&t[r].constructor&&t[r].constructor===Object?n.ExtendDeep(t[r],i):t[r]=i})}),t};n.ShowLoading=function(t){t||(t=AVON.messages.spinner_loading);n.$emit("ShowLoading",t)};n.HideLoading=function(){n.$emit("HideLoading")};n.ShowLoginModal=function(i,r){if(t!==null){if(t.EmailSignupModalDisplayed)return;t.LoginModalDisplayed=!0;t.IsEarmarkCollapsed===!1&&$("#earmark-body").addClass("earmark-out")}n.ShowLoading(AVON.messages.spinner_loading);var f=r&&r.length>0?"&returnUrl="+encodeURIComponent(r):"",u=n.$eval(angular.element("#LoginModal").attr("modal"));i?u.UrlToLoad.indexOf(i)===-1&&(u.UrlToLoad=u.UrlToLoad+"?mode="+i+f,angular.element("#LoginModal").attr("modal","{ UrlToLoad : '"+u.UrlToLoad+"' }")):!u||u.UrlToLoad.indexOf("mode")===-1||(u.UrlToLoad=u.UrlToLoad.replace(/\?mode=.*/g,"")+f,angular.element("#LoginModal").attr("modal","{ UrlToLoad : '"+u.UrlToLoad+"' }"));$("#LoginModal").trigger("modal")};n.SecureHtml=function(t){return n.$sce.trustAsHtml(t)};n.RedirectToUrl=function(t,i){i&&n.ShowLoading(AVON.messages.spinner_loading);window.location.href=t};n.IsTouchDevice=function(){return $("html").hasClass("touch")};n.IsBlog=function(){return $("html").hasClass("Blog")};n.IsMobileOrTablet=AVON.IsTabletDevice||n.IsMobile;n.IsSafariBrowser=navigator.userAgent&&!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);n.IsIPad=navigator.platform.match(/(iPad)/i)||navigator.userAgent.match(/(iPad)/i)?!0:!1;n.IsIE9=function(){return $("html").hasClass("ie9")};n.IsEdge=function(){return navigator.userAgent.match(/(Edge)/i)?!0:!1};n.RefreshContextValues=function(n){$("input[ng-model]",n).each(function(){if(angular.element(this).attr("type")!=="checkbox"&&angular.element(this).attr("type")!=="radio"){var n=angular.element(this);n.controller("ngModel").$setViewValue($(this).val())}})};n.IsPoBoxAddress=function(n){for(var i,r=n.length,t=0;t<r;t++)if(i=/(P(\.|-|\/){0,1}(\s){0,1}O(\.|-|\/){0,1}(\s){0,1}(BX|ST OFFICE (BOX|BIN)|BOX|BIN|B(\.){0,1}|DRAWER)|(BOX|BIN)(\.|-|\/){0,1}(\s){0,1})(\.|-|\/){0,1}(\s){0,1}(#|NUMBER|NUM|NO){0,1}(\s){0,1}\d+/i.exec(n[t]),i!=null&&i.length>0)return!0;return!1};n.ScrollIntoView=function(n,t,i){var r;t==null&&(t=-90);r={duration:400,direction:"y",complete:null,offsetY:t};_.delay(function(){$(n).scrollintoview(i!=null?i:r)},100)};n.ScrollToTop=function(n,t,i){var r=0,u;n&&(r=n.offset().top,r+=-90,i&&(r-=90));t?$("html, body").animate({scrollTop:r+"px"},"fast"):$("html, body").animate({scrollTop:r+"px"},0);u=$(".ModalCloseIcon.Close");u==null||n||t||u.click()};n.BroadcastToElement=function(n,t,i){for(var u,f=[],r=3;r<arguments.length;r++)f[r-3]=arguments[r];return u=[i],f&&(u=u.concat(f)),n.$broadcast.apply(this,u)};n.ProcessAjaxValidationErrors=function(t,i){i?i.ServerErrors=t.ValidationErrors:n.ServerErrors=t.ValidationErrors;t.ValidationErrors&&t.ValidationErrors.length&&(i?i.ShowValidation=!0:n.ShowValidation=!0)};n.CleanPrivacyPolicy=function(n){_.isUndefined(n)===!1&&_.delay(function(){n.registrationModel_PrivacyPolicy.$invalid=!0;var t=$("input[name="+n.registrationModel_PrivacyPolicy.$name+"]");t.closest(".FormError").removeClass("FormError")},500)};n.ClearServerErrorsForForm=function(n){angular.forEach(n,function(t,i){_.isUndefined(t)===!1&&_.isEmpty(t)===!1&&_.has(t,"$invalid")&&t.$invalid&&n[i].$setValidity("server",!0)})};var r="xxxxxxxxxxxx",u="xxxxxxxxxxx";n.AppendPlaceholderToCreditCardNumber=function(n){n.CardNumber=r+n.LastFourDigits;n.Type===CreditCardType.Amex&&(n.CardNumber=u+n.LastFourDigits)};n.IsCreditCardNumberPlaceholderOnly=function(n){if(!n.CardNumber||n.CardNumber==null)return!1;var t=n.CardNumber.indexOf(r)>=0;return n.Type==CreditCardType.Amex&&(t=n.CardNumber.indexOf(u)>=0),t};n.SetLanguage=function(t,i){t.preventDefault();var r=$(angular.element(t.currentTarget)[0]).attr("href");r.indexOf("?")<0&&(r+=window.location.search);n.SessionService.SetLanguage(i,r)};n.IsEmailValid=function(n){return/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(n)};n.CheckElementValue=function(t){var i=$(t).val();return!1==n.isNullOrWhiteSpace(i)};n.isNullOrWhiteSpace=function(n){return _.isUndefined(n)||_.isNull(n)||n.trim().length===0};n.isCustomerCookiedToRep=function(){return n.Session.Rep.Id>0};n.isCustomerAttachedToRep=function(){return n.Session.Customer.IsAttached};n.isCustomerAttachedOrCookiedToRep=function(){return n.isCustomerCookiedToRep()||n.isCustomerAttachedToRep()};n.isCustomerAttachedToRemovedRep=function(){return n.Session.Rep.Status=="R"};n.LeftNavigationFlatSelectedFacets=function(){return n.LeftNavigationSelectedFacets.length==0?[]:_(n.LeftNavigationSelectedFacets).chain().pluck("Facets").flatten().value()};n.getValidBagItems=function(n){return _.filter(n,function(n){var t=n.qty;return typeof t=="number"?t!==0:parseInt(t)!==0})};n.IsAndroid=navigator.userAgent.match(/Android/i)?!0:!1;n.isTouchCapableDevice="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;n.removeRepWebUrl=function(n){return n.match(/[?&]rep=/gi)&&(n=n.replace(/\?rep=[^&]*$/gi,""),n=n.replace(/\?rep=[^&]*&/gi,"?"),n=n.replace(/&rep=[^&]*&/gi,"&"),n=n.replace(/&rep=[^&]*$/gi,"")),n};n.IsHomePage=function(){return window.location.pathname===n.HomePageUrl};n.IsHomePagePath=function(t){var i=document.createElement("a");return i.href=t,i.pathname===n.HomePageUrl};n.IsShoppingBagPage=function(){return window.location.pathname==="/bag"||window.location.pathname==="/es/bag"};n.IsConfirmationPage=function(){return window.location.pathname==="/checkout/confirmation"||window.location.pathname==="/es/checkout/confirmation"};n.GetUpdatedUrl=function(t,i){var f=window.location.href.indexOf("?")>-1?"&":"?",r=window.location.href,u=i?i.join(","):null;return window.location.href.toLowerCase().indexOf(t)>-1?r=n.UpdateQueryStringParameter(window.location.href,t,u):u&&(r+=f+t+"="+u),r};n.UpdateQueryStringParameter=function(n,t,i){var f=new RegExp("([?&])"+t+"[^&]*","i"),e=new RegExp("([?&])"+t+"=[^&;]+[&;]?","i"),u=t+"="+i,r="?"+u;return(i?r=n.match(f)!==null?n.replace(f,"$1"+u):n+"&"+u:(r=n.replace(e,"$1"),r=r.replace(/[&;]$/,"")),r.substr(-1)==="?")?r.substr(0,r.length-1):r};n.RemoveQueryStringParameterByName=function(n,t){var u="",f,i,r;if(!t)return u;if(t=t.replace("?",""),t){for(f=encodeURIComponent(n)+"=",i=t.split(/[&;]/g),r=i.length;r-->0;)i[r].lastIndexOf(f,0)!==-1&&i.splice(r,1);return i.length>0?"?"+i.join("&"):""}return u};n.renderDataModPropertyAttribute=function(n){return n?"mp-"+AVON.campaignYear+":"+AVON.campaignNumber+":"+n:""};n.ShowProductRating=function(n){var t=window.ProductModule;return t!=null&&t.productScope!=null?t.productScope.displayProductBasedOnShowHideFlag(n,"IncludeInPowerReviews"):!0};n.HideWelcomeBackModal=function(t){n.SessionService.PostJson("/api/session/hidewelcomebackmodal",{hideModal:t});n.Session.Customer.HideWelcomeBackModal=t};n.ShowSearchBox=!0;n.IsLeavingFundraiserPageWithoutShopping=function(){var t=AVON.Fundraiser,i=window.location.pathname.search("fundraiser")>-1;return!t||!i||!t.IsActive?!1:n.Session.Fundraiser?n.Session.Fundraiser.VanityName!==t.VanityName?!0:!1:!0}}return n.prototype.DefaultImageSize=function(n){n.animate({width:"100%"},300)},n.prototype.ExpandedImageSize=function(n){n.animate({width:ImageType.XtraLarge+"px"},300)},n.ProcessAjaxReplacement=function(n){var t,i=!1,r,u;n.IdToReplace==="(body)"?t=$("body"):n.IdToReplace==="(modal)"?($("#AjaxModal").closest(".ModalContainer").remove(),i=!0,$("#Modals").append("<div id='AjaxModal'><\/div>"),t=$("#AjaxModal")):t=$("#"+n.IdToReplace);AVON.TempModalModel=n.Data;r=angular.element(n.Html);u=AvonModule.AvonScope.compileService(r)(AvonModule.AvonScope,function(n){t.replaceWith(n)});i&&u.trigger("modal")},n.prototype.GetBaseUrl=function(){var n=window.location.host;return window.location.protocol+"//"+n},n.prototype.GetHostName=function(){return document.location.hostname},n.regexIso8601=/^(\d{4}|\+\d{6})(?:-(\d{2})(?:-(\d{2})(?:T(\d{2}):(\d{2}):(\d{2})\.(\d{1,})(Z|([\-+])(\d{2}):(\d{2}))?)?)?)?$/,n}();BaseAnimations=function(){function n(){}return n.prototype.enter=function(n,t,i,r){return r()},n.prototype.leave=function(n,t){return t()},n.prototype.move=function(n,t,i,r){return r()},n.prototype.beforeAddClass=function(n,t,i){i()},n.prototype.addClass=function(n,t,i){return i()},n.prototype.beforeRemoveClass=function(n,t,i){i()},n.prototype.removeClass=function(n,t,i){return i()},n.prototype.allowCancel=function(){return!0},n}(),function(n){"use strict";var r=function(){function n(){this.Caption="";this.Title="";this.IconCode="";this.AlternativeText="";this.IconUrl="";this.IconColor="";this.Url="";this.Id=null;this.Target="";this.SortOrder=null;this.AdditionalLinks=null;this.GroupNames=null;this.GroupedChildren=null;this.Children=null;this.TopPromotionThumbnails=null;this.IncludeInTopNavigation=null;this.IncludeInTopBrandsNavigation=null;this.IncludeInAllBrandsPage=null;this.IncludeInLeftNavigation=null;this.AlphabetLetter=null;this.Type=""}return n}(),t=function(){function n(){}return n.brands="brands",n.brandsES="marcas",n.category="category",n.categoryES="categoría",n.categories="categories",n.categoriesES="categorías",n}(),i;n.GroupNameLower=t;i=function(i){function u(u,f){i.call(this,u);n.allCategoryScope=u;n.allCategoryScope.TopMenuItems=AVON.TopNavigation;n.allCategoryScope.AllBrands=[];f.GetFeaturedBrands();f.GetTopNavigationCategories();n.allCategoryScope.checkGroupName=function(n){var i=n.toLowerCase();return i===t.category||i===t.categoryES||i===t.categories||i===t.categoriesES};n.allCategoryScope.shouldSubCategoryShow=function(n){return n.IncludeInTopNavigation};n.allCategoryScope.$on("NavigationService.MenuLoaded",function(i,u){var o,e,f,s;for(n.allCategoryScope.TopMenuItems=u.Data.TopMenuItems,angular.forEach(n.allCategoryScope.TopMenuItems,function(i){i.Type=="Brand"&&i.Caption&&i.Caption.length>0&&n.allCategoryScope.shouldSubCategoryShow(i)&&(i.IncludeInAllBrandsPage=i.IncludeInTopNavigation,i.AlphabetLetter=i.Caption.charAt(0).toUpperCase(),n.allCategoryScope.AllBrands.push(i));angular.forEach(i.GroupNames,function(r){var u=r.toLowerCase();(u===t.brands||u===t.brandsES)&&angular.forEach(i.GroupedChildren[r],function(t){n.allCategoryScope.shouldSubCategoryShow(t)&&t.IncludeInAllBrandsPage&&t.Caption&&t.Caption.length>0&&(t.AlphabetLetter=t.Caption.charAt(0).toUpperCase(),n.allCategoryScope.AllBrands.push(t))})})}),o=4,e=Math.ceil(n.allCategoryScope.AllBrands.length/4),n.allCategoryScope.AllBrands.sort(function(n,t){var i=n.Caption.toUpperCase(),r=t.Caption.toUpperCase();return i<r?-1:i>r?1:0}),n.allCategoryScope.AllBrandsColumnGrouped=[],f=0;f<o;f++)n.allCategoryScope.AllBrandsColumnGrouped[f]=n.allCategoryScope.AllBrands.slice(e*f,e*(f+1));s="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");angular.forEach(s,function(t){var u=_.where(n.allCategoryScope.AllBrands,{AlphabetLetter:t}).length,i;u===0&&(i=new r,i.AlphabetLetter=t,n.allCategoryScope.AllBrands.push(i))});n.allCategoryScope.AllBrandsAlphaGrouped=_.groupBy(n.allCategoryScope.AllBrands,"AlphabetLetter")})}return __extends(u,i),u.$inject=["$scope","NavigationService"],u}(BaseAngularController);n.AllCategoryController=i}(AllCategoryModule||(AllCategoryModule={}));app.controller("AllCategoryController",AllCategoryModule.AllCategoryController);EnglishMessages=function(){function n(){this.language="en";this.spinner_adding="Adding…";this.spinner_addingToBag="Adding item to bag…";this.spinner_addresses="Updating addresses…";this.spinner_coupon="Updating your Coupon Information…";this.spinner_facebook="Contacting Facebook";this.spinner_login="Signing In…";this.spinner_logout="Signing Out…";this.spinner_loading="Loading…";this.spinner_processing="Processing…";this.spinner_registering="Registering…";this.spinner_remove="Removing Item from bag…";this.spinner_saving="Saving…";this.spinner_searching="Searching…";this.spinner_subscribing="Subscribing…";this.spinner_updatingBag="Updating your bag…";this.spinner_vmo="Loading Virtual Makeover…";this.spinner_changingEmailAddress="Changing Email Address...";this.spinner_updatingEmailAddress="Updating Email Address...";this.spinner_unsubscribing="Unsubscribing...";this.notifyModal_enterValidEmail="Please enter a valid e-mail address";this.product_enterValidQty="You must specify a valid <b>quantity<\/b> of the product when adding to your bag";this.product_enterValidQtyMark="You must specify a valid <b>quantity<\/b> before adding to bag";this.productReviews_noReviewsAvailable="No reviews currently available";this.productTabs_readMore="Read More";this.productTabs_close="Close";this.commonscript_addedToBasketItemOne=" Item Added To Your Bag.";this.commonscript_addedToBasketItemsCount=" Items Added To Your Bag.";this.commonscript_shoppingCartLinkText="View Shopping Bag";this.commonscript_mustSpecifyVersionMsg="You must specify a version of the product when adding to your bag";this.shareemail_subject="Check out this AVON product";this.shareemail_body="[PRODUCTNAME]: [PRODUCTURL]";this.validate_email_required="Email address can not be blank";this.validate_email_invalid="Invalid email address";this.validate_password_required="Password can not be blank";this.validate_password_invalid_format="Password format is not valid";this.validate_password_match="The passwords do not match";this.validate_passwordhint_required="Password hint can not be blank";this.validate_field_required="The field is required";this.validate_email_match="The emails do not match";this.validate_invalid_number="Invalid number";this.validate_invalid_phonenumber="Please adjust your telephone number. Do not use dashes or other symbols, or start the area code with a 0 or 1.";this.English="English";this.Spanish="Spanish";this.coupon_no_change="Coupon Code is not applicable.";this.reCaptchaNotChecked="Please confirm you are not a Robot.";this.reCaptchaErrorMessage="We're sorry, there was an error submitting the form. Please confirm you are not a robot and try submitting again."}return n}();SpanishMessages=function(){function n(){this.language="es";this.spinner_adding="Carga…";this.spinner_addingToBag="Añadiendo a tu bolsa…";this.spinner_addresses="Actualizando direcciones…";this.spinner_coupon="Actualizando información del cupón";this.spinner_facebook="Contactando a Facebook";this.spinner_loading="Cargando…";this.spinner_processing="Procesando…";this.spinner_login="Iniciando sesión…";this.spinner_logout="Salir…";this.spinner_registering="Inscripción en proceso…";this.spinner_remove="Eliminación del artículo de cesta…";this.spinner_saving="Guardando…";this.spinner_searching="Búsqueda…";this.spinner_subscribing="Suscribirse…";this.spinner_updatingBag="Actualizando tu bolsa…";this.spinner_vmo="Cargando Maquillador Virtual…";this.spinner_changingEmailAddress="Cambiando correo electrónico...";this.spinner_updatingEmailAddress="Actualizando correo electrónico...";this.spinner_unsubscribing="Cancelando suscripción...";this.notifyModal_enterValidEmail="Por favor escribe un correo electrónico válido";this.product_enterValidQty="Debes especificar una <b>cantidad<\/b> válida del producto cuando agregas artículos a tu bolsa";this.product_enterValidQtyMark="You must specify a valid <b>quantity<\/b> before adding to bag";this.productReviews_noReviewsAvailable="No hay reseñas disponibles en este momento";this.productTabs_readMore="Seguir leyendo";this.productTabs_close="Contraer texto";this.commonscript_addedToBasketItemOne=" unidad añadida a tu bolsa.";this.commonscript_addedToBasketItemsCount=" unidades añadidas a tu bolsa.";this.commonscript_shoppingCartLinkText="¿Quieres pagar ahora?";this.commonscript_mustSpecifyVersionMsg="Debes especificar una versión válida del producto cuando lo añadas a tu bolsa";this.shareemail_subject="Mira este producto AVON";this.shareemail_body="[PRODUCTNAME]: [PRODUCTURL]";this.validate_email_required="Por favor, ingresa tu dirección de email";this.validate_email_invalid="Dirección de email no válida";this.validate_password_required="Por favor, ingresa tu contrasea tu contraseña";this.validate_password_invalid_format="Formato de password invalido";this.validate_password_match="Las contraseña no coincide";this.validate_passwordhint_required="La pista de contraseña no puede ser blanco";this.validate_field_required="El campo es obligatorio";this.validate_email_match="Los emails no coinciden";this.validate_invalid_number="Número invalido";this.validate_invalid_phonenumber="Ajuste por favor su número de teléfono. No use guiones u otros símbolos, o iniciar el código de área con un 1.";this.English="Inglés";this.Spanish="Español";this.coupon_no_change="El código de cupón no es aplicable.";this.reCaptchaNotChecked="Confirma que no eres un robot.";this.reCaptchaErrorMessage="Lo sentimos, hubo un error en el envío del formulario. Confirma que no eres un robot e inténtalo de nuevo."}return n}(),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r)}return __extends(t,n),t.prototype.ShowModalUrl=function(n,t){t===void 0&&(t=!0);this.GetJson(n,!0,!1,!0,t).then(function(){})},t.prototype.ShowModal=function(n,t,i,r,u){t===void 0&&(t=null);i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!1);var f={AllowExit:r,KeepLoaded:i,ExtractModelToScope:u,Model:t};$(n).trigger("modal",f)},t.prototype.ShowModalWithOptions=function(n,t){$(n).trigger("modal",t)},t.prototype.CloseModal=function(n){n===void 0&&(n=null);n?$(n).trigger("close"):$(".Shown > *[modal]").trigger("close")},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ModalService=t}(ModalServiceModule||(ModalServiceModule={}));app.service("modalService",ModalServiceModule.ModalService);ResetPasswordModel=function(){function n(n,t,i,r,u,f){this.Id=n;this.SecurityToken=t;this.Email=i;this.Password=r;this.PasswordConfirm=u;this.PasswordHint=f}return n}(),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.emailSignUpTrackingService=u;this.displayForgotPassword=!1;this.forgotEmail=""}return __extends(t,n),t.prototype.login=function(n,t,i){var r=this;this.PostJson("/api/login/login",{loginModel:n},t).success(function(n){n.Data.CustomerSilentlyAttached&&r.emailSignUpTrackingService.TrackEmailSignUp(EmailSubscriptionSource.AttachRep);r.$rootScope.$broadcast("LoginService.LoginResponse",n,i)}).error(function(n){r.$rootScope.$broadcast("LoginService.LoginResponse",n,i)})},t.prototype.autoLogin=function(n,t){var i=this;this.PostJson("/api/logIn/logIn",{loginModel:n},t).success(function(n){i.$rootScope.$broadcast("LoginService.AutoLoginResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.AutoLoginResponse",n)})},t.prototype.loginWIthFacebook=function(n,t,i){var r=this;this.PostJson("/api/login/loginwithfacebook",{accessToken:n,password:t,returnUrl:i}).then(function(n){r.$rootScope.$broadcast("LoginService.FacebookLoginResponse",n)})},t.prototype.registerWithFacebook=function(n,t,i){var r=this;this.PostJson("/api/login/registerwithfacebook",{accessToken:n,notifySpecialOffers:t,returnUrl:i}).then(function(n){r.$rootScope.$broadcast("LoginService.FacebookRegisterResponse",n)})},t.prototype.verifySingleSignOn=function(n){var t=this;this.PostJson("/api/login/verifysinglesignon",{securityToken:n}).then(function(n){t.$rootScope.$broadcast("LoginService.VerifySingleSignOnResponse",n)})},t.prototype.updatePrivacyPolicy=function(n){this.PostJson("/api/login/updateprivacypolicy",{privacyPolicyModel:n}).success(function(){}).error(function(){})},t.prototype.convertEmail=function(n,t){var i=this;this.PostJson("/api/login/convertemail",{email:n}).success(function(n){n!==null&&i.$rootScope.$broadcast(t,n)}).error(function(n){i.$rootScope.$broadcast(t,n)})},t.prototype.forgotPassword=function(n,t){var i=this;this.PostJson("/api/login/forgotpassword",{email:t,returnUrl:n}).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ForgotPasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ForgotPasswordResponse",n)})},t.prototype.resetPassword=function(n,t){var i=this;this.PostJson("/api/login/changepassword",{changePasswordModel:n},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ResetPasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ResetPasswordResponse",n)})},t.prototype.changePassword=function(n,t){var i=this;this.PostJson("/api/login/changepassword",{changePasswordModel:n},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ChangePasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ChangePasswordResponse",n)})},t.prototype.sendNewPassword=function(n,t){var i=this;this.PostJson("/api/login/sendnewpassword",{ForgotPasswordModel:{email:n}},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.SendNewPasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.SendNewPasswordResponse",n)})},t.prototype.sendPasswordHint=function(n,t){var i=this;this.PostJson("/api/login/sendpasswordhint",{ForgotPasswordModel:{email:n}},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.SendPasswordHintResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.SendPasswordHintResponse",n)})},t.prototype.logOut=function(n,t,i){t||(t=i);this.PostJson("/api/login/logout",{forgetCompletely:n,redirectUrl:t})},t.prototype.changeRepresentiveModal=function(n,t){var i=this;this.PostJson("/api/login/changerep",{returnUrl:n,mode:"",cookieRepId:t}).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ChangeRepModal",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ChangeRepModal",n)})},t.$inject=["$rootScope","$http","$q","emailSignUpTrackingService"],t}(BaseAvonService);n.LoginService=t}(LoginServiceModule||(LoginServiceModule={}));app.service("loginService",LoginServiceModule.LoginService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.emailSignUpTrackingService=u}return __extends(t,n),t.prototype.getSubscribeMarkup=function(){var n=this;this.GetHtml("/api/subscribe/getSubscribeMarkup",!0,!0,!1).then(function(t){n.$rootScope.$broadcast("SubscribeService.SubscribeMarkupLoaded",t)})},t.prototype.setemailsignupcookie=function(){this.PostJson("/api/subscribe/setemailsignupcookie",null)},t.prototype.subscribeEmail=function(n,t){var i=this;this.PostJson("/api/subscribe/subscribeemail",n,t).success(function(t){t!==null&&(i.emailSignUpTrackingService.TrackEmailSignUp(n.Source),i.$rootScope.$broadcast("SubscribeService.SubscribeResponse",t))}).error(function(n){i.$rootScope.$broadcast("SubscribeService.SubscribeResponse",n)})},t.prototype.emailSignup=function(n,t){var i=this;this.PostJson("/api/subscribe/emailsignup",n,t).success(function(n){n!==null&&i.$rootScope.$broadcast("EmailSignupService.EmailSignupResponse",n)}).error(function(n){i.$rootScope.$broadcast("EmailSignupService.EmailSignupResponse",n)})},t.$inject=["$rootScope","$http","$q","emailSignUpTrackingService"],t}(BaseAvonService);n.SubscribeService=t}(SubscribeServiceModule||(SubscribeServiceModule={}));app.service("subscribeService",SubscribeServiceModule.SubscribeService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);this.$rootScope=i;this.$http=r;this.$q=u;t.rootScope=i}return __extends(t,n),t.prototype.ChangeOnlineStoreLanguage=function(){var n=AVON.LanguageCode==="es"?"en":"es";return this.PostJson("/myavon/api/changeonlinestorelanguage",{language:n},null,null,null,{JwtBearerToken:AVON.AuthenticationToken}).error(function(){t.rootScope.OpenDynamicModal("sessionTimeoutModal",null,t.rootScope)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.NegotiateJwtService=t}(OnlineStoreModule||(OnlineStoreModule={}));app.service("negotiateJwtService",OnlineStoreModule.NegotiateJwtService),function(n){var t=function(t){function i(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){function at(){window.YouTubePlayers&&$.each(window.YouTubePlayers,function(n,t){var i=t.getPlayerState();if(i&&i===1)try{this.pauseVideo()}catch(r){}})}function ot(n){n===void 0&&(n=!0);a.OnlyShowEmailSignupOnhomepage&&(top.location.pathname==="/es/"||top.location.pathname==="/")?ht()&&(n?st():rt()):a.OnlyShowEmailSignupOnhomepage||ht()&&(n?st():rt())}function st(){setTimeout(function(){rt()},a.ShowEmailModalAfterSeconds*1e3)}function rt(){n.AvonScope.IsLoginModalClicked()||(a.EmailSignupModalDisplayed=!0,n.AvonScope.OpenEmailSignupModal())}function ht(){var r=!1,u=$("#earmark-container"),t,i,f;return u.length>0&&u.data("did-earmark-animated")===!1&&u.data("animate-earmark")===!0?!1:n.AvonScope.QueryString().emailsignup==="0"||a.OdsIsDown||document.referrer.indexOf("avonrepresentative.com")>0||document.referrer.indexOf("youravon.com")>0||n.AvonScope.QueryString().c==="repPWP"?(n.AvonScope.Session.Customer.IsNewVisitor&&!n.AvonScope.Session.Customer.EmailSignUpLastShown&&v.setemailsignupcookie(),!1):n.AvonScope.QueryString().emailsignup==="1"&&a.ShowEmailModalAfterSeconds>0?!0:(t=n.AvonScope.QueryString(),t.c&&(t.c.toUpperCase()==="EmailREP".toUpperCase()||t.c.toUpperCase()==="Email".toUpperCase()||t.c.toUpperCase()==="repPWP".toUpperCase())||t.otc&&t.otc.toUpperCase().indexOf("-retargeting".toUpperCase(),t.otc.length-t.otc.length)!==-1)?(n.AvonScope.Session.Customer.IsNewVisitor&&!n.AvonScope.Session.Customer.EmailSignUpLastShown&&v.setemailsignupcookie(),!1):(a.ShowEmailModalAfterSeconds>0&&n.AvonScope.Session.Customer.CustomerId===0&&(n.AvonScope.Session.Customer.IsNewVisitor&&!n.AvonScope.Session.Customer.EmailSignUpLastShown?r=!0:n.AvonScope.Session.Customer.EmailSignUpLastShown&&(i=new Date(n.AvonScope.Session.Customer.EmailSignUpLastShown),i.setDate(i.getDate()+a.HideEmailSignupModalForDays),f=new Date(i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear()).getTime(),(new Date).getTime()>=f&&(r=!0))),r)}function bt(){var n=$(".BannerItem"),t=$("html");t.hasClass("mac")&&t.hasClass("safari")&&(n.css("display","none").height(),n.css("display","table-cell"))}function ct(t){b.removeAttr("style").css({"background-color":n.AvonScope.BannerBackgroundColor,"min-height":n.AvonScope.BannerHeight-t>n.AvonScope.CollapsedBannerHeight?n.AvonScope.BannerHeight-t:n.AvonScope.CollapsedBannerHeight});t>b.height()-t?(b.addClass("CollapsedBanner"),n.AvonScope.DisplayCollapsedBannerOptions=!0,k.is(":visible")&&ft.hide(),ut.removeAttr("style")):t>0?(b.addClass("CollapsedBanner"),n.AvonScope.DisplayCollapsedBannerOptions=!0,k.removeAttr("style"),k.show().css({"margin-top":"-3px",top:n.AvonScope.BannerHeight/2-17}),n.AvonScope.ScrollPageTop=!1):(b.removeClass(),n.AvonScope.DisplayCollapsedBannerOptions=!1)}function kt(){angular.element(".TopSearchContainer").removeClass("TopSearchResultsDisplayed");angular.element(".MainSearchContainer").hide().removeClass("MainSearchResultsDisplayed")}function lt(t){t<=0?(n.AvonScope.ScrollPageTop||(n.AvonScope.FullBannerSetup(),nt.removeAttr("style")),t>0&&(ct(t),nt.removeAttr("style"),nt.removeClass("FixedMenu")),bt()):t>0&&nt.removeAttr("style").css({position:"fixed",top:0,"background-color":"#ffffff","z-index":"20000","padding-top":angular.element(".fixed-top-banner").outerHeight()-10+"px"})}function dt(t){t>=n.AvonScope.BannerHeight-20&&!n.AvonScope.ScrollDown?(n.AvonScope.CollapsedBannerSetup(),lt(t)):t<n.AvonScope.BannerHeight&&t>0&&ct(t)}function gt(){var i=_.include(["iPhone","iPad","iPod"],navigator.platform),t;return i?window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0?!1:n.AvonScope.Session.Customer.IsA2HSBannerIOSDismissed?!1:(n.AvonScope.Session.Customer.DidA2HSBannerIOSShow||(t=n.AvonScope.SessionService.PostJson("/api/session/setAddToHomeScreenIOSBannerIOSShown",null),t.success(function(t){t.Data.didA2HSBannerIOSShow&&(n.AvonScope.Session.Customer.DidA2HSBannerIOSShow=!0)})),!0):!1}var it=this,d,g,et,tt;t.call(this,i,null);this.$rootScope=i;this.sessionService=e;this.modalService=l;this.$window=a;this.fundraiserService=p;this.historyService=w;this.openBrightCoveModalforContent=function(t,i,r,u,f){var o,s,h;u===void 0&&(u=!0);var c=n.AvonScope.IsMobile?345:950,l=n.AvonScope.IsMobile?185:534,e=n.AvonScope.BrightCoveUrl;e=f?e.replace("{PlayerId}",f):e.replace("{PlayerId}",n.AvonScope.BrightCoveDefaultPlayerId);e=e+t;u&&(e=e+"&autoplay=true");o=c;s=l;n.AvonScope.Session.Rep!=null&&(e=e+"&repid="+n.AvonScope.Session.Rep.Id);h={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:e,UseIFrame:!0,IFrameWidth:o+"px",IFrameHeight:s+"px"};n.AvonScope.OpenDynamicModal("VideoModal",h)};n.AvonScope=i;n.AvonScope.Redirecting=!1;n.AvonScope.bagService=r;n.AvonScope.LoginService=c;n.AvonScope.ModalService=l;n.AvonScope.$sce=f;n.AvonScope.campaign=AVON.campaign;n.AvonScope.campaignYear=AVON.campaignYear;n.AvonScope.campaignNumber=AVON.campaignNumber;n.AvonScope.messages=AVON.messages;n.AvonScope.ClientConfiguration=AVON.ClientConfiguration;n.AvonScope.cdn=o;n.AvonScope.SessionService=e;n.AvonScope.compileService=s;n.AvonScope.isPageComplete=!1;n.AvonScope.Url=h;n.AvonScope.IsPhantom=navigator.userAgent.match(/phantom/gi)!=null;n.AvonScope.PageTotalMinutes=0;n.AvonScope.PageIdleMinutes=0;n.AvonScope.SessionMinutes=0;n.AvonScope.YouTubeUrl="https://www.youtube.com/embed/";n.AvonScope.BrightCoveUrl="//players.brightcove.net/5400155206001/{PlayerId}_default/index.html?videoId=";n.AvonScope.BrightCoveDefaultPlayerId="ByjMAo4Zb";n.AvonScope.LoadOperationsCount=0;n.AvonScope.ShowLoadingTimeoutSeconds=2;n.AvonScope.LeftNavigationSelectedLink=-1;n.AvonScope.LeftNavigationPinkLink=-1;n.AvonScope.LeftNavigationSelectedLinkParent=-1;n.AvonScope.LeftNavigationSelectedFacets=[];n.AvonScope.LeftNavigationSelectedDepartmentFacets=[];n.AvonScope.FacetQueryStringParamName="facets";n.AvonScope.RatingsQueryStringParamName="ratings";n.AvonScope.PriceQueryStringParamName="price";n.AvonScope.DiscountQueryStringParamName="discount";n.AvonScope.SortByQueryStringParamName="sortby";n.AvonScope.viewportWidth=$(window).width();n.AvonScope.viewportHeight=$(window).height();n.AvonScope.isPortrait=!1;n.AvonScope.IsOnlineStoreOnEditMode=!1;n.AvonScope.PaymentType=PaymentType;n.AvonScope.AjaxError=AjaxError;n.AvonScope.CanBuy=CanBuy;n.AvonScope.CreditCardDisplayMode=CreditCardDisplayMode;n.AvonScope.CreditCardType=CreditCardType;n.AvonScope.DeliveryType=DeliveryType;n.AvonScope.EmailSubscriptionSource=EmailSubscriptionSource;n.AvonScope.FindARepSearchType=FindARepSearchType;n.AvonScope.ImageType=ImageType;n.AvonScope.InterestType=InterestType;n.AvonScope.Month=Month;n.AvonScope.OrderStatus=OrderStatus;n.AvonScope.OrderType=OrderType;n.AvonScope.PaymentType=PaymentType;n.AvonScope.ShippingOptionCode=ShippingOptionCode;n.AvonScope.PromoConditionalRuleReason=PromoConditionalRuleReason;n.AvonScope.VariantType=VariantType;d=0;g=!1;$(document).ajaxSend(function(){d++});et=$('meta[name="viewport"]').attr("content");navigator.userAgent.match("CriOS")&&$('meta[name="viewport"]').attr("content",et+",initial-scale=1.0");$(document).ajaxComplete(function(){d>0&&(d--,d==0&&n.AvonScope.$broadcast("AvonController.AjaxCallsFinished"))});navigator.userAgent.search("Safari")>=0&&navigator.userAgent.search("Chrome")<0&&$(window).bind("pageshow",function(n){n.originalEvent.persisted&&window.location.reload()});n.AvonScope.appendRepIdToPassedUrl=function(t){return n.AvonScope.Session.Rep!=null?f.trustAsResourceUrl(t+n.AvonScope.Session.Rep.Id):f.trustAsResourceUrl(t)};n.AvonScope.$on("AvonController.AjaxCallsFinished",function(){var t=$("#BodyContent");this.isMobile&&(t=$("#MainContainer"));t.waitForImages(function(){var i=window.location.hash.substring(1),t="[id='"+i+"']";!g&&window.location.hash.length>1&&$(t).length>0&&$(".LooksWeLoveModule .TipsModule").find(t).length==0&&_.delay(function(){g=!0;n.AvonScope.ScrollToTop($(t))},500);!g&&window.location.hash.length>1&&$(t).length>0&&$(".TipsModule").find(t).length>0&&_.delay(function(){g=!0;n.AvonScope.ScrollToTop($(t).closest(".TipsModule"))},500)},undefined,!0)});n.AvonScope.QueryString=function(){for(var n,i=window.location.search.substr(1).split("&"),r=[],t=0;t<i.length;++t)(n=i[t].split("="),n.length==2)&&(r[n[0]]=decodeURIComponent(n[1].replace(/\+/g," ")));return r};AVON.SessionModel?n.AvonScope.SessionService.UpdateModel(AVON.SessionModel):n.AvonScope.SessionService.Initialize();n.AvonScope.SetClientLanguage=function(t){t=="es"?(AVON.messages=new SpanishMessages,n.AvonScope.LanguageCode="es",AVON.LanguageCode="es"):(AVON.messages=new EnglishMessages,n.AvonScope.LanguageCode="en",AVON.LanguageCode="en")};$("html").hasClass("LangES")?n.AvonScope.SetClientLanguage("es"):n.AvonScope.SetClientLanguage("en");n.AvonScope.YouTubeiFrameSrc=function(t,i){return f.trustAsResourceUrl(n.AvonScope.YouTubeUrl+t+"?autohide="+(i?"1":"0")+"&rel=0&showinfo=1&wmode=transparent&enablejsapi=1")};n.AvonScope.YouTubeVideoIdFromUrl=function(n){if(n){var t=n.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/);if(t&&t[2].length===11)return t[2]}return""};n.AvonScope.ValidateYouTubeUrl=function(n){if(n)if(n.match(/^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/))return!0;return!1};n.AvonScope.ImageThumb=function(n){return n.substring(0,n.lastIndexOf("."))+"_thumb."+n.substring(n.lastIndexOf(".")+1,n.length)};n.AvonScope.OpenVideoModal=function(n,t,i,r,u,f){at();var e=$("#MainContent").innerWidth()-160,o=e*.5625;r===VideoType.Youtube?it.openYouTubeModal(n,e,o,t,i):r===VideoType.BrightCove&&it.openBrightCoveModalforContent(n,e,o,f,u)};n.AvonScope.OpenChatBotModal=function(){var t=window.innerHeight-100,i={AllowExit:!0,Model:null,KeepLoaded:!0,UrlToLoad:"https://avon-bot.azurewebsites.net/webclient/",UseIFrame:!0,IFrameWidth:"350px",IFrameHeight:t+"px",IgnoreBackground:!0};n.AvonScope.OpenDynamicModal("ChatBotModal",i)};n.AvonScope.IsLoginModalClicked=function(){return a.LoginModalDisplayed};n.AvonScope.OpenEmailSignupModal=function(){var t;n.AvonScope.OpenDynamicModal("EmailSignupModal",{AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/emailsignup"});t={Type:TrackingEventType.EmailPopupServed};u.TrackEventItem(t)};n.AvonScope.OpenDynamicModal=function(t,i,r){var u,f;$("#Modals #"+t).length==0&&(u=n.AvonScope,r&&(u=r),f=$("<div>",{id:t,modal:"{}"}),$("#Modals").append(f),s($("#"+t))(u));_.defer(function(){$("#"+t).trigger("modal",i)})};n.AvonScope.SessionService.WhenReady().then(function(){ot();it.appendRepToUrl(n.AvonScope.Session);n.AvonScope.a2HSBannerForIOS={canShow:gt()}});n.AvonScope.$on("ModalShown",function(t,i){i==="QuickView"&&(n.AvonScope.IsQuickShopModalOpen=!0);_.delay(function(){n.AvonScope.UpdateInlineWaterMark()},250)});n.AvonScope.$on("ModalClosed",function(t,i){i==="QuickView"&&(n.AvonScope.IsQuickShopModalOpen=!1);a.EmailSignupModalDisplayed&&(v.setemailsignupcookie(),a.EmailSignupModalDisplayed=!1);a.LoginModalDisplayed&&(a.LoginModalDisplayed=!1,ot(!1));$("#QuickView.AddedToBag").removeClass("AddedToBag")});n.AvonScope.passwordRegularExpression=/(?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{6,18})/;n.AvonScope.positiveIntegerRegularExpression=/^[1-9]\d*$/;n.AvonScope.IsAutoReplenishmentInCart=function(){var t=!1;return $.each(n.AvonScope.Session.Cart.Campaigns,function(n,i){$.each(i.Items,function(n,i){i.AutoReplenishmentFrequency>0&&(i.ProductCanBuy===CanBuy.Available&&i.DualPurchaseSelected===DualPurchase.AutoReplenishment||i.ProductCanBuy===CanBuy.AutoReplenishmentOnly)&&(t=!0)})}),t};n.AvonScope.$on("ShowLoading",function(t,i){n.AvonScope.isLoading=!0;var r=function(){var t,r,u;n.AvonScope.loadingMessage=i;n.AvonScope.SafeApply();$("body").addClass("ShowLoading");$("#Loading #LoadingMessage").html("");(n.AvonScope.IsMobile==!1||n.AvonScope.IsMobile==undefined)&&(t=$("#Loading > div"),$("#Loading").height(Math.max($("body").height(),n.AvonScope.viewportHeight)),r=t.outerHeight(),u=Math.max(0,(n.AvonScope.viewportHeight-r)/2)+"px",t.css("margin-top",u))};i===AVON.messages.spinner_loading?setTimeout(function(){n.AvonScope.isLoading&&r()},n.AvonScope.ShowLoadingTimeoutSeconds*1e3):r()});n.AvonScope.$on("HideLoading",function(){n.AvonScope.isLoading=!1;n.AvonScope.SafeApply();$("body").removeClass("ShowLoading")});n.AvonScope.$on("Redirect",function(t,i){n.AvonScope.Redirecting=!0;_.defer(function(){AVON.common.redirectTo(i)})});n.AvonScope.$on("LoginService.VerifySingleSignOnResponse",function(t,i){i.Data===undefined&&(i=i.data);i.Data&&n.AvonScope.SessionService.GetPwpLogInPixel()});n.AvonScope.$on("BaseService.AjaxComplete",function(t,i){i&&(i.SessionModel?n.AvonScope.SessionService.UpdateModel(i.SessionModel):i.SessionHashes&&n.AvonScope.SessionService.UpdateIfOld(i.SessionHashes),(i.RedirectUrl==null||i.RedirectUrl=="")&&(i.HideLoading&&n.AvonScope.isLoading&&_.delay(function(){n.AvonScope.$broadcast("HideLoading")},50),_.defer(function(){return app.safeLoadImages($("body"))})))});n.AvonScope.ShowContactRepModal=function(t,i){var r,u;n.AvonScope.ShowLoading(AVON.messages.spinner_loading);AVON.ContactMeFormModel||(AVON.ContactMeFormModel={RepUrl:"",FirstName:"",LastName:"",EmailAddress:"",Phone:"",PhoneDay:"",PhoneEvening:"",Subject:"",Message:""});r="";t&&t>0&&(r+="?repId="+t);i&&(AVON.ContactMeFormModel.Subject=i,r+=r.length>0?"&":"?",r+="subject="+i);u={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/contact/contactmeform"+r};n.AvonScope.OpenDynamicModal("ContactMeRepModal",u)};n.AvonScope.numberRange=function(n,t){return _.range(n,t+1)};n.AvonScope.$on("AvonController.ShowRepresentativeContactMeForm",function(t,i,r){n.AvonScope.ShowContactRepModal(i,r)});n.AvonScope.checkBoxKeyPress=function(n){var t=$(n.target).find("input");n.which==32?t.length>0&&(n.preventDefault(),t.attr("type")=="checkbox"&&_.defer(function(){t.trigger("click")})):n.which==13&&t.length>0&&(n.preventDefault(),_.defer(function(){t.parents("form").find(".HiddenSubmit").click()}))};n.AvonScope.ieSubmitKeyPress=function(n){var t=$(n.target);n.which==13&&$(".ie").length>0&&t.length>0&&(n.preventDefault(),_.defer(function(){t.parents("form").find(".HiddenSubmit").click()}))};n.AvonScope.ProcessPwpLogInLogOut=function(){parseInt(n.AvonScope.QueryString().dopwplogin)===1?n.AvonScope.SessionService.GetPwpLogInPixel():parseInt(n.AvonScope.QueryString().dopwplogout)===1&&n.AvonScope.SessionService.GetPwpLogOutPixel()};_.defer(function(){n.AvonScope.ProcessPwpLogInLogOut();var t=app.GetQuerystringParameterByName("videoId"),i=parseInt(app.GetQuerystringParameterByName("videoType")),r=parseInt(app.GetQuerystringParameterByName("start"));t.length>0&&n.AvonScope.OpenVideoModal(t,!1,r,i||0,null,!1)});n.AvonScope.$on("SessionService.PwpLogInLogOutPixelReceived",function(n,t){app.preloadImage(t)});n.AvonScope.$on("Do.ResetPageIdleTime",function(){n.AvonScope.PageIdleMinutes=0});n.AvonScope.ExpandTooltipInfo=!1;n.AvonScope.CloseTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo=!1};n.AvonScope.OpenTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo=!0;n.AvonScope.ScrollIntoView($(".InfoPanel"))};n.AvonScope.ToggleTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo?n.AvonScope.CloseTooltipInfo():n.AvonScope.OpenTooltipInfo()};var b=$("#BannerSection"),k=$("#CollapsedBannerOptions"),vt=$("#TopUtilityBarContainer"),nt=$("#TopNavigationContainer"),ut=$(".BannerItem"),ft=$("#HeadLogoSection .search-container-inner"),yt=$(".BannerItemLine"),pt=$("#BannerPageWidth"),wt=AVON.IsTabletDevice||n.AvonScope.IsMobile;n.AvonScope.BannerHeight=isNaN(parseFloat(b.data("height")))?0:parseFloat(b.data("height"));n.AvonScope.CollapsedBannerHeight=parseFloat(b.data("collapsedheight"));n.AvonScope.BannerBackgroundColor=b.data("backgroundcolor");n.AvonScope.DisplayCollapsedBannerOptions=!1;n.AvonScope.FullBannerSetup=function(){n.AvonScope.ScrollPageTop||(b.removeAttr("style").removeClass().css({height:n.AvonScope.BannerHeight,"background-color":n.AvonScope.BannerBackgroundColor}),k.hide(),n.AvonScope.DisplayCollapsedBannerOptions=!1,ft.show(),ut.removeAttr("style"),n.AvonScope.ScrollPageTop=!0,n.AvonScope.ScrollDown=!1)};n.AvonScope.CollapsedBannerSetup=function(){if(!n.AvonScope.ScrollDown){b.removeAttr("style").removeClass().addClass("CollapsedBanner").css({"min-height":n.AvonScope.CollapsedBannerHeight,"background-color":n.AvonScope.BannerBackgroundColor});ut.removeAttr("style");k.removeAttr("style");k.show().css({"margin-top":"-3px",top:n.AvonScope.BannerHeight/2-17});n.AvonScope.IsIPad===!1&&ft.hide();var t=$("#BannerSearchContainer .search-container-inner .custom-popup-wrapper");t.removeAttr("style");t.show().css({top:n.AvonScope.BannerHeight-(n.AvonScope.BannerHeight/2-17)-3});n.AvonScope.DisplayCollapsedBannerOptions=!0;n.AvonScope.ScrollPageTop=!1;n.AvonScope.ScrollDown=!0}};n.AvonScope.BannerHeight===0?(vt.css("top","0"),nt.css("margin-top","6px"),b.hide()):(yt.css("height",n.AvonScope.BannerHeight/2),pt.css("height",n.AvonScope.BannerHeight),tt=0,a.onscroll=wt?function(){var n=_.debounce(function(){var n=a.pageYOffset||document.documentElement.scrollTop;n>0?b.hide():b.show();tt=n},1e3,!0);n()}:function(){var n=_.debounce(function(){var n=a.pageYOffset||document.documentElement.scrollTop;kt();n>tt?dt(n):lt(n);tt=n},1e3,!0);n()});n.AvonScope.CenterModal=function(t){var r=$("#"+t).parent(),h=$(document).height(),e=r.height(),u=r.width(),f=$(window).scrollTop(),o=f,s=h-e,i;r.css("margin-left","-"+u+"px");u=r.width();i=f+n.AvonScope.viewportHeight*.1;e>n.AvonScope.viewportHeight&&(i=f+5);i<o?i=o:i>s&&(i=s);r.css("top",i+"px");r.css("margin-left","-"+u/2+"px")};n.AvonScope.GetMaxHeight=function(n){var t=$(n).map(function(){var n=$(this).height();if(n>0)return n});return Math.max.apply(null,t)};n.AvonScope.ViewPrivacyPolicyUrl=function(t){n.AvonScope.IsMobile?n.AvonScope.RedirectToUrl(t):window.open(t,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};n.AvonScope.ViewUrlInNewWindow=function(n){window.open(n,"_blank")};n.AvonScope.ViewConditionsOfUseUrl=function(t){n.AvonScope.IsMobile?n.AvonScope.RedirectToUrl(t):window.open(t,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};n.AvonScope.InitSizeAndOrientation=function(){var t=n.AvonScope.GetDevicePixelDensity();t>=2?$("html").addClass("HighDensity"):t>=1.5?$("html").addClass("MedDensity"):$("html").addClass("LowDensity");n.AvonScope.AdjustSize();window.addEventListener("orientationchange",function(){n.AvonScope.OnPhoneOrientationChange()})};n.AvonScope.trackPwaAddToHomeScreen=function(){window.addEventListener("beforeinstallprompt",function(t){t.preventDefault();AVON.AddToHomeScreenBannerPromptEvent=t;(n.AvonScope.IsHomePage()||n.AvonScope.IsConfirmationPage())&&(_.isUndefined(AVON.AddToHomeScreenBannerPromptEvent)||AVON.AddToHomeScreenBannerPromptEvent.prompt());AVON.AddToHomeScreenBannerPromptEvent.userChoice.then(function(n){var t={event_name:"pwa_add_to_homescreen",event_category:"PWA",event_action:""+n.outcome,event_label:"add to home screen"};u.TrackEvent(t);AVON.AddToHomeScreenBannerPromptEvent=null})});window.addEventListener("appinstalled",function(){u.TrackEvent({event_name:"pwa_installed_to_homescreen",event_category:"PWA",event_action:"installation",event_label:"installed to home screen"})})};n.AvonScope.dismissA2HSBannerForIOS=function(){var t=n.AvonScope.SessionService.PostJson("/api/session/dismissAddToHomeScreenIOSBanner",null);t.success(function(t){t.Data.isA2HSBannerIOSDismissed&&(n.AvonScope.Session.Customer.IsA2HSBannerIOSDismissed=!0,n.AvonScope.a2HSBannerForIOS={canShow:!1})})};n.AvonScope.GetDevicePixelDensity=function(){var n=1;return window.devicePixelRatio!==undefined&&(n=window.devicePixelRatio),n};n.AvonScope.AdjustSize=function(){var t=Math.min(n.AvonScope.viewportWidth,n.AvonScope.viewportHeight),r=Math.max(n.AvonScope.viewportWidth,n.AvonScope.viewportHeight),i;t=Math.max(t,r*(9/16));i=(t/100*3).toFixed(2);$("html").css("font-size",i+"px");n.AvonScope.viewportHeight>n.AvonScope.viewportWidth&&(n.AvonScope.isPortrait=!0);n.AvonScope.IsAndroid&&(n.AvonScope.isPortrait=screen.availHeight>screen.availWidth?!0:!1);n.AvonScope.isPortrait?($("html").addClass("Portrait"),$("html").removeClass("Landscape")):($("html").addClass("Landscape"),$("html").removeClass("Portrait"))};n.AvonScope.OnPhoneOrientationChange=function(){n.AvonScope.AdjustSize();n.AvonScope.$broadcast("AvonController.OrientationChange")};n.AvonScope.ModalCalled=!1;n.AvonScope.ShowImage=function(n,t){var i=$(n.currentTarget);i.prop("src",o.mediaImage(t))};n.AvonScope.IsScrolledIntoView=function(t){if(t.length>0){var i=$(window).scrollTop(),u=i+n.AvonScope.viewportHeight,r=t.offset().top,f=r+t.height();return f<=u&&r>=i}return!1};n.AvonScope.GetChangeLanguageUrl=function(){var t=AVON.languageId==Language.Spanish?"/":"/es",n=window.location.toString().replace(/^.*\/\/[^\/]+/,"");return n=n.replace(/^((\/)?(e[sn]|[1|2])(\/|(?=\?)))|^((\/)?(e[sn]|[1|2])\/?)$/,"/"),n=n.replace("^/e./","/"),n=t+n,n.replace("//","/").replace("&&","&")};n.AvonScope.QueryString().emailsignup==="1"&&n.AvonScope.OpenEmailSignupModal();n.AvonScope.ChangeOnlineStoreLanguage=function(){y.ChangeOnlineStoreLanguage()};i.GetFixedTopBannerContainerHeight=function(){return{height:angular.element(".fixed-top-banner").outerHeight()}};this.initPage()}return __extends(i,t),i.prototype.initPage=function(){_.defer(function(){app.safeLoadImages($("body"))});$(function(){if(n.AvonScope.IsMobile=$("body").hasClass("Mobile"),n.AvonScope.IsMobile){$(document).on("focus","input",function(n){if($(n.currentTarget).prop("id")!="HeaderSearchInput"){if($(".CheckoutContainer").length){$(".CheckoutContainer").css("position","absolute");var t=-$(".CheckoutContainer").height()+$("#RepHeader").height();$(".CheckoutContainer").css("bottom",t)}$("html").hasClass("iphone")&&$("#FixedMenu").css("position","absolute")}}).on("blur","input",function(){$(".CheckoutContainer").length&&($(".CheckoutContainer").css("bottom",0),$(".CheckoutContainer").css("position","fixed"));$("html").hasClass("iphone")&&$("#FixedMenu").css("position","fixed")});if(n.AvonScope.IsSafariBrowser){var i=new RegExp("Version/.([.0-9]{1,})"),r=!!i.test(navigator.userAgent),t=0;r&&(document.documentElement.addEventListener("touchstart",function(n){n.touches.length>1&&n.preventDefault()},!1),document.documentElement.addEventListener("touchend",function(n){var i=(new Date).getTime();i-t<=300&&n.preventDefault();t=i},!1))}}if(typeof AVON.ShowOverlay=="string"&&AVON.ShowOverlay.length>0&&$("#"+AVON.ShowOverlay).trigger("modal"),n.AvonScope.IsMobile){n.AvonScope.InitSizeAndOrientation();n.AvonScope.trackPwaAddToHomeScreen();$(window).on("resize",function(){if(n.AvonScope.isPortrait){var t=!1;$(window).height()>n.AvonScope.viewportHeight&&(n.AvonScope.viewportHeight=$(window).height(),t=!0);$(window).width()<n.AvonScope.viewportWidth&&(n.AvonScope.viewportWidth=$(window).width(),t=!0);t&&n.AvonScope.AdjustSize()}});$("body").on("change","select",function(){$(this).blur()})}$("header").height($("#FixedMenu").height())});this.initTracking();_.delay(function(){n.AvonScope.isPageComplete=!0;n.AvonScope.$broadcast("AvonController.PageCompete")},2e3);_.delay(function(){$("header").height($("#FixedMenu").height())},1e3);setInterval(function(){n.AvonScope.PageTotalMinutes+=1;n.AvonScope.PageIdleMinutes+=1;n.AvonScope.SessionMinutes+=1;var t;n.AvonScope.Session.Customer.IsLoggedIn&&(t=n.AvonScope.ClientConfiguration.PageTimeout.PageTimeoutMinutes-n.AvonScope.ClientConfiguration.PageTimeout.WarningMinutes);window.location.toString().indexOf("/checkout")>-1&&(t=n.AvonScope.ClientConfiguration.PageTimeout.PaymentTimeoutMinutes-n.AvonScope.ClientConfiguration.PageTimeout.WarningMinutes);t!==undefined&&n.AvonScope.PageIdleMinutes==t&&($("#PageTimeoutWarningModal:visible").length!=0||n.AvonScope.Redirecting||n.AvonScope.ModalService.ShowModalUrl("/api/home/pagetimeoutwarningmodal",!1));n.AvonScope.SessionMinutes>=n.AvonScope.ClientConfiguration.SessionTimeoutMinutes*.25&&(n.AvonScope.SessionMinutes=0,n.AvonScope.SessionService.KeepAlive());n.AvonScope.SafeApply()},6e4);this.handleFundraiserBrowserHistoryState()},i.prototype.initTracking=function(){var n=this;_.defer(function(){n.initTrackingItem(AVON.trackingTop);n.initTrackingItem(AVON.trackingBottom)})},i.prototype.initTrackingItem=function(n){n!=null&&(n.PageMarkup!=null&&$("body").append(n.PageMarkup),_.each(n.JavascriptFiles,function(n){var t=n;t=t.replace("~/","/");$.getScript(t)}),n.InlineJavascript!=null&&$("body").append("<script>"+n.InlineJavascript+"<\/script"))},i.prototype.openYouTubeModal=function(t,i,r,u,f){var e=f||0,o=u?0:1,s=n.AvonScope.YouTubeUrl+t+"?enablejsapi=1&autohide="+o+"&start="+e+"&rel=0&wmode=transparent&autoplay=1",h={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:s,UseIFrame:!0,IFrameWidth:i+"px",IFrameHeight:r+"px"};n.AvonScope.OpenDynamicModal("VideoModal",h)},i.prototype.handleFundraiserBrowserHistoryState=function(){var n=this,t="FundraiserState";this.sessionService.WhenReady().then(function(){var r,i;n.$rootScope.Session.Fundraiser?(r={FundraiserVanityName:n.$rootScope.Session.Fundraiser.VanityName},n.historyService.ReplaceState(t,r)):(i=n.historyService.GetStateData(t),i&&i.FundraiserVanityName&&n.fundraiserService.StartShoppingFundraiser(i.FundraiserVanityName))})},i.prototype.appendRepToUrl=function(n){var i=window.location.href,r=window.location.hash,u,t;i.match(/[?&]rep=/gi)||n&&n.Rep&&n.Rep.WebUrl&&(u="rep="+n.Rep.WebUrl,t=i+(i.indexOf("?")<0?"?":"&")+u,t=t.replace("/?","?"),r.length>0&&(t=t.replace(r,"")+r),this.historyService.ReplaceStateUrl(t));this.removeRepIdFromUrlIfHasRepName()},i.prototype.removeRepIdFromUrlIfHasRepName=function(){var n=window.location.href,t=window.location.href;n.match(/[?&]rep=/gi)&&(n=n.replace(/\?(repid|rep_id)=\d+&/gi,"?"),n=n.replace(/&(repid|rep_id)=\d+&/gi,"&"),n=n.replace(/&(repid|rep_id)=\d+$/gi,""),t===n==!1&&this.historyService.ReplaceStateUrl(n))},i.$inject=["$rootScope","bagService","trackingService","$sce","sessionService","cdnService","$compile","urlService","loginService","modalService","$window","subscribeService","negotiateJwtService","fundraiserService","historyService"],i}(BaseAngularController);n.AvonController=t}(AvonModule||(AvonModule={}));app.controller("AvonController",AvonModule.AvonController),function(n){"use strict";var t=function(t){function i(i,r,u,f){t.call(this,i);n.contactScope=i;n.contactScope.ContactMeFormModel=AVON.ContactMeFormModel;n.contactScope.invalidEmailFormat=AVON.messages.validate_email_invalid;n.contactScope.emailNotMatch=AVON.messages.validate_email_match;n.contactScope.IsGeminiRep=AVON.IsGeminiRep;n.contactScope.IsGeminiRep&&(n.contactScope.ReCaptchaEnabled=typeof grecaptcha!="undefined",n.contactScope.ReCaptchaCallback=function(){n.contactScope.ReCaptchaError="";n.contactScope.SafeApply()},f.ReCaptchaCallback=n.contactScope.ReCaptchaCallback,f.ReCaptchaError=n.contactScope.ReCaptchaError);_.defer(function(){angular.element("#ContactMeFormModel_PhoneDayInput").placeholder();angular.element("#ContactMeFormModel_PhoneEveningInput").placeholder();$('textarea[name="Message"]').placeholder()},200);n.contactScope.InputFocus=function(){n.contactScope.ShowValidation=!1;n.contactScope.ReCaptchaError=""};n.contactScope.SendContactRequest=function(){if(n.contactScope.ReCaptchaEnabled=typeof grecaptcha!="undefined",n.contactScope.ReCaptchaError="",n.contactScope.ContactMeForm.$valid){var t=n.contactScope.ReCaptchaEnabled?grecaptcha.getResponse():"ReCaptchaDisabled";if(!t&&n.contactScope.IsGeminiRep){n.contactScope.ReCaptchaError=AVON.messages.reCaptchaNotChecked;grecaptcha.reset();return}n.contactScope.ShowLoading("");r.SendContactRequest(i.ContactMeFormModel,t)}else n.contactScope.ReCaptchaEnabled&&grecaptcha.reset(),n.contactScope.LivePersonErrorTracking(),n.contactScope.ShowValidation=!0};n.contactScope.$on("ContactService.ContactRequestResponse",function(t,i){i.ErrorCode===AjaxError.ValidationErrors&&$.each(i.ValidationErrors,function(t,i){i.FieldName.indexOf("ReCaptcha")>-1&&(n.contactScope.ReCaptchaError=AVON.messages.reCaptchaErrorMessage)})});i.CloseThankYou=function(){$("#ContactMeThankYouModal").trigger("close")};i.LivePersonErrorTracking=function(){_.defer(function(){window.lpTag!=undefined&&(window.lpTag.sdes=window.lpTag.sdes||[],window.lpTag.sdes.push({type:"error",error:{message:"Checkout Processing Issue",code:"AVON01"}}))})};i.$on("ContactService.ContactRequestResponse",function(){$("#ContactMeRepModal").trigger("close");i.OpenDynamicModal("ContactMeThankYouModal",{AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/contact/contactmethankyou"},i)})}return __extends(i,t),i.$inject=["$scope","contactService","trackingService","$window"],i}(BaseAngularController);n.ContactController=t}(ContactModule||(ContactModule={}));app.controller("ContactController",ContactModule.ContactController),function(n){var t=function(n){function t(t,i,r){n.call(this,t,r);var u=t;$(function(){function s(n){n.stopPropagation();n.preventDefault();n.returnValue=!1;n.cancelBubble=!0}var n=$("#earmark-container"),w=$("#earmark-header"),b=$("#earmark-close"),h=n.data("pause"),c=n.data("is-home-page"),l=n.data("animate-earmark"),a=n.data("animate-only-on-home-page"),v=n.data("did-earmark-animated"),f=$("#earmark-body"),e=$("#earmark-arrow div"),o="earmark-out",y="arrow-down",p="arrow-up";u.closePermanently=n.data("close-permanently");u.openCloseEarmark=function(n){n===void 0&&(n=!1);n&&_.isUndefined(u.animateInPromise)===!1&&i.cancel(u.animateInPromise);f.toggleClass(o);r.IsEarmarkCollapsed=f.hasClass(o)?!0:!1;e.toggleClass(p);e.toggleClass(y)};u.animateInEarmark=function(){v===!1&&(u.SessionService.PostJson("/api/session/didEarmarkAnimated",null),u.openCloseEarmark(),u.animateInPromise=i(function(){u.openCloseEarmark()},h*2e3))};u.removeEarmark=function(){if(u.closePermanently===!1)n.hide();else{var t=u.SessionService.PostJson("/api/session/closeEarmarkPermanently",null);t.success(function(t){t.Data.isEarmarkClosedPermanently&&n.remove()})}};u.detectUrl=function(n){var i=n.target.pathname;(i==="/findarep"||i==="findarep")&&(s(n),r.OdsIsDown?t.RedirectToUrl(t.Url.Action("index","Findarep")):$("#FindARepModal").trigger("modal"),u.openCloseEarmark());(i==="/signin"||i==="signin")&&(s(n),$("#LoginModal").trigger("modal"),u.openCloseEarmark())};r.onload=function(){l===!0&&(c===!0?u.animateInEarmark():a===!1&&u.animateInEarmark())}})}return __extends(t,n),t.$inject=["$scope","$timeout","$window"],t}(BaseAngularController);n.EarmarkController=t}(EarmarkModule||(EarmarkModule={}));app.controller("EarmarkController",EarmarkModule.EarmarkController),function(n){var t=function(){function n(n){n.EmailSignupModalDisplayed=!1}return n.$inject=["$window"],n}();n.EmailSignupFormSubmittedController=t}(EmailSignupFormSubmittedModule||(EmailSignupFormSubmittedModule={}));app.controller("EmailSignupFormSubmittedController",EmailSignupFormSubmittedModule.EmailSignupFormSubmittedController),function(n){"use strict";var t=function(n){function t(t,i){n.call(this,t);this.$scope=t;t.IsCardExpanded=!1;t.OrganizatioImageLoaded=!1;t.$watch("Session.Fundraiser",function(){t.Fundraiser=t.Session.Fundraiser});t.BannerClicked=function(){t.IsCardExpanded=!t.IsCardExpanded};t.ShowFundraiserBanner=function(){return t.Fundraiser!=null};t.StopShoppingFundraiserClicked=function(){t.IsCardExpanded=!1;i.ShowModal("#FundraiserStopShoppingModal",null,!0,!0)};t.OrganizatioImageOnLoad=function(){t.OrganizatioImageLoaded=!0};t.GetFundraiserUrl=function(){return t.Url.Action("Index","Fundraiser",t.Fundraiser.VanityName)};this.collapseCardOnClickOutsideBanner()}return __extends(t,n),t.prototype.collapseCardOnClickOutsideBanner=function(){var n=this;angular.element(window.document).bind("click",function(t){if(n.$scope.IsCardExpanded){var i=angular.element(".fundraiser-banner").find(t.target).length==0;i&&n.$scope.SafeApply(function(){n.$scope.IsCardExpanded=!1})}})},t.$inject=["$scope","modalService","sessionService"],t}(BaseAngularController);n.FundraiserBannerController=t}(FundraiserBannerModule||(FundraiserBannerModule={}));app.controller("FundraiserBannerController",FundraiserBannerModule.FundraiserBannerController),function(n){"use strict";var t=function(n){function t(t,i,r,u,f){var e=this;n.call(this,t);this.$scope=t;this.urlService=u;this.historyService=f;t.Fundraiser=t.Session.Fundraiser;t.StopShoppingFundraiserModalYesClicked=function(){t.ShowLoading(AVON.messages.spinner_processing);i.StopShoppingFundraiser().success(function(){e.redirectOnStopShoppingFundraiser();e.historyService.ReplaceState("FundraiserState",null)});r.CloseModal()};t.StopShoppingFundraiserModalNoClicked=function(){r.CloseModal()}}return __extends(t,n),t.prototype.redirectOnStopShoppingFundraiser=function(){var n=window.location.pathname,t,i;if(this.$scope.Fundraiser&&(t=this.$scope.Url.Action("Index","Fundraiser",this.$scope.Fundraiser.VanityName),n===t)){this.$scope.RedirectToUrl(this.$scope.HomePageUrl,!0);return}n===this.$scope.Session.Rep.HomepageUrl?this.$scope.RedirectToUrl(this.$scope.HomePageUrl,!0):(i=this.urlService.RemoveQueryStringParameterFromUrl(window.location.href,"rep"),this.$scope.RedirectToUrl(i,!0))},t.$inject=["$scope","fundraiserService","modalService","urlService","historyService"],t}(BaseAngularController);n.StopShoppingFundraiserController=t}(FundraiserModule||(FundraiserModule={}));app.controller("StopShoppingFundraiserController",FundraiserModule.StopShoppingFundraiserController),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.notifyMe=function(n){var i=this;this.PostJson("/api/product/notifymemodal",n).success(function(n){n!==null&&i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n)}).error(function(n){i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n)})},t.prototype.GetPromotionsWithIds=function(n){var i=this;n&&n.length>0?this.$rootScope.SessionService.WhenReady().then(function(){for(var f,r,u=0;u<n.length;u+=25)f=n.slice(u,u+25),r="/api/promotions/getpromotions",r+="?language="+AVON.languageId,r+="&campaign="+AVON.campaign,r+="&attached="+i.$rootScope.Session.Customer.IsAttached,r+="&deliverytype="+i.$rootScope.Session.Customer.DeliveryType,r+="&promotionIds="+f.join(","),i.GetJson(r,!0,!0,!1).then(function(n){i.$rootScope.$broadcast(t.PromotionsLoadedBroadcastName,n)})}):this.$rootScope.$broadcast(t.PromotionsLoadedBroadcastName,null)},t.prototype.GetProductWithId=function(n){var i=this,r;return n&&this.$rootScope.SessionService.WhenReady().then(function(){var u="/api/products/getproduct?language="+AVON.languageId+("&campaign="+AVON.campaign)+("&attached="+i.$rootScope.Session.Customer.IsAttached)+("&deliverytype="+i.$rootScope.Session.Customer.DeliveryType)+"&productId="+n;r=i.GetJson(u,!0,!0,!1).then(function(n){return i.$rootScope.$broadcast(t.ProductLoadedBroadcastName,n),n.Data})}),r},t.prototype.GetProductsWithIds=function(n){var i=this,r;return n&&n.length>0?this.$rootScope.SessionService.WhenReady().then(function(){for(var u=0;u<n.length;u+=25){var f=n.slice(u,u+25),e=u,o="/api/products/getproducts?language="+AVON.languageId+("&campaign="+AVON.campaign)+("&attached="+i.$rootScope.Session.Customer.IsAttached)+("&deliverytype="+i.$rootScope.Session.Customer.DeliveryType)+("&productIds="+f.join(","))+("&productIdSubsetIndex="+e);r=i.GetJson(o,!0,!0,!1).then(function(n){return i.$rootScope.$broadcast(t.ProductsLoadedBroadcastName,n),n.Data})}}):this.$rootScope.$broadcast(t.ProductsLoadedBroadcastName,null),r},t.prototype.GetProductLine=function(n,i){var r=this;n&&this.$rootScope.SessionService.WhenReady().then(function(){var u="/api/products/getproductline";u+="?language="+AVON.languageId;u+="&campaign="+AVON.campaign;u+="&attached="+r.$rootScope.Session.Customer.IsAttached;u+="&deliverytype="+r.$rootScope.Session.Customer.DeliveryType;u+="&lineId="+n;u+="&takeAmount="+i;r.GetJson(u,!0,!0,!1).then(function(i){r.$rootScope.$broadcast(t.ProductLineLoadedBroadcastName,n,i)})})},t.prototype.GetProductLines=function(n){var i=this,r=[],u=[];for(var f in n)r.push(f),u.push(n[f]);r.length>0&&this.$rootScope.SessionService.WhenReady().then(function(){var n="/api/products/getproductlines";n+="?language="+AVON.languageId;n+="&campaign="+AVON.campaign;n+="&attached="+i.$rootScope.Session.Customer.IsAttached;n+="&deliverytype="+i.$rootScope.Session.Customer.DeliveryType;n+="&lineIds="+r.join(",");n+="&takeAmounts="+u.join(",");i.GetJson(n,!0,!0,!1).then(function(n){i.$rootScope.$broadcast(t.ProductLinesLoadedBroadcastName,n)})})},t.$inject=["$rootScope","$http","$q"],t.NotifyMeResponseBroadcastName="ProductService.NotifyMeResponse",t.PromotionsLoadedBroadcastName="ProductService.PromotionsLoaded",t.ProductLoadedBroadcastName="ProductService.ProductLoaded",t.ProductsLoadedBroadcastName="ProductService.ProductsLoaded",t.ProductLineLoadedBroadcastName="ProductService.ProductLineLoaded",t.ProductLinesLoadedBroadcastName="ProductService.ProductLinesLoaded",t}(BaseAvonService);n.ProductService=t}(ProductServiceModule||(ProductServiceModule={}));app.service("productService",ProductServiceModule.ProductService),function(n){var t=function(){function n(){return{require:"^carousel",restrict:"E",replace:!0,scope:!1,transclude:!0,link:function(n,t,i,r){var u=$(t);u.find("a[href],[ng-click],[data-ng-click],*").on("click",function(n){var t=r.$scope;t.clickEnabled||n.preventDefault()});_.defer(function(){r.update()});u.waitForImages(function(){r.$scope.slideLoaded();r.update()});n.$on("$destroy",function(){r.update()})},template:'<div class="Slide" ng-transclude><\/div>'}}return n}();n.SlideDirective=t}(CarouselModule||(CarouselModule={}));app.directive("slide",[CarouselModule.SlideDirective]),function(n){var t=function(){function t(){return{restrict:"E",replace:!1,scope:!0,transclude:!0,controller:n.CarouselDirectiveController,compile:function(){return{post:function(n,t){var i=n.IsPanEnabled?"panstart panmove panend panleft panright panup pandown swipeleft swiperight":"swipeleft swiperight";new Hammer(t[0],{}).on(i,n.throttledHammerHandler)}}},template:'<div class="ScrollClip" data-ng-mouseenter="mouseEnter()" data-ng-mouseleave="mouseLeave()" data-ng-click="onClick()">    <div class="ScrollContents">        <div class="WrapLeft"><\/div><div class="Slides" ng-transclude><\/div ><div class="WrapRight"><\/div>    <\/div> <\/div><div class="CarouselPrevious" data-ng-click="previousClicked()" data-ng-class="{ Active: PreviousButtonActive() }"><\/div><div class="CarouselNext" data-ng-click="nextClicked()" data-ng-class="{ Active: NextButtonActive() }"><\/div><nav class="CarouselPages" data-ng-class="{ HasPages : maxIndex > 0 }">    <ol>        <li data-ng-repeat="slide in slideRange()" data-ng-click="showSlide($index, true, true)" data-ng-class="{ Active : isPageActive($index) }">            <a>                <span>{{$index+1}}<\/span>            <\/a>        <\/li>    <\/ol><\/nav>'}}return t.ShowSlideBroadcastName="Carousel_ShowSlide",t}();n.CarouselDirective=t}(CarouselModule||(CarouselModule={}));app.directive("carousel",["$rootScope","$compile",CarouselModule.CarouselDirective]),function(n){"use strict";var t=function(t){function i(i,r,u,f,e,o){var c=this,s,h;if(t.call(this,i,e),this.trackingService=f,n.productScope=i,i.LoadedProducts={},i.LoadedProductLines={},i.LoadedPromotions={},i.LoadedRecommendations={},i.StarCount=_.range(5),AVON.productList)for(s=0;s<AVON.productList.length;s++)i.LoadedProducts[AVON.productList[s].Id]=AVON.productList[s];i.$on("GlobalProductController.LoadPromotions",function(n,t){i.LoadPromotions(t)});i.LoadPromotions=function(n){_.defer(function(){u.GetPromotionsWithIds(n)})};i.$on("ProductService.PromotionsLoaded",function(n,t){var u,r;if(t&&t.Data){for(u=t.Data,r=0;r<u.length;r++)i.LoadedPromotions[u[r].PromotionId]=u[r],u[r].PromotionLinkProductId>0&&!i.LoadedProducts[u[r].PromotionLinkProductId]&&i.LoadProduct(u[r].PromotionLinkProductId);i.SafeApply()}});i.LoadProduct=function(n){n&&!i.LoadedProducts[n]&&_.defer(function(){u.GetProductWithId(n)})};i.$on("ProductService.ProductLoaded",function(n,t){t.Data&&(i.LoadedProducts[t.Data.Id]=t.Data,i.SafeApply())});i.LoadProducts=function(n){_.defer(function(){u.GetProductsWithIds(n)})};i.$on("ProductService.ProductsLoaded",function(n,t){var u,r;if(t&&t.Data){for(u=t.Data,r=0;r<u.length;r++)i.LoadedProducts[u[r].Id]=u[r];i.SafeApply()}});i.LoadProductLine=function(n,t){n&&n>0&&_.defer(function(){u.GetProductLine(n,t)})};i.$on("ProductService.ProductLineLoaded",function(n,t,r){var f,u;if(r.Data)for(f=r.Data,i.LoadedProductLines[t]=[],u=0;u<f.length;u++)i.LoadedProducts[f[u].Id]=f[u],i.LoadedProductLines[t].push(f[u].Id)});i.LoadProductLines=function(n){n&&u.GetProductLines(n)};i.$on("ProductService.ProductLinesLoaded",function(n,t){var u,e,r,o,f;if(t.Data){u=t.Data;for(e in u)if(r=parseInt(e),!i.LoadedProductLines[r]||!(i.LoadedProductLines[r].length>u[r].length)){i.LoadedProductLines[r]=[];for(o in u[r])f=u[r][parseInt(o)],i.LoadedProducts[f.Id]=f,i.LoadedProductLines[r].push(f.Id)}}});i.GetLoadedLineProduct=function(n,t){if(i.LoadedProductLines[n])return i.LoadedProducts[i.LoadedProductLines[n][t]]};i.GetLoadedLineProducts=function(n){var r=[],t;if(i.LoadedProductLines[n])for(t=0;t<i.LoadedProductLines[n].length;t++)r.push(i.LoadedProducts[i.LoadedProductLines[n][t]]);return i.TotalProducts=r.length,r};i.GetRecommendedProducts=function(n){var t=[];return i.LoadedRecommendations[n]&&i.LoadedRecommendations[n].forEach(function(n){i.LoadedProducts[n]&&t.push(i.LoadedProducts[n])}),t};i.GetFullStarsFor=function(n){return new Array(Math.round(n.Rating))};i.GetEmptyStarsFor=function(n){return new Array(5-Math.round(n.Rating))};i.GetRatingArray=function(){return new Array(5)};i.GetProductPrice=function(n){return n.PriceModel?"$"+n.PriceModel.ListPrice.toFixed(2):""};i.GetProductSalePrice=function(n){return n.PriceModel?"$"+n.PriceModel.SalePrice.toFixed(2):""};i.ProductUrlFor=function(n,t,r,u){var f;return r===void 0&&(r=!1),u===void 0&&(u=!1),f="",u&&(f=r?"?rrec=true":"?rrec=false"),i.Url.Action("Details","Product")+"/"+t.formatUrlNugget()+"-"+n+f};i.GoToProductPageFor=function(n,t,r){t===void 0&&(t=!1);r===void 0&&(r=!1);var u=i.ProductUrlFor(n.Id,n.Name,t,r);i.RedirectToUrl(u)};i.GoToProductPage=function(n,t,r,u){r===void 0&&(r=!1);u===void 0&&(u=!1);var f="";u&&(f=r?"?rrec=true":"?rrec=false");i.RedirectToUrl(i.Url.Action("Details","Product")+"/"+t.formatUrlNugget()+"-"+n+f)};i.GoToPromotionLink=function(n){i.LoadedPromotions[n]?i.LoadedPromotions[n].PromotionLinkProductId>0?i.GoToProductPageFor(i.LoadedProducts[i.LoadedPromotions[n].PromotionLinkProductId]):i.LoadedPromotions[n].LandingPage&&i.LoadedPromotions[n].LandingPage.length>0?i.RedirectToUrl(i.LoadedPromotions[n].LandingPage):i.RedirectToUrl(i.Url.Action("Index","Promotions")+"/"+n):i.RedirectToUrl(i.Url.Action("Index","Promotions")+"/"+n)};i.ShowProductQuickView=function(n,t,r){var u,f,e;if($(".touch").length>0||i.IsMobile){u=i.Url.Action("Details","Product")+"/"+t.formatUrlNugget()+"-"+n;r&&(u+="?org="+r);i.RedirectToUrl(u);return}f=i.Url.Action("quickshop","Product")+"/"+n+"/"+t.formatUrlNugget();e={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:f};i.ShowLoading(AVON.messages.spinner_loading);i.OpenDynamicModal("QuickView",e);h===undefined&&(h=_.throttle(function(){},500,{leading:!1}));h()};i.ShowPromotionOverlay=function(n){var r=$(angular.element(n.currentTarget)[0]),t,i,u;if(r.siblings("div").addClass("active"),t=r.siblings(".Overlay.active"),t.width(t.parent().width()-(t.outerWidth(!0)-t.width())),i=$(".NavBar"),i.length>0){var e=i.offset().left+i.innerWidth(),o=t.offset().left+t.innerWidth(),f=o-e;f>0&&t.css({"margin-left":-f})}u=r.siblings(".RotatedCaret45.active");u.css({"margin-left":t.outerWidth(!0)/2-u.width()/2})};i.HidePromotionOverlay=function(n){var t=$(n.target);t.children(".active").removeClass("active");t.closest(".Expandable").removeClass("Expanded")};i.ShowNotifyOverlay=function(n){n.stopPropagation();var t=$(n.target);t.parents(".OverlayContainer").find(".active").length>0?i.HideNotifyOverlay(n):(t.parents(".OverlayContainer").find("input").val(i.Session.Customer.Email),i.ClearEmailValidation(n),i.ShowPromotionOverlay(n))};i.HideNotifyOverlay=function(n){var t=$(n.target);t.parents(".OverlayContainer").find(".active").removeClass("active");t.closest(".Expandable").removeClass("Expanded")};i.ClearEmailValidation=function(n){var t=$(n.target),i=t.parents(".NotifyMeOverlay.active");i.find(".NotifyMeOverlayForm .ErrorText").hide()};i.SendNotify=function(n,t){var f=$(n.target),r=f.parents(".NotifyMeOverlay.active"),e=f.parents(".NotifyMeOverlayForm").find("input").val(),s=/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(e),o;s?(o={Email:e,Fsc:"",ProductId:t.toString(),RepId:i.Session.Rep.Id},u.notifyMe(o),r.find(".NotifyMeOverlayForm").hide(),r.find(".NotifyMeOverlayThankYou").show(),_.delay(function(){i.HideNotifyOverlay(n)},3e3)):r.find(".NotifyMeOverlayForm .ErrorText").show()};i.GetVariantTypeText=function(n){return VariantType[n]};i.ShowProductSummaryPromotion=function(n){var t=$(n.target);t.hasClass("Expandable")&&(t.hasClass("Expanded")?t.removeClass("Expanded"):t.addClass("Expanded"))};i.GoToPromotion=function(n){var t,r;i.ShowLoading(null);i.LoadedPromotions[n].PromotionLinkProductId>0?(r=i.LoadedProducts[i.LoadedPromotions[n].PromotionLinkProductId],t=i.ProductUrlFor(r.Id,r.Name)):t=i.LoadedPromotions[n].LandingPage&&i.LoadedPromotions[n].LandingPage.length>0?i.LoadedPromotions[n].LandingPage:i.Url.Action("Index","Promotions",n);i.RedirectToUrl(t)};i.WriteAReview=function(n){n.preventDefault();i.ShowLoading(AVON.messages.spinner_loading);var t=$(n.currentTarget).attr("href");i.Session.Customer.IsLoggedIn?AVON.common.redirectTo(t):i.IsMobile?document.location.href="/signin?ReturnUrl="+encodeURIComponent(t):(AVON.RedirectToPowerReviews=!0,AVON.PowerReviewLink=t,i.ShowLoginModal())};i.AddToBag=function(n,t){var u,f,r;t===void 0&&(t=!1);u=[];for(f in n)r=new AddBagItem,r.Sku=n[f].Sku,r.Quantity=n[f].Qty,u.push(r);t&&i.ShowLoading(AVON.messages.spinner_loading);i.bagService.addMultipleItemsToBag(u,!1,null,t)};i.AddProductByIdToBag=function(n,t){i.ShowLoading(AVON.messages.spinner_addingToBag);var r="/api/products/getproduct?language="+AVON.languageId+("&campaign="+AVON.campaign)+("&attached="+i.Session.Customer.IsAttached)+("&deliverytype="+i.Session.Customer.DeliveryType)+("&productId="+n);u.GetJson(r,!0,!0,!1).then(function(r){var f=r.Data,u=new AddBagItem;u.Quantity=1;u.Id=n;u.Sku=i.isNullOrWhiteSpace(t)?f.Sku:t;AVON.product=f;i.bagService.addItemToBag(u,!0,null)})};i.DisplayWishList=function(n){return n.ShowHideProductFlags.IncludeInWishlist?(n.CanBuy===CanBuy.Available||n.CanBuy===CanBuy.AvailableSoon||n.CanBuy===CanBuy.AutoReplenishmentOnly)&&!i.IsDonationProduct(n):!1};i.displayProductBasedOnShowHideFlag=function(n,t){return n&&n.ShowHideProductFlags?n.ShowHideProductFlags[t]:!1};i.IsDonationProduct=function(n){return!(!n.IsFreeShipping||n.IsDiscountable)};i.IsInWishList=function(n){return o.CheckIfAnyVariantExistsInWishList(n.Id)};i.AddProductToWishList=function(n,t){var r,h,e,l,a,s,u,v;$("#ProductAddedToBag").trigger("close");i.Session.Customer.IsLoggedIn?(r=angular.element(t.currentTarget),r.hasClass("heart-outline-icon")?(r.addClass("loading-spinner"),r.attr("disabled","true")):(h=r.closest(".OverlayContainer"),h&&(e=h.siblings(".heart-outline-icon"),e&&(e.addClass("loading-spinner"),e.attr("disabled","true")))),i.HideWishListTooltip(t),l=null,a=CanBuy.Available,!n.IsMultiVariantProduct&&n.Availability!=CanBuy.NoLongerAvailable&&n.VariantGroups.length>0&&(s=n.VariantGroups[0].Variants[0],s&&(l=s.Sku,a=s.Availability)),u=[new WishListItem(n.Id,l,null,a)],v=o.AddToWishList(u),v.finally(function(){var e,t,o;for(r.closest("carousel").triggerHandler("update"),r.removeClass("loading-spinner"),r.removeAttr("disabled"),e=[],t=0;t<u.length;t++)e.push(u[t].Sku===null?n.Sku:u[t].Sku);o={Type:TrackingEventType.WishListItemsAdded,Data:{trackingItems:e,wishListState:i.Session.Customer.WishList.Products.length>0?"exist":"new",findingMethod:"product carousel "+c.trackingService.UTagData.content_page_type}};f.TrackEventItem(o)})):i.IsMobile||i.IsBlog()&&$("html").hasClass("Mobile")?i.RedirectToUrl(i.SignInPageUrl("wishlist")):i.ShowLoginModal("wishlist");t.preventDefault();t.stopPropagation()};i.RemoveAllVariantsFromWishList=function(n,t){var r,f,u,e;i.Session.Customer.IsLoggedIn?(r=angular.element(t.currentTarget),r.hasClass("heart-filled-icon")?(r.addClass("loading-spinner"),r.attr("disabled","true")):(f=r.closest(".OverlayContainer"),f&&(u=f.siblings(".heart-filled-icon"),u&&(u.addClass("loading-spinner"),u.attr("disabled","true")))),i.HideWishListTooltip(t),e=o.RemoveAllVariantsFromWishList(n.Id),e.finally(function(){r.closest("carousel").triggerHandler("update");r.removeClass("loading-spinner");r.removeAttr("disabled")})):i.IsMobile?i.RedirectToUrl(i.SignInPageUrl("wishlist")):i.ShowLoginModal("wishlist");t.preventDefault();t.stopPropagation()};i.LoadRecommendedProducts=function(n){angular.forEach(n.schemes,function(n){if(n.display==="yes"){var t=[];n.items.forEach(function(n){var r=parseInt(n.itemid,10);i.LoadedProducts[r]||t.push(r)});t.length>0&&i.LoadProducts(t);i.LoadedRecommendations[n.scheme]=n.items.map(function(n){return Number(n.itemid)})}})};i.$on("Carousel_SlideShown",function(n,t){t.container.find(".Expandable").removeClass("Expanded");t.container.find(".SingleExpandable").removeClass("Expanded")});_.defer(function(){var u=[],t,n;r.find("[data-promotionid]:not([data-promotionid=''])").each(function(){var n=parseInt($(this).attr("data-promotionid"),10);n>0&&u.push(n)});r.find("[data-promotionidlist]:not([data-promotionidlist=''])").each(function(){var n=$(this).attr("data-promotionidlist").split(",");n.forEach(function(n){var t=parseInt(n.trim(),10);t>0&&u.push(t)})});i.LoadPromotions(u);t=[];r.find("[data-productid]:not([data-productid=''])").each(function(){var n=parseInt($(this).attr("data-productid"),10);n>0&&t.push(n)});r.find("[data-productidlist]:not([data-productidlist=''])").each(function(){var n=$(this).attr("data-productidlist").split(",");n.forEach(function(n){var i=parseInt(n.trim(),10);i>0&&t.push(i)})});i.LoadProducts(t);n={};r.find("[data-lineid]:not([data-lineid=''])").each(function(){var t=parseInt($(this).attr("data-lineid"),10),i;t>0&&($(this).attr("data-lineamount")?(i=parseInt($(this).attr("data-lineamount"),10),(n[t]==null||i===0||n[t]!==0&&n[t]<i)&&(n[t]=i)):n[t]=0)});i.LoadProductLines(n)});i.certonaTimeoutElapsed=!1;_.delay(function(){i.certonaTimeoutElapsed=!0;i.$broadcast("Carousel_Update")},3e3)}return __extends(i,t),i.$inject=["$scope","$element","productService","trackingService","$window","wishListService"],i}(BaseAngularController);n.GlobalProductController=t}(ProductModule||(ProductModule={}));app.controller("GlobalProductController",ProductModule.GlobalProductController),function(n){"use strict";var t=function(n){function t(t,i,r,u,f){function s(){return $("#HeadContainer").length?$("#HeadContainer").height():$("#FixedMenu").height()}n.call(this,t);var e=t,o=$(i);this.trackingService=r;this.bagService=u;this.customerService=f;e.GetPortHoleSite=function(){var n=document.createElement("a"),t;return n.href=o.find("iframe").attr("src"),t=n.protocol+"//"+n.hostname+"/proxy.html",new Porthole.WindowProxy(t,"iFrameContainer")};e.HandleMessageRecieved=function(n){var t,i,f,h;if(n&&n.data){t=JSON.parse(n.data);i=t.action;i||(i="vmoaddtobag");switch(i.toLowerCase()){case"addtobag":e.AddToBag(t.payload);break;case"sweepstakes_lead":e.SweepStakesRegisterLead(t.payload);break;case"getbag":e.HandleGetBag();break;case"showloading":e.HandleShowLoading(t.payload);break;case"hideloading":e.HideLoading();break;case"scroll":window.scrollTo(0,0);break;case"signin":f=t.securitykey;f&&e.LoginService.verifySingleSignOn(f);break;case"iframeheight":h=t.height;h&&(e.IFrameHeight=h,$(".MiniSiteModule").length?$(".MiniSiteModule").attr("style","padding-bottom:"+parseInt(e.IFrameHeight)/10+"rem"):o.find("iframe").attr("height",e.IFrameHeight));break;case"getmodalpositions":var r=$(window).height(),c=s(),l=o.find("iframe").offset(),u=r/2+($(window).scrollTop()-l.top);u=u<r/2?r/2:u;e.GetPortHoleSite().post('{"action":"positionvalues", "positions":{ "viewportHeight": '+r+', "scrollPositionFromTop": '+$(window).scrollTop()+', "headerheight": '+c+', "modalposition": '+u+" }}")}}};e.SweepStakesRegisterLead=function(n){e.ShowLoading(AVON.messages.spinner_loading);f.RegisterLead(n)};e.$on("CustomerService.RegisterLead",function(n,t){e.HideLoading();var i=e.GetPortHoleSite();if(t.ErrorCode==AjaxError.ValidationErrors){i.post('{"action":"validation","validationerrors": '+JSON.stringify(t.ValidationErrors)+" }");return}if(t.ErrorCode!=AjaxError.None){i.post('{"action":"error" }');return}i.post('{"action":"success"}')});e.HandleGetBag=function(){e.ShowLoading(AVON.messages.spinner_loading);e.bagService.getBag()};e.$on("BagService.GetBagSuccess",function(){e.HideLoading()});e.IsTabletDevice=function(){return e.IsTouchDevice()&&$(".no-iphone.no-ipad.no-android").length==0};e.HandleShowLoading=function(n){n||(n=AVON.messages.spinner_loading);e.ShowLoading(n)};e.$on("BagService.AddToBagSuccess",function(n,t){var r=[],i;if(t&&t.ItemsFailed&&t.ItemsFailed.length>0)for(i=0;i<t.ItemsFailed.length;i++)r.push({Sku:t.ItemsFailed[i].Sku,LineNumber:t.ItemsFailed[i].LineNumber});e.GetPortHoleSite().post('{"action":"success", "itemsfailed" : '+JSON.stringify(r)+"}")});e.AddToBag=function(n){e.ShowLoading(AVON.messages.spinner_addingToBag);e.bagService.addMultipleItemsToBag(n,!1,TrackingAddToCartType.SkinCareAdvisor)};$(function(){e.GetPortHoleSite().addEventListener(t.HandleMessageRecieved)})}return __extends(t,n),t.$inject=["$scope","$element","trackingService","bagService","customerService"],t}(BaseAngularController);n.MiniSiteController=t}(MiniSiteModule||(MiniSiteModule={}));app.controller("MiniSiteController",MiniSiteModule.MiniSiteController),function(n){var t=function(t){function i(i,r,u,f){t.call(this,i);n.notifyMeScope=i;i.NotifyMeModel={Email:"",Fsc:"",ProductId:"",RepId:0};i.product=AVON.product;i.SessionService.WhenReady().then(function(){i.NotifyMeModel.Email=i.Session.Customer.Email;$("#NotifyMeModel_EmailInput").val(i.NotifyMeModel.Email);i.SafeApply()});i.NotifyMeSubmit=function(n){i.NotifyMeForm.$valid?(i.ShowValidation=!1,i.ShowLoading(AVON.messages.spinner_saving),i.NotifyMeModel.Email=$("#NotifyMeModel_EmailInput").val(),i.NotifyMeModel.Fsc=$("#NotifyMeModel_Fsc").val(),i.NotifyMeModel.ProductId=$("#NotifyMeModel_ProductId").val(),i.NotifyMeModel.RepId=$("#NotifyMeModel_RepId").val(),i.NotifyMeModel.CampaignNumber=$("#NotifyMeModel_CampaignNumber").val(),n?r.NotifyMeQuickShop(i.NotifyMeModel,$("form[name=NotifyMeForm]")):r.NotifyMe(i.NotifyMeModel,$("form[name=NotifyMeForm]"))):(i.ShowValidation=!0,i.TrackUserValidationErrors(i.NotifyMeForm.$error))};i.TrackUserValidationErrors=function(n){if(i.IsMobile!==!1){var t=[];n&&$.each(n,function(n,i){i&&(t.push("err-"+n),$.each(i,function(n,i){t.push(i.$name)}))});t=null}};i.NotifyMeThanksSubmit=function(){f.CloseModal()};i.$on(NotifyMeSerivceModule.NotifyMeService.NotifyMeResponseBroadcastName,function(n,t){t.ErrorCode===AjaxError.ValidationErrors&&i.ProcessAjaxValidationErrors(t);t.ErrorCode===AjaxError.None&&(f.CloseModal(),r.OpenNotifyMeModalSuccess(AVON.languageId))});i.$on(NotifyMeSerivceModule.NotifyMeService.NotifyMeQuickShopResponseBroadcastName,function(n,t){t.ErrorCode===AjaxError.ValidationErrors?(i.ProcessAjaxValidationErrors(t),i.HideLoading(),i.ShowValidation=!0,i.NotifyMeForm.$invalid=!0):($("#NotifyMeContainer").hide(),$(".NotifyMeContainer").hide(),$(".NotifyMeQuickShopForm .NotAvailableMessage").hide(),$(".NotifyMeSuccessQuickShopViewContainer").show(),setTimeout(function(){$(".NotifyMeQuickShopForm").hide();$(".NotifyMeSuccessQuickShopViewContainer").hide();i.product.Availability===1?($(".NotifyMeContainer").hide(),$(".NotifyMeQuickShopForm .NotAvailableMessage").show(),$(".AddToBagContainer").show()):($(".AddToBagContainer").hide(),$(".NotifyMeContainer").show(),$(".NotAvailableMessage").show(),$(".NotifyMeButton").show());i.SafeApply()},4e3))})}return __extends(i,t),i.$inject=["$scope","NotifyMeService","trackingService","modalService"],i}(BaseAngularController);n.NotifyMeController=t}(NotifyMeModule||(NotifyMeModule={}));app.controller("NotifyMeController",NotifyMeModule.NotifyMeController),function(n){var t=function(){function n(){}return n}();n.ProductAddModel=t}(NotifyMeModule||(NotifyMeModule={})),function(n){"use strict";var t=function(t){function i(i,r,u,f,e){t.call(this,r);n.PageTimeoutWarningScope=r;n.PageTimeoutWarningScope.SecondsRemaining=r.ClientConfiguration.PageTimeout.WarningMinutes*60;n.PageTimeoutWarningScope.LoginService=e;n.PageTimeoutWarningScope.RedirectUrl=n.PageTimeoutWarningScope.HomePageUrl+"?overlay=PageTimeoutModal";window.location.toString().indexOf("checkout")>-1&&(n.PageTimeoutWarningScope.RedirectUrl=n.PageTimeoutWarningScope.IsMobile?r.Url.Action("Index","Login")+"?mode=checkout&overlay=PageTimeoutModal":r.Url.Action("Index","Bag")+"?overlay=PageTimeoutModal");r.ContinueClicked=function(){clearInterval(n.PageTimeoutWarningScope.countdownTimer);$("#PageTimeoutWarningModal").remove();$("#AjaxModal").trigger("close");i.$broadcast("Do.ResetPageIdleTime")};n.PageTimeoutWarningScope.Countdown=function(){n.PageTimeoutWarningScope.SecondsRemaining=n.PageTimeoutWarningScope.SecondsRemaining-1;n.PageTimeoutWarningScope.SafeApply();n.PageTimeoutWarningScope.SecondsRemaining<1?(clearInterval(n.PageTimeoutWarningScope.countdownTimer),n.PageTimeoutWarningScope.Redirecting||n.PageTimeoutWarningScope.LoginService.logOut(!1,n.PageTimeoutWarningScope.RedirectUrl,n.PageTimeoutWarningScope.HomePageUrl)):n.PageTimeoutWarningScope.countdownTimer=setTimeout(n.PageTimeoutWarningScope.Countdown,1e3)};n.PageTimeoutWarningScope.countdownTimer=setTimeout(n.PageTimeoutWarningScope.Countdown,1e3)}return __extends(i,t),i.$inject=["$rootScope","$scope","contactService","trackingService","loginService"],i}(BaseAngularController);n.PageTimeoutWarningController=t}(PageTimeoutWarningModule||(PageTimeoutWarningModule={}));app.controller("PageTimeoutWarningController",PageTimeoutWarningModule.PageTimeoutWarningController),function(n){var t=function(t){function i(i,r,u){function f(t){for(var i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[i].Number===t)return i}t.call(this,i);n.productAddedToBagScope=i;n.productAddedToBagScope.product=AVON.product;n.productAddedToBagScope.AddToBagResult=AVON.TempModalModel;n.productAddedToBagScope.CampaignIndexInCart=f(n.productAddedToBagScope.Session.Customer.Campaign);var e=0;i.$on("ProductService.ProductsLoaded",function(n,t){t.Data.forEach(function(n){angular.element("#ProductAddedToBag .CrossSellContent .ProductItemContainer").each(function(){if(angular.element(this).attr("data-productid")==n.Id)return e++,!0})});e===0&&angular.element("#ProductAddedToBag .CrossSellSection").hide()});n.productAddedToBagScope.VariantName=function(t){var r,i;try{for(r=f(n.productAddedToBagScope.Session.Customer.Campaign),i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns[r].Items.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].Fsc===t&&n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName)return n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName.replace("Shade: ","")}catch(u){}return""};n.productAddedToBagScope.VariantType=function(t){var r,i;try{for(r=f(n.productAddedToBagScope.Session.Customer.Campaign),i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns[r].Items.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].Fsc===t&&n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName)return n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantType}catch(u){}return""};n.productAddedToBagScope.TotalQuantity=function(){for(var i=0,t=0;t<n.productAddedToBagScope.AddToBagResult.ItemsAdded.length;t++)i+=n.productAddedToBagScope.AddToBagResult.ItemsAdded[t].Quantity;return i};n.productAddedToBagScope.PayWithPal=function(){var t,i;$("#AjaxModal").trigger("close");n.productAddedToBagScope.ShowLoading(AVON.messages.spinner_loading);t={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/paypal/confirm"};n.productAddedToBagScope.OpenDynamicModal("PayPalExpressModal",t);i={Type:TrackingEventType.CartViewBagPayPalButtonClick};u.TrackEventItem(i)};n.productAddedToBagScope.ShowLoadingToCheckout=function(){var t={Type:TrackingEventType.CartViewBagCheckoutButtonClick};u.TrackEventItem(t);n.productAddedToBagScope.ShowLoading(AVON.messages.spinner_loading)};n.productAddedToBagScope.ShowPromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]),i,r;t.siblings("div").addClass("active");i=t.siblings(".Overlay.active");i.width(t.width()-(i.outerWidth(!0)-i.width()));r=t.siblings(".RotatedCaret45.active");r.css({"margin-left":t.width()/2-r.width()/2})};n.productAddedToBagScope.HidePromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]);t.children(".active").removeClass("active")};n.productAddedToBagScope.$on("ModalClosed",function(){r.$broadcast("ProductAddedToBagModalClosed")});n.productAddedToBagScope.PromotionActive=function(){var i=!1,r=0,t;if(n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart])for(t=0;t<n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items.length;t++)n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items[t].PfId===n.productAddedToBagScope.product.Id&&(r+=n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items[t].Quantity);return n.productAddedToBagScope.AddToBagResult.ProductPromotions.length>0&&r>=n.productAddedToBagScope.AddToBagResult.ProductPromotions[0].ConditionMinAmount&&(i=!0),i}}return __extends(i,t),i.$inject=["$scope","$rootScope","trackingService"],i}(BaseAngularController);n.ProductAddedToBagController=t}(ProductDetailModule||(ProductDetailModule={}));app.controller("ProductAddedToBagController",ProductDetailModule.ProductAddedToBagController),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.LoadCategoryHeroAndPromoSpots=function(n,i,r){var u="/api/content/category";u+="?language="+AVON.languageId;u+="&campaignNumber="+AVON.campaign;u+="&level2="+n.formatUrlNugget();u+="&level3="+i.formatUrlNugget();u+="&level4="+r.formatUrlNugget();this.GetJson(u,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductListService.HeroSpotLoaded",n.Data.view);t.rootScope.$broadcast("ProductListService.ProductSpotsLoaded",n.Data.model)})},t.prototype.GetProductsInCategory=function(n){var i=this;n&&t.rootScope.SessionService.WhenReady().then(function(){var r="/api/products/getproductsincategory";r+="?language="+AVON.languageId;r+="&campaign="+AVON.campaign;r+="&attached="+t.rootScope.Session.Customer.IsAttached;r+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;r+="&catId="+n;i.GetJson(r,!0,!0,!0).then(function(n){t.rootScope.$broadcast("ProductListService.ProductCategoryLoaded",n.Data)})})},t.prototype.GetProductsBySearch=function(n){var i="/api/search/getproductsbysearch/"+n;n.trim().length===0&&(i="/api/search/getproductsforemptysearch/");this.GetJson(i,!0,!1,!0).then(function(n){n.Data.RedirectionUrl!==undefined&&n.Data.RedirectionUrl!==null?t.rootScope.$broadcast("ProductListService.ProductSearchRedirection",n.Data.RedirectionUrl):t.rootScope.$broadcast("ProductListService.ProductSearchLoaded",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ProductListService=t}(ProductListServiceModule||(ProductListServiceModule={}));app.service("productListService",ProductListServiceModule.ProductListService),function(n){var t=function(n){function t(t,i,r,u,f){function s(){var n=$("#model-values");return{showMoreProductsAfter:n.data("showMoreProductsAfter"),loadHowManyProducts:n.data("loadHowManyProducts"),productsLookup:n.data("productsLookup"),categoriesLookup:n.data("categoriesLookup"),productLineId:n.data("productLineId"),displaySortControl:n.data("displaySortControl")}}function o(n,t){if(t===void 0&&(t=!1),n){var r;r=t===!0?n.Products:n.Data;r.forEach(function(n){i.products.push(n)})}}n.call(this,i);i.products=[];i.promoSpots=[];AVON.Navigation&&AVON.Navigation.Content&&(i.promoSpots=AVON.Navigation.Content.ProductPromotionSpots);var e=s();i.showMoreProductsAfter=e.showMoreProductsAfter;i.loadHowManyProducts=e.loadHowManyProducts;i.productsLookup=e.productsLookup;i.categoriesLookup=e.categoriesLookup;i.productLineId=e.productLineId;i.displaySortControl=e.displaySortControl;u.GetProductLine(i.productLineId,0);f.GetProductsInCategory(i.categoriesLookup[i.categoriesLookup.length-1]);i.$on("ProductService.ProductsLoaded",function(n,t){t.Data.forEach(function(n){var t=$.inArray(n.Id,i.productsLookup);t>=0&&(i.products.push(n),i.productsLookup.splice(t,1))})});i.$on("ProductService.ProductLineLoaded",function(n,t,i){o(i)});i.$on("ProductListService.ProductCategoryLoaded",function(n,t){o(t,!0)});i.isSortControlShown=function(){return i.products.length===0?!1:i.displaySortControl};i.showMoreButton=function(){return i.products.length>i.showMoreProductsAfter};i.ExpandedAddToBagId=null;angular.forEach(i.products,function(n){n.Name=i.SecureHtml(n.Name)});i.IncreaseShowProductCount=function(){i.showMoreProductsAfter+=i.loadHowManyProducts;i.SafeApply()};i.getSortingCriteria=function(){switch(i.sortingCriteria){case"Price":return["-IsAvailable","PriceModel.ListPrice","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Rating":return["-IsAvailable","-HasRating","-Rating","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Name":return["-IsAvailable","Name","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];default:return["-IsAvailable","ListIndex","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"]}};i.GoToProductPage=function(n,t){i.RedirectToUrl(i.Url.Action("Details","Product")+"/"+t+"-"+n)};i.GetSimplePromoSpot=function(n,t){for(var r=0;r<i.promoSpots.length;r++)if(i.promoSpots[r].IndexLocation==n||t&&i.promoSpots[r].IndexLocation>=n)return i.promoSpots[r];return null};i.AddToBag=function(n,t){var f=n.Sku,u;n.SelectedVariantSku&&(f=n.SelectedVariantSku);u=new AddBagItem;u.Quantity=t||1;u.Sku=f;u.Id=n.Id;AVON.product=n;i.ShowLoading(AVON.messages.spinner_adding);r.addItemToBag(u,!0)};i.ToggleAddToBag=function(n){i.ExpandedAddToBagId=i.ExpandedAddToBagId==n?null:n};i.ShowPromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t=$(i).parents(".ProductSummary").find(".Expandable");t.hasClass("Expanded")?t.removeClass("Expanded"):t.addClass("Expanded")};i.SortChanged=function(){i.SafeApply()};_.defer(function(){i.$watch("products",function(){_.defer(function(){app.safeLoadImages($(".SimpleProductList"))})},!0)})}return __extends(t,n),t.$inject=["$rootScope","$scope","bagService","productService","productListService"],t}(BaseAngularController);n.ProductListModuleController=t}(ProductListControlModule||(ProductListControlModule={}));app.controller("ProductListModuleController",ProductListControlModule.ProductListModuleController),function(n){var t=function(n){function t(t,i){function r(n,i){t.SetValueIntoSessionStorage(n,i)}n.call(this,t);this.$scope=t;this.searchService=i;t.SearchTerm=AVON.SearchTerm;t.SearchShowAmountLimit=t.IsBlog()?t.ClientConfiguration.BlogProductListPageSize:t.ClientConfiguration.ProductListPageSize;t.UserIsLoggedInFromBlogSearchPageSessionKeyValue="UserIsLoggedInFromBlogSearchPage";t.SelectedResultsTab=SearchTermType.Celebros;t.SelectResultsTab=function(n){t.SelectedResultsTab=n};i.getArticleResults(t.SearchTerm).then(function(n){return t.ArticleResults=n,t.VisibleProductsCount=t.IsBlog()?t.ClientConfiguration.BlogProductListPageSize>t.ArticleResults.length?t.ArticleResults.length:t.ClientConfiguration.BlogProductListPageSize:t.ClientConfiguration.ProductListPageSize>t.ArticleResults.length?t.ArticleResults.length:t.ClientConfiguration.ProductListPageSize,n});t.IncreaseSearchShowAmountLimit=function(){t.SearchShowAmountLimit+=t.IsBlog()?t.ClientConfiguration.BlogProductListPageSize:t.ClientConfiguration.ProductListPageSize;t.VisibleProductsCount=t.SearchShowAmountLimit;t.VisibleProductsCount>t.ArticleResults.length&&(t.VisibleProductsCount=t.ArticleResults.length);t.VisibleProductsCountUpdated=!0;t.SafeApply()};t.Init=function(n){t.SelectedResultsTab=AVON.CelebrosSearchTerm?SearchTermType.Celebros:n};var u=t.GetValueFromSessionStorage(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue);u?(r(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!1),t.Init(0)):t.Init(1);t.$on("ProductListService.ProductSearchLoaded",function(n,i){t.ProductResults=i.Data.products});t.$on("LoginService.LoginResponse",function(n,i){i.ErrorCode===AjaxError.None&&r(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!0)});t.$on("LoginService.FacebookLoginResponse",function(n,i){i.status===200&&i.data.Data===""&&r(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!0)});t.$on("LoginService.AutoLoginResponse",function(n,i){i.ErrorCode===AjaxError.None&&r(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!0)})}return __extends(t,n),t.$inject=["$scope","searchService"],t}(BaseAngularController);n.SearchResultsController=t}(SearchResultsModule||(SearchResultsModule={}));app.controller("SearchResultsController",SearchResultsModule.SearchResultsController),function(n){(function(n){n[n.None=0]="None";n[n.Adding=1]="Adding";n[n.Added=2]="Added"})(n.AddingToBagStatus||(n.AddingToBagStatus={}));var t=n.AddingToBagStatus}(SimpleProductListModule||(SimpleProductListModule={})),function(n){(function(n){n[n.None=0]="None";n[n.AddToBag=1]="AddToBag";n[n.SelectVariant=2]="SelectVariant";n[n.NotifyMe=3]="NotifyMe"})(n.PlpActionButton||(n.PlpActionButton={}));var t=n.PlpActionButton}(SimpleProductListModule||(SimpleProductListModule={})),function(n){var t=function(){function n(){}return n}();n.ProductListProductViewModel=t}(SimpleProductListModule||(SimpleProductListModule={})),function(n){var t=function(t){function i(i,r,u,f,e,o){var s=this;t.call(this,r);n.simpleProductListScope=r;r.products=[];r.mySimpleProductList=[];r.promoSpots=[];AVON.Navigation&&AVON.Navigation.Content&&(r.promoSpots=AVON.Navigation.Content.ProductPromotionSpots);r.SetValueIntoSessionStorage("SelectedProductLineId",AVON.SelectedProductLineId||"");r.ExpandedAddToBagId=null;r.AddToBagClientSideValidationError=!1;angular.forEach(r.products,function(n){n.Name=r.SecureHtml(n.Name)});r.showProductCount=20;r.SessionService.WhenReady().then(function(){r.showProductCount=r.IsBlog()?r.ClientConfiguration.BlogProductListPageSize:r.ClientConfiguration.ProductListPageSize;r.SafeApply()});r.IncreaseShowProductCount=function(){r.showProductCount+=r.IsBlog()?r.ClientConfiguration.BlogProductListPageSize:r.ClientConfiguration.ProductListPageSize;r.SafeApply()};r.getSortingCriteria=function(){switch(r.sortingCriteria){case"Price":return["-IsAvailable","PriceModel.ListPrice","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Rating":return["-IsAvailable","-HasRating","-Rating","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Name":return["-IsAvailable","Name","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];default:return["-IsAvailable","ListIndex","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"]}};r.GoToProductPage=function(n,t){if($(".ie").length>0){var i=[];$("div[data-product-summary-id]").each(function(){var n=parseInt($(this).attr("data-product-summary-id"),10);n>0&&i.push(n)});r.SetValueIntoSessionStorage("ListedProductsIdsOrder",i)}r.RedirectToUrl(r.Url.Action("Details","Product")+"/"+t+"-"+n)};r.GetSimplePromoSpot=function(n,t){for(var i,u=0;u<r.promoSpots.length;u++)if(i=r.promoSpots[u],t){if(i.IndexLocation>n)return i}else if(i.IndexLocation==n)return i;return null};r.AddToBag=function(n,t){var u,i;if(!n.SelectedVariantSku&&n.VariantGroups.length>1){r.AddToBagClientSideValidationError=!0;return}r.AddToBagClientSideValidationError=!1;u=n.Sku;n.SelectedVariantSku&&(u=n.SelectedVariantSku);i=new AddBagItem;i.Quantity=t||1;i.Sku=u;i.Id=n.Id;AVON.product=n;r.ShowLoading(AVON.messages.spinner_adding);f.addItemToBag(i,!0)};r.ShadeChanged=function(){_.defer(function(){r.AddToBagClientSideValidationError=!1;r.SafeApply()})};r.ToggleAddToBag=function(n){r.ExpandedAddToBagId==n?(r.ExpandedAddToBagId=null,r.ShadeChanged()):r.ExpandedAddToBagId=n};r.ShowPromotionOverlay=function(n){var e,i,u,t,f;if(r.IsMobile){e=$(angular.element(n.currentTarget)[0]);i=$(e).parents(".ProductSummary").find(".Expandable");i.hasClass("Expanded")?i.removeClass("Expanded"):i.addClass("Expanded");return}u=$(angular.element(n.currentTarget)[0]);u.siblings("div").addClass("active");t=u.siblings(".Overlay.active");t.width(t.parent().width()-(t.outerWidth(!0)-t.width()));f=u.siblings(".RotatedCaret45.active");f.css({"margin-left":t.outerWidth(!0)/2-f.width()/2})};r.HidePromotionOverlay=function(n){var t,i;if(r.IsMobile){t=$(angular.element(n.currentTarget)[0]);$(t).parents(".Expandable.Expanded").removeClass("Expanded");return}i=$(angular.element(n.currentTarget)[0]);i.children(".active").removeClass("active")};$(u[0]).find("[data-productidlist]:not([data-productidlist=''])").each(function(){var n=$(this).attr("data-productidlist").split(",");n.forEach(function(n){var t=parseInt(n.trim(),10);r.mySimpleProductList.push(t)})});r.$on(ProductServiceModule.ProductService.ProductsLoadedBroadcastName,function(n,t){for(var u,f,o=s.initializeViewModel(t.Data),i=0,e=o;i<e.length;i++)u=e[i],f=$.inArray(u.Id,r.mySimpleProductList),f>=0&&(r.products.push(u),r.mySimpleProductList.splice(f,1))});r.SortChanged=function(){r.SafeApply()};_.defer(function(){r.$watch("products",function(){_.defer(function(){app.safeLoadImages($(".SimpleProductList"))})},!0)});r.SelectVariantClicked=function(n){n.VariantsContainerOpen=!n.VariantsContainerOpen;n.VariantsContainerOpen&&(n.ShowVariantsList=!0,n.VariantGroups&&n.VariantGroups.length!=0||(n.LoadingVariants=!0,o.GetProductWithId(n.Id).then(function(t){n.VariantGroups=s.initializeVariantsViewModel(t.VariantGroups);n.LoadingVariants=!1})))};r.VariantsCloseButtonClicked=function(n){n.VariantsContainerOpen=!1};r.VariantButtonClicked=function(n,t,i){t.SelectedVariant=i;t.ShowVariantsList=!1;var r=$(n.currentTarget).closest(".ProductSummary").offset().top-$("#FixedMenu").height();$("html, body").stop().animate({scrollTop:r},500,"swing")};r.VariantSelectButtonClicked=function(n){n.ShowVariantsList=!0};r.AddToBagButtonClicked=function(t){var o=2e3,u=new AddBagItem,i,e;u.Quantity=1;t.HasVariants&&t.TotalVariants>1?(i=t.SelectedVariant,u.Sku=i.Sku):u.Sku=t.Sku;e=_.throttle(function(i){t.AddingToBagStatus=i;r.SafeApply();i==n.AddingToBagStatus.Added&&_.delay(function(){t.AddingToBagStatus=n.AddingToBagStatus.None;r.SafeApply()},o)},1e3);e(n.AddingToBagStatus.Adding);f.addItemToBag(u,!1).then(function(){t.HasVariants&&t.TotalVariants>1?i.AddedToBagCount=i.AddedToBagCount?i.AddedToBagCount+1:1:t.AddedToBagCount=t.AddedToBagCount?t.AddedToBagCount+1:1;e(n.AddingToBagStatus.Added)})};r.DisplayVariantLineNumber=function(n,t){return ProductHelper.DisplayVariantLineNumber(n,t)};r.IsVariantAvailableSoon=function(n){return n.Availability==CanBuy.AvailableSoon};r.GetVariantSelectPlaceholderText=function(n,t){return n+" "+AVON.VariantTypesLocalized[t].toLocaleLowerCase()};r.GetVariantName=function(n,t){var i=""+n.VariantValue+ProductHelper.DisplayVariantLineNumber(n,!0);return r.IsVariantAvailableSoon(n)&&(i+=" � "+t),i};r.NotifyMeButtonClicked=function(n,t){return e.OpenNotifyMeModal(n,t)};r.GetButtonToDisplay=function(t){return t.PriceModel.AutoReplenishmentPrice?n.PlpActionButton.None:t.IsAvailable||t.CanBuy!=CanBuy.AvailableSoon?t.HasVariants&&t.TotalVariants>1?n.PlpActionButton.SelectVariant:n.PlpActionButton.AddToBag:n.PlpActionButton.NotifyMe}}return __extends(i,t),i.prototype.initializeViewModel=function(t){var i=this;return _.map(t,function(t){var r=t;return r.SelectedVariant=null,r.AddedToBagCount=0,r.AddingToBagStatus=n.AddingToBagStatus.None,r.ShowVariantsList=!1,r.VariantsContainerOpen=!1,r.LoadingVariants=!1,r.VariantGroups=i.initializeVariantsViewModel(t.VariantGroups),r})},i.prototype.initializeVariantsViewModel=function(n){return _.map(n,function(n){var t=n;return t.Variants=_.map(t.Variants,function(n){var t=n;return t.AddedToBagCount=0,t}),t})},i.$inject=["$rootScope","$scope","$element","bagService","NotifyMeService","productService"],i}(BaseAngularController);n.SimpleProductListCtrl=t}(SimpleProductListModule||(SimpleProductListModule={}));app.controller("SimpleProductListController",SimpleProductListModule.SimpleProductListCtrl),function(n){"use strict";var i=function(){function n(){this.Caption="";this.Title="";this.IconCode="";this.AlternativeText="";this.IconUrl="";this.IconColor="";this.Url="";this.Id=null;this.Target="";this.SortOrder=null;this.AdditionalLinks=null;this.GroupNames=null;this.GroupedChildren=null;this.Children=null;this.TopPromotionThumbnails=null;this.IncludeInTopNavigation=null;this.IncludeInTopBrandsNavigation=null;this.IncludeInAllBrandsPage=null;this.IncludeInLeftNavigation=null;this.AlphabetLetter=null;this.Type=""}return n}(),t=function(t){function i(i,r){t.call(this,i);n.siteMapScope=i;n.siteMapScope.AllCategories=AVON.TopNavigation;n.siteMapScope.AllBrands=[];r.GetFeaturedBrands();r.GetTopNavigationCategories();n.siteMapScope.$on("NavigationService.MenuLoaded",function(t,i){var e,a,o,u,r,l,f,y;for(n.siteMapScope.AllCategories=i.Data.TopMenuItems,n.siteMapScope.BlogTopNavigation=i.Data.BlogTopNavigation,angular.forEach(n.siteMapScope.AllCategories,function(t){t.Type==="Brand"&&t.Caption&&t.Caption.length>0&&(t.IncludeInAllBrandsPage=t.IncludeInTopNavigation,n.siteMapScope.AllBrands.push(t));angular.forEach(t.GroupNames,function(i){(i.toLowerCase()==="brands"||i.toLowerCase()==="marcas")&&angular.forEach(t.GroupedChildren[i],function(t){t.IncludeInAllBrandsPage&&t.Caption&&t.Caption.length>0&&n.siteMapScope.AllBrands.push(t)})})}),n.siteMapScope.AllCategories.sort(function(n,t){var i=n.Caption.toUpperCase(),r=t.Caption.toUpperCase();return i<r?-1:i>r?1:0}),n.siteMapScope.LanguageCode==="es"?(e=6,a=3):(e=5,a=3),n.siteMapScope.BalancedCategories=[],o=0;o<=e;o++)n.siteMapScope.BalancedCategories[o]=[];for(u=0,r=0;r<n.siteMapScope.AllCategories.length;r++){if(n.siteMapScope.AllCategories[r].Caption==="mark"||n.siteMapScope.AllCategories[r].Caption==="Cuidado Personal"){n.siteMapScope.BalancedCategories[u+1].push(n.siteMapScope.AllCategories[r]);u+=2;continue}r!==0&&r%a==0&&u++;u>e&&(u=e);n.siteMapScope.BalancedCategories[u].push(n.siteMapScope.AllCategories[r])}n.siteMapScope.AllBrands.sort(function(n,t){var i=n.Caption.toUpperCase(),r=t.Caption.toUpperCase();return i<r?-1:i>r?1:0});var s=0,v=3,p=16,h=0,c=0;for(n.siteMapScope.AllBrandsColumnBalanced=[],l=0;l<=v;l++)n.siteMapScope.AllBrandsColumnBalanced[l]=[];for(f=0;f<n.siteMapScope.AllBrands.length;f++){if(h++,n.siteMapScope.AllBrands[f].Children)for(y=0;y<n.siteMapScope.AllBrands[f].Children.length;y++)h++;c+=h;c>p&&(s++,c=c-p);s>v&&(s=v);n.siteMapScope.AllBrandsColumnBalanced[s].push(n.siteMapScope.AllBrands[f]);h=0}})}return __extends(i,t),i.$inject=["$scope","NavigationService"],i}(BaseAngularController);n.SiteMapController=t}(SiteMapModule||(SiteMapModule={}));app.controller("SiteMapController",SiteMapModule.SiteMapController),function(n){var t=function(t){function i(i,r){function u(t,i){n.subscribeScope.subscribeService=i;n.subscribeScope.SubscribeModel={Email:"",Source:EmailSubscriptionSource.Unknown,FirstName:"",LastName:""};n.subscribeScope.ResponseCalled=!1;n.subscribeScope.DisplayEmailError=!1;n.subscribeScope.subscribeSuccess=!1}t.call(this,i);n.subscribeScope=i;u(n.subscribeScope,r);n.subscribeScope.InputFocus=function(){n.subscribeScope.DisplayEmailError=!1};n.subscribeScope.openSubscribeModal=function(){if(n.subscribeScope.SubscribeForm.$valid){n.subscribeScope.ShowValidation=!1;var t={AllowExit:!0,Model:n.subscribeScope,KeepLoaded:!1,UrlToLoad:"/api/subscribe/getSubscribeModal",CssClass:"full-size-modal-dialog"};n.subscribeScope.OpenDynamicModal("SubscribeModal",t,n.subscribeScope)}else n.subscribeScope.ShowValidation=!0};n.subscribeScope.closeSubscribeModal=function(){$("#SubscribeModal").trigger("close")};n.subscribeScope.subscribeSubmit=function(t){t===void 0&&(t=EmailSubscriptionSource.Unknown);n.subscribeScope.SubscribeFormModal=angular.element("form[name='SubscribeFormModal']").controller("form");n.subscribeScope.SubscribeFormModal.$valid?(n.subscribeScope.ShowValidation=!1,n.subscribeScope.SubscribeModel.Source=t,n.subscribeScope.ShowLoading(AVON.messages.spinner_subscribing),r.subscribeEmail(n.subscribeScope.SubscribeModel,$("form[name=SubscribeFormModal]"))):n.subscribeScope.ShowValidation=!0};n.subscribeScope.$on("SubscribeService.SubscribeResponse",function(t,i){n.subscribeScope.ResponseCalled||(i.ErrorCode===AjaxError.ValidationErrors?(n.subscribeScope.ProcessAjaxValidationErrors(i),n.subscribeScope.ShowValidation=!0):(u(n.subscribeScope,r),n.subscribeScope.subscribeSuccess=!0,n.subscribeScope.SafeApply()),n.subscribeScope.ResponseCalled=!0)})}return __extends(i,t),i.$inject=["$scope","subscribeService"],i}(BaseAngularController);n.SubscribeController=t}(SubscribeModule||(SubscribeModule={}));app.controller("SubscribeController",SubscribeModule.SubscribeController),function(n){var t=function(t){function i(i,r,u,f,e){t.call(this,i,r);this.$scope=i;n.sweepstakesScope=i;n.sweepstakesScope.SocialShareService=f;n.sweepstakesScope.StatesAll=AVON.States;n.sweepstakesScope.SignUpForOffers=!0;n.sweepstakesScope.Over18Years=!1;n.sweepstakesScope.ReCaptchaEnabled=typeof grecaptcha!="undefined";n.sweepstakesScope.ReCaptchaCallback=function(){n.sweepstakesScope.ReCaptchaError="";n.sweepstakesScope.SafeApply()};r.ReCaptchaCallback=n.sweepstakesScope.ReCaptchaCallback;r.ReCaptchaError=n.sweepstakesScope.ReCaptchaError;n.sweepstakesScope.SubmitSweepstakesForm=function(){if(n.sweepstakesScope.ReCaptchaError="",n.sweepstakesScope.sweepstakesForm.$setSubmitted(),n.sweepstakesScope.IsEmailValid(n.sweepstakesScope.Email)||n.sweepstakesScope.sweepstakesForm.email.$setValidity("email",!1),n.sweepstakesScope.sweepstakesForm.$valid){var r={FirstName:i.FirstName,LastName:i.LastName,AddressLine1:i.AddressLine1,AddressLine2:i.AddressLine2,City:i.City,State:i.State,Zip:i.ZipCode,PhoneNumber:i.PhoneNumber,Email:i.Email,SignUpForOffers:i.SignUpForOffers,SweepsCode:AVON.SweepstakeCode,SweepstakeUrlName:AVON.SweepstakeUrlName},t=n.sweepstakesScope.ReCaptchaEnabled?grecaptcha.getResponse():"ReCaptchaDisabled";if(!t){n.sweepstakesScope.ReCaptchaError=AVON.messages.reCaptchaNotChecked;grecaptcha.reset();return}e.SubmitSweepstakesForm(r,t);n.sweepstakesScope.ShowLoading(AVON.messages.spinner_saving)}else n.sweepstakesScope.ReCaptchaError="",n.sweepstakesScope.ReCaptchaEnabled&&grecaptcha.reset()};n.sweepstakesScope.$on("SweepstakesService.SubmitSweepstakesForm",function(t,i){i.ErrorCode===AjaxError.ValidationErrors&&($.each(i.ValidationErrors,function(t,i){i.FieldName.indexOf("ReCaptcha")>-1&&(n.sweepstakesScope.ReCaptchaError=AVON.messages.reCaptchaErrorMessage)}),n.sweepstakesScope.ReCaptchaEnabled&&grecaptcha.reset())});n.sweepstakesScope.$on("AddressesScope.ZipCodeDetails",function(t,i){i.IsValidZip&&(n.sweepstakesScope.State=i.State,n.sweepstakesScope.City=i.City);var r=i.IsValidZip;n.sweepstakesScope.sweepstakesForm.zipCode.$setValidity("validateZipcode",r);n.sweepstakesScope.SafeApply()});n.sweepstakesScope.CustomerInfoLoaded=!1;u.WhenReady().then(function(){var t=n.sweepstakesScope.Session.Customer,r;t&&t.IsLoggedIn&&(n.sweepstakesScope.FirstName=t.FirstName,n.sweepstakesScope.LastName=t.LastName,n.sweepstakesScope.PhoneNumber=t.Phone,n.sweepstakesScope.Email=t.Email,n.sweepstakesScope.Session.Customer.BillingAddress&&(n.sweepstakesScope.AddressLine1=t.BillingAddress.Address1,n.sweepstakesScope.AddressLine2=t.BillingAddress.Address2,n.sweepstakesScope.City=t.BillingAddress.City,r=_.find(n.sweepstakesScope.StatesAll,function(n){return n.Code===t.BillingAddress.State}),r&&(n.sweepstakesScope.State=r.Code),i.ZipCode=t.BillingAddress.Zip.substring(0,5)));n.sweepstakesScope.CustomerInfoLoaded=!0})}return __extends(i,t),i.$inject=["$scope","$window","sessionService","socialShareService","sweepstakesService"],i}(BaseAngularController);n.SweepstakesController=t}(SweepstakesModule||(SweepstakesModule={}));app.controller("SweepstakesController",SweepstakesModule.SweepstakesController),function(n){"use strict";var t=function(t){function i(i,r){t.call(this,i,r);this.$scope=i;n.videoShareScope=i;n.videoShareScope.account=AVON.brightCoveAccount;n.videoShareScope.player=n.videoShareScope.QueryString().player;n.videoShareScope.video=n.videoShareScope.QueryString().video;n.videoShareScope.videoLoaded=!1;n.videoShareScope.player||(n.videoShareScope.player=AVON.brightCoveDefaultPlayerId);this.loadScript(r)}return __extends(i,t),i.prototype.loadScript=function(t){var r=this,i=document.createElement("script");i.type="text/javascript";i.src="//players.brightcove.net/"+n.videoShareScope.account+"/"+n.videoShareScope.player+"_default/index.min.js";document.getElementsByTagName("head")[0].appendChild(i);i.onerror=function(){n.videoShareScope.player!==AVON.brightCoveDefaultPlayerId&&(n.videoShareScope.player=AVON.brightCoveDefaultPlayerId,r.loadScript(t))};i.onload=function(){var i=document.getElementById("brightcovePlayerID"),r;i.setAttribute("data-account",n.videoShareScope.account);i.setAttribute("data-player",n.videoShareScope.player);i.setAttribute("data-video-id",n.videoShareScope.video);t.bc(i);r=videojs("brightcovePlayerID");r.ready(function(){var t=this;n.videoShareScope.videoLoaded=!0;document.getElementById("brightcovePlayerID").classList.remove("ng-hide");r.on("loadstart",function(){$("#videoTitle").text(t.mediainfo.name)});r.on("error",function(){var i=t.error();t.errorDisplay.hide();n.videoShareScope.RedirectToUrl("/error/error404",!0)})})}},i.$inject=["$scope","$window"],i}(BaseAngularController);n.VideoShareController=t}(VideoShareModule||(VideoShareModule={}));app.controller("VideoShareController",VideoShareModule.VideoShareController),function(n){var t=function(t){function i(i,r,u,f,e){t.call(this,i);n.welcomeBackScope=i;n.welcomeBackScope.SignInOnly=n.welcomeBackScope.IsAutoReplenishmentInCart();n.welcomeBackScope.$on("ModalShown",function(){n.welcomeBackScope.InitializeForm();_.delay(function(){$("#LoginModel_PasswordInput").focus()},200)});n.welcomeBackScope.ContinueAsGuest=function(){$("#WelcomeBack").trigger("close");r.$broadcast("WelcomeBackScope.ContinueAsGuest")};n.welcomeBackScope.Login=function(){if(n.welcomeBackScope.LoginForm.$valid===!1){n.welcomeBackScope.ShowValidation=!0;return}n.welcomeBackScope.ShowValidation=!1;n.welcomeBackScope.ShowLoading(AVON.messages.spinner_login);n.welcomeBackScope.LoginModel.ReturnUrl=n.welcomeBackScope.Url.Action("Index","Checkout");u.login(n.welcomeBackScope.LoginModel,$("form[name=LoginForm]"),n.welcomeBackScope)};n.welcomeBackScope.$on("LoginService.LoginResponse",function(t,i,r){i.ErrorCode===AjaxError.ValidationErrors?r==n.welcomeBackScope&&(n.welcomeBackScope.HideLoading(),n.welcomeBackScope.ShowValidation=!0,n.welcomeBackScope.ProcessAjaxValidationErrors(i),_.defer(function(){$.each(i.ValidationErrors,function(t,i){n.welcomeBackScope.LoginForm[i.FieldName]!==undefined&&(n.welcomeBackScope.LoginForm[i.FieldName].$invalid=!0);var u=$(".ErrorSummaryContainer .ValidationSummaryServer span a");e(u)(r)})})):f.TrackEventItem({Type:TrackingEventType.LoginSuccessful})});n.welcomeBackScope.ShowForgotPasswordForm=function(){n.welcomeBackScope.IsMobile?(n.welcomeBackScope.ShowLoading(AVON.messages.spinner_loading),u.convertEmail(n.welcomeBackScope.LoginModel.Email,"LoginService.ConvertEmailForWelcomeBack")):(n.welcomeBackScope.DisplayForgotPasswordForm=!0,n.welcomeBackScope.ShowValidation=!1)};n.welcomeBackScope.$on("LoginService.ConvertEmailForWelcomeBack",function(t,i){if(i.Data!=null){var r=n.welcomeBackScope.SignInPageUrl()+"/forgotpassword?tokenemail="+i.Data+"&returnurl="+n.welcomeBackScope.Url.Action("Index","Checkout")+"&mode="+n.welcomeBackScope.LoginModel.Mode;n.welcomeBackScope.RedirectToUrl(r)}});n.welcomeBackScope.InitializeForm=function(){n.welcomeBackScope.LoginModel={Email:AVON.TempModalModel!=null?AVON.TempModalModel.Email:"",Password:"",Mode:"",ReturnUrl:""};n.welcomeBackScope.DisplayForgotPasswordForm=!1;_.defer(function(){n.welcomeBackScope.UpdateInlineWaterMark()},200)};$(document).on("click","#DisplayRegistrationModal",function(t){t.preventDefault();$("#LoginModal").trigger("close");n.welcomeBackScope.ShowLoading(AVON.messages.spinner_loading);var i={UrlToLoad:n.welcomeBackScope.SignInPageUrl()+"/registrationoverlay",AllowExit:!0,KeepLoaded:!1,Model:{Email:n.welcomeBackScope.LoginModel.Email}};$("#RegistrationModal").trigger("modal",i)})}return __extends(i,t),i.$inject=["$scope","$rootScope","loginService","trackingService","$compile"],i}(BaseAngularController);n.WelcomeBackController=t}(WelcomeBackModule||(WelcomeBackModule={}));app.controller("WelcomeBackController",WelcomeBackModule.WelcomeBackController),function(n){var t=function(t){function i(i,r,u,f,e,o){t.call(this,i,r,u);this.urlService=f;this.cdnService=e;this.$window=o;n.homePageUrl=AVON.LanguageCode==="es"?"/es/":"/"}return __extends(i,t),i.prototype.GetFacebookShareUrl=function(t,i,r){t===void 0&&(t=0);r===void 0&&(r=null);i||(i=this.$window.location.origin+this.$window.location.pathname);var u=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(i)+"&platform=facebook";return r&&(u+="&profileNumber="+encodeURIComponent(r)),t&&(u+="&repId="+encodeURIComponent(t.toString())),u},i.prototype.GetPinterestShareUrl=function(t,i,r,u,f){var e,o;return r===void 0&&(r=0),f===void 0&&(f=null),u||(u=this.$window.location.origin+this.$window.location.pathname),e=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(u)+"&platform=pinterest",f&&(e+="&profileNumber="+encodeURIComponent(f)),r&&(e+="&repId="+encodeURIComponent(r.toString())),i&&(o=this.cdnService.productImageXtraLarge(i),e+="&imageUrl="+encodeURIComponent(o)),t&&(e+="&description="+encodeURIComponent(this.TruncateIfNecessary(t.replace(/<\/?[^>]*>/g,""),500))),e},i.prototype.GetTumblrShareUrl=function(t,i,r,u,f){u===void 0&&(u=0);f===void 0&&(f=null);var e=null;return t&&(e=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(t)+"&platform=tumblr",f&&(e+="&profileNumber="+encodeURIComponent(f)),u&&(e+="&repId="+encodeURIComponent(u.toString())),e+="&name="+encodeURIComponent(i)+"&posttype=photo&description="+encodeURIComponent(this.TruncateIfNecessary(r.replace(/<\/?[^>]*>/g,"")))),e},i.prototype.GetTwitterShareUrl=function(t,i,r,u){i===void 0&&(i=0);u===void 0&&(u=null);r||(r=this.$window.location.origin+this.$window.location.pathname);var f=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(r)+"&platform=twitter";return u&&(f+="&profileNumber="+encodeURIComponent(u)),i&&(f+="&repId="+encodeURIComponent(i.toString())),f+("&description="+encodeURIComponent(this.TruncateIfNecessary(t)))},i.prototype.GetGooglePlusShareUrl=function(t,i,r){i===void 0&&(i=0);r===void 0&&(r=null);var u=null;return t&&(u=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(t)+"&platform=googleplus",r&&(u+="&profileNumber="+encodeURIComponent(r)),i&&(u+="&repId="+encodeURIComponent(i.toString()))),u},i.prototype.GetProductShareUrl=function(n){var r=null,i,t;return n>0&&(i=AVON.LanguageCode,t=this.urlService.Action(n.toString(),"Product"),i=="es"&&t.indexOf("es/product")==-1&&(t=t.replace("product","es/product")),r="https://"+this.$window.location.host+t+"?setlang="+i),r},i.prototype.TruncateIfNecessary=function(n,t){return t===void 0&&(t=1024),n!=null&&n.length>t&&(n=n.substring(0,t-3)+"..."),n},i.$inject=["$rootScope","$http","$q","urlService","cdnService","$window"],i}(BaseAvonService);n.SocialShareService=t}(SocialShareServiceModule||(SocialShareServiceModule={}));app.service("socialShareService",SocialShareServiceModule.SocialShareService);WishListItem=function(){function n(n,t,i,r){this.ProductId=n;this.Sku=t;this.AutoReplenishmentFrequency=i;this.Availability=r}return n}(),function(n){(function(n){n[n.MyFavourites=0]="MyFavourites";n[n.MyRecommendation=1]="MyRecommendation"})(n.WishListMailingOption||(n.WishListMailingOption={}));var i=n.WishListMailingOption,t=function(n){function t(t,i,r,u){var f=this;n.call(this,t,i,r);this.$rootScope=t;this.$http=i;this.$q=r;this.productDic={};u.WhenReady().then(function(){f.RefreshWishListDic()})}return __extends(t,n),t.prototype.AddToWishList=function(n){var t=this,r,i;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(i=n,i=this.DeduplicateVariants(i,this.$rootScope.Session.Customer.WishList.Products),r=this.PostJson("/api/wishlist/add",i).success(function(n){n&&!!n.Data&&(t.$rootScope.Session.Customer.WishList.Products=t.$rootScope.Session.Customer.WishList.Products.concat(n.Data),t.RefreshWishListDic(),t.$rootScope.SafeApply())}).error(function(){})),r},t.prototype.UpdateProductVariantInWishList=function(n,t){var i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={wishListProductId:n,sku:t},i=this.postAndBroadcast("/api/wishlist/updateproductvariant",r,"WishListService.UpdateProductInWishList")),i},t.prototype.UpdateProductFrequencyInWishList=function(n,t){var i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={wishListProductId:n,autoReplenishmentFrequency:t},i=this.postAndBroadcast("/api/wishlist/updateproductfrequency",r,"WishListService.UpdateProductFrequencyInWishList")),i},t.prototype.UpdateProductCommentInWishList=function(n,t){var i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={wishListProductId:n,comment:t},i=this.postAndBroadcast("/api/wishlist/updateproductcomment",r,"WishListService.UpdateProductCommentInWishList")),i},t.prototype.postAndBroadcast=function(n,t,i,r){var u=this;return this.PostJson(n,t,r).success(function(n){n&&u.$rootScope.$broadcast(i,n)}).error(function(n){u.$rootScope.$broadcast(i,n)})},t.prototype.CreateSharedWishList=function(n,t,i){var r=this,u,f;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(f={wishListProductIds:n,shareType:t},u=this.PostJson("/api/wishlist/createsharedwishlist",f).success(function(n){n&&r.$rootScope.$broadcast("WishListService.CreateSharedWishList",n,t,i)}).error(function(n){r.$rootScope.$broadcast("WishListService.CreateSharedWishList",n,t,i)})),u},t.prototype.ShareWishListByEmail=function(n,t,i,r,u,f,e){var o,s;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(s={recipients:n,sender:t,recommendTo:i,description:r,sendMeCopy:u,wishListProductIds:f},o=this.postAndBroadcast("/api/wishlist/sharewishlistbyemail",s,"WishListService.ShareWishListByEmail",e)),o},t.prototype.RemoveFromWishList=function(n){var i=this,r,t,u;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(t=this.$rootScope.Session.Customer.WishList.Products,u={wishListProductId:n},r=this.PostJson("/api/wishlist/remove",u).success(function(r){if(r){var u=_.find(t,function(t){return t.WishlistProductId==n});t=_.without(t,u);i.$rootScope.Session.Customer.WishList.Products=t;i.RefreshWishListDic();i.$rootScope.SafeApply()}}).error(function(){})),r},t.prototype.RemoveSelectedProductsFromWishList=function(n){var r=this,u,t,i;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(t=this.$rootScope.Session.Customer.WishList.Products,i=n,i=this.DeduplicateVariants(i,this.$rootScope.Session.Customer.WishList.Products),u=this.PostJson("/api/wishlist/removeselectedproducts",i).success(function(n){n&&(_.each(i,function(n){var i=_.find(t,function(t){return t.Variant.Sku===n.Sku});t=_.without(t,i)}),r.$rootScope.Session.Customer.WishList.Products=t,r.RefreshWishListDic(),r.$rootScope.SafeApply())}).error(function(){})),u},t.prototype.RemoveAllVariantsFromWishList=function(n){var t=this,i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={productId:n},i=this.PostJson("/api/wishlist/removeallvariants",r).success(function(i){i&&(t.removeAllVariants(n),t.$rootScope.SafeApply())}).error(function(){})),i},t.prototype.DeduplicateVariants=function(n,t){return _.filter(n,function(n){return!_.findWhere(t.map(function(n){return n.Variant}),n)})},t.prototype.removeAllVariants=function(n){for(var i=this.$rootScope.Session.Customer.WishList.Products,t=0;t<i.length;t++)i[t].Variant.ProductId==n&&(i.splice(t,1),t--);this.RefreshWishListDic()},t.prototype.CheckIfAnyVariantExistsInWishList=function(n){return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn?!!this.productDic[n]:!1},t.prototype.CheckIfAllVariantsExistInWishList=function(n){var t,u,i,r,f;if(this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn)if(u=this.$rootScope.Session.Customer.WishList,t=!0,u.Products){for(i=0,r=n;i<r.length;i++)if(f=r[i],!this.CheckIfExactVariantExistsInWishList(f)){t=!1;break}}else t=!1;else t=!1;return t},t.prototype.GetWishListProduct=function(n,t){if(this.$rootScope.Session&&this.$rootScope.Session.Customer.WishList){var i=this.$rootScope.Session.Customer.WishList;return _.find(i.Products,function(i){return i.Variant.ProductId==n&&i.Variant.Sku==t})}return null},t.prototype.CheckIfExactVariantExistsInWishList=function(n){var t=!1,i;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(i=this.GetWishListProduct(n.ProductId,n.Sku),i&&(t=!0)),t},t.prototype.RefreshWishListDic=function(){var n=this;this.productDic={};this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&_.each(this.$rootScope.Session.Customer.WishList.Products,function(t){n.productDic[t.Variant.ProductId]=t})},t.$inject=["$rootScope","$http","$q","sessionService"],t}(BaseAvonService);n.WishListService=t}(WishListServiceModule||(WishListServiceModule={}));app.service("wishListService",WishListServiceModule.WishListService),function(n){var t=function(t){function i(i,r,u,f,e,o,s,h){var c=this,l;t.call(this,i,u);this.$scope=i;this.wishListService=r;this.selectedProductsToShare=[];n.wishListScope=i;n.wishListScope.ErrorMessageText="";n.wishListScope.WishListSharedCustomerEntity=AVON.WishListSharedCustomerEntity;n.wishListScope.CustomerWishList=AVON.CustomerWishList;n.wishListScope.LanguageId=AVON.languageId;s.WhenReady().then(function(){n.wishListScope.WishList=AVON.SharedWishList?AVON.SharedWishList:AVON.CustomerWishList;n.wishListScope.WishList&&(n.wishListScope.ToggleSelectShareAll(),c.deselectInactiveVariants(n.wishListScope.WishList.Products),c.originalItems=angular.copy(n.wishListScope.WishList.Products))});n.wishListScope.starRange=_.range(5);n.wishListScope.AddToWishList=function(n){var t=[new WishListItem(n.Id,null,null,CanBuy.Available)];c.wishListService.AddToWishList(t)};n.wishListScope.GetProductSku=function(n){return!n.Variant.Sku&&n.Product.VariantGroups&&n.Product.VariantGroups.length===1&&n.Product.VariantGroups[0].Variants&&n.Product.VariantGroups[0].Variants.length===1?n.Product.VariantGroups[0].Variants[0].Sku:n.Variant.Sku};n.wishListScope.AddToBag=function(t,r){var u,f;t.$setSubmitted();t.$valid&&(u=new AddBagItem,u.Quantity=r.Quantity>0?r.Quantity:1,u.Id=r.Variant.ProductId.toString(),u.Sku=n.wishListScope.GetProductSku(r),u.AutoReplenishmentMultiBuy=r.Product.AutoReplenishmentMultibuy,u.AutoReplenishmentFrequency=r.Product.AutoReplenishmentFrequencyList&&r.Product.AutoReplenishmentFrequencyList.length===1&&r.Product.Availability===CanBuy.AutoReplenishmentOnly?r.Product.AutoReplenishmentFrequencyList[0]:r.Variant.AutoReplenishmentFrequency,i.ShowLoading(AVON.messages.spinner_adding),f=n.wishListScope.WishListSharedCustomerEntity?TrackingAddToCartType.WishListShared:TrackingAddToCartType.WishListPersonal,n.wishListScope.IsMobile?(AVON.product=r.Product,e.addItemToBag(u,!0,f)):e.addItemToBag(u,!1,f))};n.wishListScope.AddSubscriptionToBag=function(t,r){n.wishListScope.ErrorMessageText=n.wishListScope.GetErrorMessageText(r);i.AddToBag(t,r)};n.wishListScope.$on("BagService.AddToBagSuccess",function(t,i){for(var r,s,u,h,e=[],c=[],f=0,o=i.ItemsAdded;f<o.length;f++)r=o[f],s=_.find(n.wishListScope.WishList.Products,function(t){return t.Variant.ProductId.toString()==r.Id&&n.wishListScope.GetProductSku(t)==r.Sku}),e.push(s),c.push(r.Sku);u=angular.copy(e[0]);u.Quantity||(u.Quantity=1);h={AllowExit:!0,Model:u,KeepLoaded:!0};angular.element("#AddedToBagModal").trigger("modal",h)});n.wishListScope.RemoveFromWishList=function(t){var i=c.wishListService.RemoveFromWishList(t.WishlistProductId);i.success(function(i){if(i){n.wishListScope.WishList.Products=_.without(n.wishListScope.WishList.Products,t);var r=c.selectedProductsToShare.indexOf(t);r>-1&&c.selectedProductsToShare.splice(r,1)}})};n.wishListScope.GetErrorMessageText=function(n){return n.Product.AutoReplenishmentPrice>0&&(n.Product.Availability==CanBuy.AutoReplenishmentOnly||n.Product.Availability==CanBuy.Available)&&n.Variant.AutoReplenishmentFrequency==undefined?AVON.ErrorMessagesLocalized.Frequency:AVON.ErrorMessagesLocalized[n.Product.VariantType]};n.wishListScope.GetProductLink=function(t){return t&&t.IsActive?n.wishListScope.Url.Action("Details","Product")+"/"+t.Name.formatUrlNugget()+"-"+t.Id:""};n.wishListScope.GetVariantBySku=function(n,t){return c.getVariantBySku(n,t)};n.wishListScope.GetVariantSelectPlaceholderText=function(n,t,i,r){return(n?t:i)+" "+AVON.VariantTypesLocalized[r]};n.wishListScope.VariantChanged=function(t){n.wishListScope.ErrorMessageText=n.wishListScope.GetErrorMessageText(t);c.wishListService.UpdateProductVariantInWishList(t.WishlistProductId,t.Variant.Sku)};n.wishListScope.AutoReplenishmentFrequencyChanged=function(t){n.wishListScope.ErrorMessageText=n.wishListScope.GetErrorMessageText(t);c.wishListService.UpdateProductFrequencyInWishList(t.WishlistProductId,t.Variant.AutoReplenishmentFrequency)};n.wishListScope.UpdateComment=function(t,i){if(t.commentBox.$valid){n.wishListScope.ShowLoading(AVON.messages.spinner_saving);c.wishListService.UpdateProductCommentInWishList(i.WishlistProductId,i.Comment);var r=_.find(c.originalItems,function(n){return n.WishlistProductId==i.WishlistProductId});r&&(r.Comment=i.Comment);t.$setPristine()}};n.wishListScope.$on("WishListService.UpdateProductInWishList",function(){n.wishListScope.HideLoading()});n.wishListScope.CancelItem=function(n,t){var i=_.find(c.originalItems,function(n){return n.WishlistProductId==t.WishlistProductId});i&&(t.Comment=i.Comment);n.$setPristine()};n.wishListScope.CommentChanged=function(n){c.originalItems[n.WishlistProductId]||(c.originalItems[n.WishlistProductId]=angular.copy(n))};n.wishListScope.IsSelectedToShare=function(n){return c.selectedProductsToShare.indexOf(n)>-1};n.wishListScope.ToggleSelectionToShare=function(t){var i=c.selectedProductsToShare.indexOf(t);i>-1?c.selectedProductsToShare.splice(i,1):c.selectedProductsToShare.push(t);n.wishListScope.ShareAllSelected=!1};n.wishListScope.ToggleSelectShareAll=function(){c.selectedProductsToShare=n.wishListScope.ShareAllSelected?[]:_.filter(n.wishListScope.WishList.Products,function(t){var i=t;return n.wishListScope.IsAvailable(i)});n.wishListScope.ShareAllSelected=!n.wishListScope.ShareAllSelected};n.wishListScope.GetButtonToDisplay=function(t){return n.wishListScope.IsAvailableSoon(t)?WishListItemActionButton.NotifyMe:c.isAutoReplenishProduct(t)?WishListItemActionButton.AddSubscriptionToBag:t.Product.Availability===CanBuy.NoLongerAvailable||t.Product.Availability===CanBuy.NotForIndividualSale?WishListItemActionButton.Remove:WishListItemActionButton.AddToBag};n.wishListScope.IsAvailable=function(t){return!n.wishListScope.IsNoLongerAvailable(t)};n.wishListScope.IsNoLongerAvailable=function(n){return c.isNoLongerAvailable(n)};n.wishListScope.IsVariantAvailableSoon=function(n){return n.Availability==CanBuy.AvailableSoon};n.wishListScope.IsOptionDisabled=function(n){return n==null||n.Availability==CanBuy.Available||n.Availability==CanBuy.AvailableSoon||n.Availability==CanBuy.AutoReplenishmentOnly?!1:!0};n.wishListScope.ShareWishList=function(t){var i=[],r=[],u,f,e,s,l,o,a,v,y;if(c.selectedProductsToShare.length===0&&n.wishListScope.ToggleSelectShareAll(),c.selectedProductsToShare.length>0)for(u=0,f=c.selectedProductsToShare;u<f.length;u++)e=f[u],i.push(e.WishlistProductId),r.push(e.Variant.Sku);else _.each(n.wishListScope.WishList.Products,function(n){i.push(n.WishlistProductId);r.push(n.Variant.Sku)});t===WishListShareType.Email?(s={WishListProductIdsToShare:i,TrackingItems:r},l={AllowExit:!0,Model:s,KeepLoaded:!0,UrlToLoad:null},$("#EmailWishListModal").trigger("modal",l)):(n.wishListScope.ShowLoading(AVON.messages.spinner_saving),o=null,t!==WishListShareType.Email&&(a="menubar=no,toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes",v="AvonPop",o=window.open("",v,a)),c.wishListService.CreateSharedWishList(i,t,o),y={Type:TrackingEventType.WishListShared,Data:{trackingItems:r,shareMethod:c.GetShareTypeName(t)}},h.TrackEventItem(y))};n.wishListScope.$on("WishListService.CreateSharedWishList",function(t,i,r,u){if(n.wishListScope.HideLoading(),i.ErrorCode===AjaxError.None){if(i.Data){n.wishListScope.ShareWishListUrl=i.Data;var f=n.wishListScope.HomePageUrl+"socialmedia/sharewishlist?repId="+n.wishListScope.Session.Rep.Id+"&url="+encodeURIComponent(n.wishListScope.ShareWishListUrl)+"&platform=";switch(r){case WishListShareType.Facebook:u&&(u.location=f+"facebook",u.focus());break;case WishListShareType.Twitter:u&&(u.location=f+"twitter",u.focus())}}}else u.close()});n.wishListScope.CopyToClipboard=function(){n.wishListScope.SharedWishListUrlCopied=!0};n.wishListScope.$on("ModalClosed",function(){n.wishListScope.SharedWishListUrlCopied=!1;AVON.TempModalModel=null});n.wishListScope.IsAvailableSoon=function(n){var t=null;return(n.Variant.Sku&&(t=_.find(n.Product.VariantGroups[0].Variants,function(t){return t.Sku===n.Variant.Sku})),n.Product.Availability==CanBuy.AvailableSoon||t&&t.Availability==CanBuy.AvailableSoon)?!0:!1};n.wishListScope.NotifyMe=function(n){for(var f,i,r="",t=0,u=n.Product.VariantGroups;t<u.length;t++)if(f=u[t],i=_.find(f.Variants,function(t){return t.Sku==n.Variant.Sku}),i){r=i.Fsc;break}c.openNotifyMeModal(n.Variant.ProductId,r)};l=30;n.wishListScope.SortingCriteria="RecentlyAdded";n.wishListScope.NumberOfProductsShown=l;n.wishListScope.ShowMoreItems=function(){n.wishListScope.NumberOfProductsShown+=l};n.wishListScope.ShowSignIn=function(){n.wishListScope.IsMobile?n.wishListScope.RedirectToUrl(n.wishListScope.SignInPageUrl("wishlist")):n.wishListScope.ShowLoginModal("wishlist")};n.wishListScope.OrderByComparator=function(t){var i;switch(n.wishListScope.SortingCriteria){case"Name":i=t.Product.Name;break;case"Rating":i=t.Product.Rating?t.Product.Rating:0;break;case"RecentlyAdded":i=new Date(t.DateAdded);break;default:i=t.DateAdded}return i};n.wishListScope.ReverseSorting=function(){switch(n.wishListScope.SortingCriteria){case"Rating":case"RecentlyAdded":return!0;default:return!1}};n.wishListScope.SortWishlist=function(t){n.wishListScope.SortingCriteria=n.wishListScope.SortingCriteria=n.wishListScope.SetDefaultSortingOption?"RecentlyAdded":t;n.wishListScope.SetDefaultSortingOption=!1};n.wishListScope.SetDefaultSort=function(){n.wishListScope.SetDefaultSortingOption=!0};n.wishListScope.TempModalModel=function(){return AVON.TempModalModel};n.wishListScope.SocialShareService=o;n.wishListScope.IsVariantShade=function(n){return n===1?!0:!1};n.wishListScope.ShowPromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t,r,u;if(i.siblings("div").addClass("active"),t=i.siblings(".Overlay.active"),t.width(i.width()-(t.outerWidth(!0)-t.width())),r=$(".NavBar"),r.length>0){var e=r.offset().left+r.innerWidth(),o=t.offset().left+t.innerWidth(),f=o-e;f>0&&t.css({"margin-left":-f})}u=i.siblings(".RotatedCaret45.active");u.css({"margin-left":i.width()/2-u.width()/2})};n.wishListScope.HidePromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]);t.children(".active").removeClass("active")}}return __extends(i,t),i.prototype.openNotifyMeModal=function(t,i){var r=n.wishListScope.HomePageUrl+"product/notifymemodal?pfid="+t,u;i&&(r+="&fsc="+i);n.wishListScope.ShowLoading(AVON.messages.spinner_loading);u={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:r};$("#ContentModal").trigger("modal",u)},i.prototype.isAutoReplenishProduct=function(n){return n.Product.Availability===CanBuy.AutoReplenishmentOnly?!0:!1},i.prototype.GetShareTypeName=function(n){switch(n){case 1:return"facebook";case 2:return"twitter";default:return"email"}},i.prototype.isAnyVariantAvailable=function(n){var t=_.flatten(n.VariantGroups),i=_.flatten(_.pluck(t,"Variants")),r=_.find(i,function(n){return n.Availability===CanBuy.Available});return r?!0:!1},i.prototype.isNoLongerAvailable=function(n){return n&&(n.Product.Availability===CanBuy.NoLongerAvailable||n.Product.Availability===CanBuy.NotAvailableOnTheOnlineStore||!this.isAnyVariantAvailable(n.Product)||n.Variant.Availability===CanBuy.NoLongerAvailable)},i.prototype.isAvailable=function(n){return!this.isNoLongerAvailable(n)},i.prototype.getVariantBySku=function(n,t){for(var f,i=null,r=0,u=t.VariantGroups;r<u.length;r++)if(f=u[r],i=_.find(f.Variants,function(t){return t.Sku==n}),i)break;return i},i.prototype.deselectInactiveVariants=function(n){for(var i=0,u=n;i<u.length;i++){var t=u[i],r=this.getVariantBySku(t.Variant.Sku,t.Product),f=!r||r.Availability==CanBuy.NoLongerAvailable||r.Availability==CanBuy.NotAvailableOnTheOnlineStore;this.isAvailable(t)&&(!r||f&&this.isAnyVariantAvailable(t.Product))&&(t.Variant.Sku="")}},i.$inject=["$scope","wishListService","$window","$filter","bagService","socialShareService","sessionService","trackingService"],i}(BaseAngularController);n.WishListController=t}(WishListModule||(WishListModule={}));app.controller("WishListController",WishListModule.WishListController),function(n){var i=function(){function n(){}return n}(),t;n.WishListEmailShareModalModel=i;t=function(n){function t(t,i,r,u,f){var e=this;n.call(this,t,i);this.$scope=t;t.DescriptionMaxLength=500;u.WhenReady().then(function(){e.userAccountFirstAndLastName=t.Session.Customer.FirstName+" "+t.Session.Customer.LastName;t.FromName||(t.FromName=e.userAccountFirstAndLastName)});this.resetModal();t.SendEmailShare=function(n){if(t.emailShareForm.$setSubmitted(),t.emailShareForm.$valid){var i=AVON.TempModalModel.TrackingItems,u=AVON.TempModalModel.WishListProductIdsToShare,o=r.ShareWishListByEmail(e.$scope.Recipients,e.$scope.FromName,e.$scope.RecommendTo,e.$scope.Description,e.$scope.SendMeCopy,u,$("form[name=emailShareForm]")),s={Type:TrackingEventType.WishListShared,Data:{trackingItems:i,shareMethod:"email"}};f.TrackEventItem(s);t.ShowLoading(AVON.messages.spinner_loading);t.CloseModal(n);o.then(function(){t.HideLoading();angular.element("#WishListEmailSentConfirmationModal").trigger("modal",{AllowExit:!0,KeepLoaded:!0,UrlToLoad:null})})}};t.CloseModal=function(n){angular.element(n.currentTarget).closest("[modal]").trigger("close")};t.ContinueShopping=function(n){t.ShowLoading(AVON.messages.spinner_loading);t.CloseModal(n);t.RedirectToUrl(t.HomePageUrl)};t.$on("ModalClosed",function(){e.resetModal()})}return __extends(t,n),t.prototype.resetModal=function(){this.$scope.Recipients="";this.$scope.RecommendTo=WishListServiceModule.WishListMailingOption.MyFavourites;this.$scope.FromName=this.userAccountFirstAndLastName;this.$scope.Description="";this.$scope.SendMeCopy=!1;this.$scope.emailShareForm&&this.$scope.emailShareForm.$setPristine()},t.$inject=["$scope","$window","wishListService","sessionService","trackingService"],t}(BaseAngularController);n.WishListEmailShareController=t}(WishListEmailShareModule||(WishListEmailShareModule={}));app.controller("WishListEmailShareController",WishListEmailShareModule.WishListEmailShareController),function(n){var t=function(){function t(t){var i=this;this.$rootScope=t;this.link=function(t,r){var u=$(r),e,f;u.addClass("Accordion");e=u.find("li > a,li > button,li > span > a,li > span > button");e.on("click",i.OnElementClick);f=u.children(".DefaultSelected").first();f.length&&i.selectItem(f);t.$on(n.AccordionElementDirective.ClickEventName,function(n,t){i.selectItem(t)})};this.selectItem=function(n){var r={accordion:i,menuItem:n},t="";n.hasClass("MenuSelected")?(n.removeClass("MenuSelected"),n.children("ul,div").slideUp({duration:400}),n.find(".PostionClass").removeClass("PostionAbsolute"),t="Accordion.ItemClosed"):(n.siblings("li.MenuSelected").each(function(n,t){var i=$(t);i.removeClass("MenuSelected");i.children("ul,div").slideUp({duration:400});i.find(".PostionClass").removeClass("PostionAbsolute")}),n.children().length>1&&n.addClass("MenuSelected"),n.children("ul,div").slideDown({duration:400}),_.delay(function(){n.find(".PostionClass").addClass("PostionAbsolute")},400),t="Accordion.ItemSelected");i.$rootScope.$broadcast(t,r)};this.OnElementClick=function(n){var t=$(n.currentTarget).closest("li");t.hasClass("Disabled")===!1&&i.selectItem(t)};this.restrict="A";this.compile=null}return t.Factory=function(){var n=function(n){return new t(n)};return n.$inject=["$rootScope"],n},t}();n.AccordionDirective=t}(AccordionModule||(AccordionModule={}));app.directive("accordion",AccordionModule.AccordionDirective.Factory()),function(n){var t=function(){function n(t){this.$rootScope=t;this.link=function(t,i){var r=i.children("a, button");r.on("click",function(i){var r=$(i.currentTarget).closest("li");t.$emit(n.ClickEventName,r)})};this.restrict="A";this.compile=null}return n.Factory=function(){var t=function(t){return new n(t)};return t.$inject=["$rootScope"],t},n.ClickEventName="AccordionModule.AccordionElementClickEvent",n}();n.AccordionElementDirective=t}(AccordionModule||(AccordionModule={}));app.directive("accordionElement",AccordionModule.AccordionElementDirective.Factory()),function(n){var t=function(){function n(n,t,i){return{restrict:"A",link:function(n,t){_.defer(function(){angular.element(t).ellipsis();angular.element(t).html().indexOf("...")<0&&angular.element(t).parent().find(".ReadMoreLink").hide();angular.element(t).html().indexOf("...")>-1&&angular.element(t).html(angular.element(t).html().replace("...",""));i.$broadcast("EllipsisComplete")})}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.HtmlEllipsisDirective=t}(HtmlEllipsisModule||(HtmlEllipsisModule={}));app.directive("htmlEllipsis",["$sce","$timeout","$rootScope",HtmlEllipsisModule.HtmlEllipsisDirective]);app.directive("autofill",Autofill),function(n){var t=function(){function n(){this.restrict="A";this.link=function(n,t){$(t).focus();$("body").on("FocusReady",function(){$(t).focus()})}}return n.instance=function(){return function(){return new n}},n}();n.AutoFocusDirective=t}(AutoFocusModule||(AutoFocusModule={}));app.directive("autofocus",AutoFocusModule.AutoFocusDirective.instance()),function(n){var t=function(){function n(n,t,i){return{restrict:"A",priority:10,link:function(r,u){var f=$(u),s=r.innerForm?!0:!1,e=r,h,c,o,l;s&&(e=r.innerForm);u.prop("method","POST");f.attr("autocomplete")?f.attr("autocomplete")=="on"&&(this.watchAutoComplete=function(){$("input[ng-model],input[data-ng-model]",f).not("input[type=hidden],input[type=checkbox]").each(function(){if(angular.element(this).attr("type")!=="checkbox"){var n=$(this).val(),t=angular.element(this).controller("ngModel");t.$viewValue!=n&&t.$setViewValue(n)}});t(this.watchAutoComplete,350)},t(this.watchAutoComplete,100)):(f.attr("autocomplete","off"),f.find("input").attr("autocomplete","off"));u.on("submit",function(){$("input[ng-model]",f).each(function(){angular.element(this).attr("type")!=="checkbox"&&angular.element(this).controller("ngModel").$setViewValue($(this).val())})});f.attr("novalidate","novalidate");h=function(){e.ShowValidation=!1;e.ServerInvalid=!1;e.ServerErrors&&(e.ServerErrors=[]);s&&(e.innerForm.ShowValidation&&(e.innerForm.ShowValidation=!1),e.innerForm.ServerInvalid&&(e.innerForm.ServerInvalid=!1),e.innerForm.ServerErrors&&(e.innerForm.ServerErrors=[]));var n=u.inheritedData("$formController");angular.forEach(n,function(n,t){_.isUndefined(n)===!1&&_.isEmpty(n)===!1&&_.has(n,"$invalid")&&n.$invalid&&o[t].$setValidity("server",!0)});r.SafeApply();i.$broadcast("FormDirective.HidValidation",e)};f.on("focus","input,select,textarea",function(){$(this).is(":input[type=button], :input[type=submit], :input[type=reset]")||h()});f.on("click",".InputContainer_checkbox",function(){h()});f.on("change","select",function(){h()});f.on("keydown",function(n){var i=n.charCode||n.keyCode||0,t;i==13&&$(n.target).is("select")&&(t=f.find("input[type='submit']"),t.length&&(t.focus(),t.trigger("click")))});c=s?"innerForm.ShowValidation":"ShowValidation";r.$watch(c,function(n){if(n?(f.addClass("ShowValidation"),_.delay(function(){var n=$(".ValidationError:Visible").first();n.length&&n.scrollintoview({duration:400,direction:"both",complete:null,offsetY:-80})},50)):f.removeClass("ShowValidation"),f[0].getAttribute("name")!=="FacebookLoginForm"){var t=f.find(".ValidationType_required").length;r.RequiredInvalid=t>0}});o=u.inheritedData("$formController");o.ServerErrors={};o&&(l=s?"innerForm.ServerErrors":"ServerErrors",r.$watch(l,function(t){_.isUndefined(t)||t.length==0||(e.ServerInvalid=t.length>0,angular.forEach(t,function(t){var i=t.FieldName,r;i=i.replaceAll(".","_");r=t.Problem.trim();r&&(r=n.trustAsHtml(r),s?e.ServerErrors[i]={$invalid:!0,message:r,FieldName:null,Problem:null}:o.ServerErrors[i]={$invalid:!0,message:r},o[i]&&o[i].$setValidity("server",!1))}))}))}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.AvonFormDirective=t}(AvonFormModule||(AvonFormModule={}));app.directive("avonForm",["$sce","$timeout","$rootScope",AvonFormModule.AvonFormDirective]);onBagChangeQtyThrottled=_.throttle(function(n,t,i,r){var e=r.$dirty,o=r.$valid,u,f;e&&o&&(u=$.parseJSON(i.campaign),f=$.parseJSON(i.item),n.UpdateCart(u,f),n.SafeApply(),$(t).is(":focus")&&$(t).val().length>0&&$(t).blur())},1e3,{leading:!1});app.directive("bagQtyValid",BagQtyValidDirective);app.directive("bagQtyChange",BagQtyChangeDirective);app.directive("caretFix",CaretFix),function(n){var t=function(){function t(t,i,r,u,f){var e=this,o,s,h;this.$rootScope=t;this.$scope=i;this.$element=r;this.$compile=u;this.isCurrentlyScrolling=!1;i.container=$(r);i.isProductCarousel=!1;o=i.container.closest(".ProductCarousel");o.length&&(i.isProductCarousel=!0);this.scrollContents=i.container.find(".ScrollContents");i.wrapLeft=i.container.find(".WrapLeft");i.wrapRight=i.container.find(".WrapRight");i.currentIndex=0;i.clickEnabled=!0;i.slides=null;i.dragging=!1;i.hovered=!1;i.gutterSize=40;i.deltaXTimesVelocityXNextSlideThreshold=10;i.dragMultiply=+(i.container.attr("drag-multiply")||1.4);i.scrollableSlideOffsetPercent=i.container.attr("scrollable-slide-offset-percent")||0;i.singleSlideAdvance=i.container.attr("single-slide-advance")==="true";i.snapEnabled=i.container.attr("snap")!=="false";i.autoAdvanceSeconds=+(i.container.attr("auto-advance-seconds")||0);i.slidesVisibleRequested=+(i.container.attr("slides-visible")||1);i.slidesVisibleTabletRequested=+(i.container.attr("slides-visible-tablet")||i.slidesVisibleRequested);i.slidesVisibleMobileRequested=+(i.container.attr("slides-visible-mobile")||i.slidesVisibleRequested);i.minSlideWidth=+(i.container.attr("min-slide-width")||0);i.wrapRequested=(i.container.attr("wrap")||"true")=="true";i.wrap=!1;i.imagesSlideLoaded=0;i.IsPanEnabled=f.panEnabled=="false"?!1:!0;i.container.on("update",function(){i.update()});this.scrollContents.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.onSlideTransitionEnd()});i.mouseEnter=function(){i.hovered=!0;e.stopAutoAdvanceTimer(!1)};i.mouseLeave=function(){i.hovered=!1;i.resetAutoAdvanceTimer()};i.onClick=function(){e.stopAutoAdvanceTimer(!0)};i.SafeApply=function(n){var r=t.$$phase;r=="$apply"||r=="$digest"?n&&typeof n=="function"&&n():i.$apply(n)};$(window).scroll(function(){e.scrollingDetectionTimerId&&clearTimeout(e.scrollingDetectionTimerId);e.isCurrentlyScrolling=!0;e.scrollingDetectionTimerId=_.delay(function(){e.isCurrentlyScrolling=!1},150)});i.scrollTo=function(n,t,i){e.scrollTo(n,t,i)};i.showSlide=function(n,t,i){e.showSlide(n,t,i)};i.$on(n.CarouselDirective.ShowSlideBroadcastName,function(n,t,i){e.showSlide(t,i)});i.$on("Carousel_ShowNext",function(n,t){e.scrollContents.context.id===t&&i.showNext()});i.$on("Carousel_ShowPrevious",function(n,t){e.scrollContents.context.id===t&&i.showPrevious()});i.$on("Carousel_Update",function(){i.update()});i.slideLoaded=function(){i.imagesSlideLoaded++};i.showNext=function(){var n=e.getNumberOfSlidesToAdvanceBy(),t=e.GetSnapIndex(),r=i.currentIndex+n,u=Math.min(Math.max(t,r),i.maxIndex+i.wrapSlideCount);e.showSlide(u,!0)};i.showPrevious=function(){var n=e.getNumberOfSlidesToAdvanceBy(),t=e.GetSnapIndex(),r=i.currentIndex-n,u=Math.max(Math.min(t,r),-i.wrapSlideCount);e.showSlide(u,!0)};i.PreviousButtonActive=function(){var n=e.$scope.isProductCarousel&&e.$scope.imagesSlideLoaded>5;return n||i.currentIndex>0||e.$scope.wrap};i.NextButtonActive=function(){var n=e.$scope.isProductCarousel&&e.$scope.imagesSlideLoaded>5;return n||i.currentIndex<e.$scope.maxIndex||e.$scope.wrap};i.updateCarouselSlides=function(){var n=i.scrollX;n<-(i.maxIndex+i.wrapSlideCount)*i.slideWidth?(n=n+i.slideCount*i.slideWidth,e.scrollContents.css("margin-left",n+"px")):n>=i.gutterSize&&(n=n-i.slideCount*i.slideWidth,e.scrollContents.css("margin-left",n+"px"));i.scrollX=n;i.SafeApply();t.$broadcast("Carousel_SlideShown",i)};i.clickEnable=function(n){n?_.delay(function(){i.clickEnabled=!0;i.container.addClass("ClickEnabled")},500):(i.clickEnabled=!1,i.container.removeClass("ClickEnabled"))};i.hammerHandler=function(n){if(n.isFinal)i.dragging&&(i.dragging=!1,i.clickEnable(!0),i.snapEnabled?e.snapNearestSlide(n.deltaX,n.velocityX):i.updateCarouselSlides());else if(!e.isCurrentlyScrolling&&n.direction&Hammer.DIRECTION_HORIZONTAL)switch(n.type){case"panright":case"panleft":e.wireDragging(i,!0);i.scrollTo(i.dragStartX+n.deltaX*i.dragMultiply,!1,!0);break;case"panup":case"pandown":e.wireDragging(i,!1);$(document).scrollTop(i.dragStartY-n.deltaY);break;case"swipeleft":e.wireSwipe(i,!0);break;case"swiperight":e.wireSwipe(i,!1)}else n.preventDefault()};i.throttledHammerHandler=_.throttle(i.hammerHandler,10);i.resetAutoAdvanceTimer=function(){e.stopAutoAdvanceTimer(!1);i.autoAdvanceSeconds>0&&(i.autoAdvanceTimer=setInterval(function(){var n=$("body");!n.hasClass("ModalVisible")&&!BaseAvonService.rootScope.isLoading&&i.autoAdvanceSeconds>0&&i.dragging!==!0&&!t.Redirecting&&(i.currentIndex<i.maxIndex||i.wrap?i.showNext():e.showSlide(0,!0))},i.autoAdvanceSeconds*1e3))};s=_.debounce(function(){e.stopAutoAdvanceTimer(!0);i.showPrevious()},250,!0);i.previousClicked=function(){s()};h=_.debounce(function(){e.stopAutoAdvanceTimer(!0);i.showNext()},250,!0);i.nextClicked=function(){h()};i.resetAutoAdvanceTimer();i.container.addClass("ClickEnabled");i.slideRange=function(){return i.slidesVisible&&i.slideCount?i.singleSlideAdvance?_.range(0,i.slideCount):_.range(0,Math.ceil(i.slideCount/i.slidesVisible)):[]};i.isPageActive=function(n){var t=(i.currentIndex+i.slideCount)%i.slideCount;return i.singleSlideAdvance?n==t:n==t/i.slidesVisible};this.update=_.debounce(function(){var n,r,u;if(i.slides=i.container.find(".Slides .Slide"),i.slideCount=i.slides.length,i.imagesSlideLoaded==i.slideCount&&(i.imagesSlideLoaded=0,t.$broadcast("Carousel_ImagesLoaded",i)),e.scrollContents.hide(),i.container.css({visibility:"visible"}),i.carouselWidth=i.container.find(".ScrollClip").width(),!i.container.is(":Visible")||i.carouselWidth===0){_.delay(function(){e.update()},100);return}for(i.slidesVisible=i.slidesVisibleRequested,i.slideWidth=i.carouselWidth/i.slidesVisible;i.slideWidth<i.minSlideWidth&&i.slidesVisible>1;)i.slidesVisible--,i.slideWidth=i.carouselWidth/i.slidesVisible;if(i.slidesVisible>i.slideCount&&(i.slidesVisible=i.slideCount,i.slideWidth=i.carouselWidth/i.slidesVisible),i.maxIndex=i.slideCount-i.slidesVisible,i.container.toggleClass("CanScroll",i.isProductCarousel||i.slideCount>i.slidesVisible),i.slides.width(i.slideWidth),i.wrapLeft.html(""),i.wrapRight.html(""),i.wrapSlideCount=0,i.wrap=i.wrapRequested&&i.slideCount>i.slidesVisible,i.wrap){for(i.wrapSlideCount=i.slidesVisible+2,n=0;n<i.wrapSlideCount;n++)r=i.slides.eq(i.slideCount-i.wrapSlideCount+n).html(),e.copySlideContents(r,!1),u=i.slides.eq(n).html(),e.copySlideContents(u,!0);i.wrapLeft.find(".Slide").width(i.slideWidth);i.wrapRight.find(".Slide").width(i.slideWidth)}e.scrollContents.width(i.slideWidth*(i.slideCount+i.wrapSlideCount*2)+2);e.scrollContents.show();e.showSlide(i.currentIndex,!1);i.SafeApply();t.$broadcast("Carousel_Updated",i);i.container.addClass("Ready")},250,!1);i.update=this.update;_.delay(function(){i.isProductCarousel&&i.container.addClass("CanScroll")},100);$(window).resize(this.update)}return t.prototype.wireSwipe=function(n,t){this.$scope.IsPanEnabled&&(this.stopAutoAdvanceTimer(!0),n.clickEnable(!1),t?n.showNext():n.showPrevious(),n.clickEnable(!0))},t.prototype.wireDragging=function(n,t){n.dragging!==!0&&(n.dragging=!0,n.dragStartX=n.scrollX,n.dragStartY=$(document).scrollTop(),n.clickEnable(!1),t&&this.stopAutoAdvanceTimer(t))},t.prototype.stopAutoAdvanceTimer=function(n){this.$scope.autoAdvanceTimer&&clearInterval(this.$scope.autoAdvanceTimer);n&&(this.$scope.autoAdvanceSeconds=0)},t.prototype.GetSnapIndex=function(){var n=this.$scope.scrollableSlideOffsetPercent/100*this.$scope.slideWidth;return Math.round((n-this.$scope.scrollX)/this.$scope.slideWidth)-this.$scope.wrapSlideCount},t.prototype.snapNearestSlide=function(n,t){var i,r=Math.abs(n)*t,u;Math.abs(r)>this.$scope.deltaXTimesVelocityXNextSlideThreshold?(u=this.getNumberOfSlidesToAdvanceBy(),i=this.$scope.currentIndex+u*this.getMathSign(r)):i=this.GetSnapIndex();this.showSlide(i,!0)},t.prototype.getMathSign=function(n){return n&&n/Math.abs(n)},t.prototype.BrochureShowChosenSlideAndSurroundingSlides=function(n){var t;if(this.$scope.container.closest("div#brochure").length&&(t=$("#brochureimage-"+n),t.length>0)){t.attr("src",t.attr("data-page-image"));var i=$("#brochureimage-"+(n+2)),r=$("#brochureimage-"+(n+1)),u=$("#brochureimage-"+(n-1)),f=$("#brochureimage-"+(n-2));i.length>0&&i.attr("src").indexOf("pages-loading.gif")>0&&i.attr("src",i.attr("data-page-image"));r.length>0&&r.attr("src").indexOf("pages-loading.gif")>0&&r.attr("src",r.attr("data-page-image"));u.length>0&&u.attr("src").indexOf("pages-loading.gif")>0&&u.attr("src",u.attr("data-page-image"));f.length>0&&f.attr("src").indexOf("pages-loading.gif")>0&&f.attr("src",f.attr("data-page-image"))}},t.prototype.showSlide=function(n,t,i){i===void 0&&(i=!1);i&&this.stopAutoAdvanceTimer(!0);this.BrochureShowChosenSlideAndSurroundingSlides(n);n=Math.max(Math.min(n,this.$scope.maxIndex+this.$scope.wrapSlideCount),-this.$scope.wrapSlideCount);this.$scope.slideCount>this.$scope.slidesVisible*2&&(this.$scope.currentIndex===0&&n===this.$scope.maxIndex||this.$scope.currentIndex===this.$scope.maxIndex&&n===0)&&(t=!1);this.$scope.currentIndex=n;var r=(this.$scope.scrollableSlideOffsetPercent/100-this.$scope.currentIndex-this.$scope.wrapSlideCount)*this.$scope.slideWidth;this.$scope.scrollTo(r,t,!1);this.$scope.SafeApply();this.$rootScope.$broadcast("Carousel_SlideShown",this.$scope)},t.prototype.copySlideContents=function(n,t){var i=$("<div class='Slide'>"+n+"<\/div>");i.find(".ng-scope").removeClass("ng-scope");this.$compile(i.find(".ProductSummaryName"))(this.$scope);this.$compile(i.find(".ProductItemImage"))(this.$scope);this.$compile(i.find(".OverlayContainer"))(this.$scope);t?this.$scope.wrapRight.append(i):this.$scope.wrapLeft.append(i)},t.prototype.scrollTo=function(n,t,i){var r=this.$scope.gutterSize,u,f;this.$scope.slideCount<=this.$scope.slidesVisible&&(r=0);(this.$scope.snapEnabled||i)&&(u=-this.scrollContents.width()+2+this.$scope.slideWidth*this.$scope.slidesVisible-r,f=r,n=Math.min(Math.max(n,u),f));this.scrollContents.toggleClass("Animate",t);this.scrollContents.css("margin-left",n+"px");this.$scope.scrollX=n},t.prototype.onSlideTransitionEnd=function(){if(this.$scope.snapEnabled){if(this.$scope.currentIndex<0&&this.$scope.currentIndex+this.$scope.slideCount<=this.$scope.maxIndex||this.$scope.currentIndex>this.$scope.maxIndex){var n=(this.$scope.currentIndex+this.$scope.slideCount)%this.$scope.slideCount;this.showSlide(n,!1)}}else this.$scope.updateCarouselSlides()},t.prototype.getNumberOfSlidesToAdvanceBy=function(){return this.$scope.singleSlideAdvance?1:this.$scope.slidesVisible},t.$inject=["$rootScope","$scope","$element","$compile","$attrs"],t}();n.CarouselDirectiveController=t}(CarouselModule||(CarouselModule={})),function(n){var t=function(){function n(n){return{restrict:"EAC",priority:20,link:function(t,i,r){var u=$(i),f=u.attr("data-ng-click")||u.attr("ng-click");f;u.on("click",function(){var i,f,e;t.ServerErrors=[];t.ServerInvalid&&(t.ServerInvalid=!1);t.innerForm&&(t.innerForm.ShowValidation=!1,t.innerForm.ServerErrors=[],t.innerForm.ServerInvalid&&(t.innerForm.ServerInvalid=!1));i=r.clearServerValidation;i||(f=u.closest("form"),f.length&&(i=f.attr("name")));i&&t[i].$setDirty();e=u.attr("clear-server-validation-click");e&&n(function(){n(function(){t.$eval(e)},10)},10)})}}}return n.$inject=["$timeout"],n}();n.clearServerValidation=t}(clearServerValidationModule||(clearServerValidationModule={}));app.directive("clearServerValidation",["$timeout",clearServerValidationModule.clearServerValidation]);app.directive("compile",["$compile",CompileDirective]);app.directive("confirmField",ConfirmFieldDirective),function(n){var t=function(){function n(){var n=this;this.imageLoaded=!1;this.imageZoomOptions={zoomActivation:"hover",zoomEnabled:!0,preloading:1,zoomLevel:2,scrollZoom:!1,scrollZoomIncrement:.1,minZoomLevel:!1,maxZoomLevel:!1,easing:!1,easingAmount:12,lensSize:200,zoomWindowWidth:400,zoomWindowHeight:400,zoomWindowOffetx:0,zoomWindowOffety:0,zoomWindowPosition:1,zoomWindowBgColour:"#fff",lensFadeIn:!1,lensFadeOut:!1,debug:!1,zoomWindowFadeIn:!1,zoomWindowFadeOut:!1,zoomWindowAlwaysShow:!1,zoomTintFadeIn:!1,zoomTintFadeOut:!1,borderSize:2,showLens:!0,borderColour:"#888",lensBorderSize:1,lensBorderColour:"#000",lensShape:"round",zoomType:"lens",containLensZoom:!1,lensColour:"white",lensOpacity:.4,lenszoom:!1,tint:!1,tintColour:"#333",tintOpacity:.4,gallery:!1,galleryActiveClass:"zoomGalleryActive",imageCrossfade:!1,constrainType:!1,constrainSize:!1,loadingIcon:!1,cursor:"default",responsive:!0,onComplete:$.noop,onZoomedImageLoaded:function(){},onImageSwap:$.noop,onImageSwapComplete:$.noop};this.require="";this.restrict="A";this.scope={ZoomEnabled:"=elevateZoomEnabled",ZoomContainerSameParent:"=elevateZoomContainerSameParent"};this.link=function(t,i,r){t.ZoomContainerSameParent||(t.ZoomContainerSameParent=!1);r.$observe("zoomImage",function(r){i.data("zoom-image",r);n.RemoveZoomContainer(i);t.ZoomEnabled&&n.CreateZoomContainer(i,t.ZoomContainerSameParent)});t.$watch(function(){return{Width:i.width(),Height:i.height()}},function(t,r,u){t.Width==0||t.Height==0?n.RemoveZoomContainer(i):n.ReloadZoom(u,i,u.ZoomContainerSameParent)},!0);t.$watch("ZoomEnabled",function(t,r,u){t?n.CreateZoomContainer(i,u.ZoomContainerSameParent):n.RemoveZoomContainer(i)});t.$on("$destroy",function(){n.RemoveZoomContainer(i)});i.on("$destroy",function(){t.$destroy()});i.bind("load",function(){n.ReloadZoom(t,i,t.ZoomContainerSameParent)})}}return n.Factory=function(){return function(t){return new n(t)}},n.prototype.CreateZoomContainer=function(n,t){n.data("elevateZoom")||(this.imageZoomOptions.sameParentElement=t,n.elevateZoom(this.imageZoomOptions))},n.prototype.RemoveZoomContainer=function(n){var t=n.data("elevateZoom");t&&t.zoomContainer&&(t.zoomContainer.remove(),n.data("elevateZoom",null))},n.prototype.ReloadZoom=function(n,t,i){t.data("elevateZoom")&&(this.RemoveZoomContainer(t),n.ZoomEnabled&&this.CreateZoomContainer(t,i))},n.prototype.GetParentZoomContainer=function(){var t=null,n;return this.scope.ZoomParentContainerSelector&&(n=$(this.scope.ZoomParentContainerSelector),n.length>0&&(t=n)),t},n}();n.ElevateZoomDirective=t}(ElevateZoomModule||(ElevateZoomModule={}));app.directive("elevateZoomEnabled",["$rootScope",ElevateZoomModule.ElevateZoomDirective.Factory()]);app.directive("ngEnter",function(){return function(n,t,i){t.bind("keydown keypress",function(t){t.which===13&&(n.SafeApply(function(){n.$eval(i.ngEnter)}),t.preventDefault())})}});app.directive("expandable",ExpandableDirective);app.directive("fallbackSrc",["$rootScope",FallbackSrcDirective]);app.directive("focusMe",["$timeout",FocusMe]),function(n){var t=function(){function n(){return{restrict:"A",scope:!1,link:function(n,t,i){var r,o,u,f,e,s,h,c;(r=$(t),r.closest(".DisableImageAspect").length)||(s=i.imageaspect,s!=""&&s!="0")&&(r.is("img")?(o=r,r.wrap("<div class='ImageAspect' />"),r=r.parent()):(r.addClass("ImageAspect"),o=r.find("image").first()),h=r.css("position"),h!="absolute"&&h!="fixed"&&h!="relative"&&r.css("position","relative"),c=s.split("/"),c.length==2?(u=c[0],f=c[1],e=u/f,r.data("width",u),r.data("height",f)):e=parseFloat(s),r.data("aspect",e),r.css("padding-bottom",100/e+"%"),r.waitForImages(function(){r=$(this);o=r.find("img");u=o[0].naturalWidth;f=o[0].naturalHeight;var n=r.data("width"),t=r.data("height");u!=0&&f!=0&&(u!=n||f!=t)&&(e=u/f,e!=r.data("aspect")&&r.css("padding-bottom",100/e+"%"))}))}}}return n.$inject=[],n}();n.ImageAspect=t}(ImageAspectModule||(ImageAspectModule={}));app.directive("imageaspect",[ImageAspectModule.ImageAspect]);app.directive("imgDelaySrc",[ImgDelaySrcDirective]);app.directive("includerepid",["$rootScope",IncludeRepIdDirective]);app.directive("input",input);app.directive("inputMaxlength",inputMaxlength);app.directive("input",inputWaterMark);app.directive("linenumberField",linenumberField),function(n){var t=function(){function n(t,i,r){var u=this;this.$rootScope=t;this.$compile=i;this.modalService=r;this.restrict="EAC";this.compile=function(){return{pre:function(n,t){var i=t.wrap('<div class="ModalContainer"><\/div>')},post:function(i,f){var o=$(f),e=o.closest(".ModalContainer"),l=$("#ModalBackground"),h=!0,c=!1,s;i.CloseModal=function(){r.CloseModal()};s=!1;o.on("modal",function(r,f){if(e.hasClass("Shown")){i.HideLoading();return}var a=o.attr("modal"),l;l=a?i.$eval(a):{};f&&f.UrlToLoad&&(l.UrlToLoad=f.UrlToLoad);u.SetModalModel(i,f);f&&f.UseIFrame&&(l.UseIFrame=f.UseIFrame,l.IFrameWidth=f.IFrameWidth,l.IFrameHeight=f.IFrameHeight);l.KeepLoaded!==undefined&&(c=l.KeepLoaded);l.AllowExit!==undefined&&(h=l.AllowExit);l.IgnoreBackground!==undefined&&(s=l.IgnoreBackground);f&&f.CssClass&&(l.CssClass=f.CssClass);f&&(h=f.AllowExit,c=f.KeepLoaded,s=f.IgnoreBackground);l&&l.UrlToLoad&&!o.data("isLoaded")?u.LoadModalFromUrl(i,o,l,c):o.trigger("loaded");$(window).resize(function(){_.delay(function(){u.centerElement(e)},50)});o.on("close",function(r,s){var h=e.context.id;e.hasClass("Shown")&&(c||s||e.children().html(""),$("#select2-drop-mask").click(),e.removeClass("Shown"),$("body").removeClass("ModalVisible"),o.data("isLoaded",!1),$("#ModalBackground").addClass("Shown"),$("#ModalBackground").removeAttr("style"),t.$broadcast(n.ModalClosedBroadcastName,h,i.ModalModel),t.$broadcast("Do.ResetPageIdleTime"),u.UnsetModalModel(i,f),i.SafeApply())})});o.on("loaded",function(){var r=e.context.id;e.find(".hideUntilCentered").length>0&&e.hide();i.HideLoading();u.createCloseButton(o,f,e,l,h);u.bindCloseButton(o);_.defer(function(){u.centerElement(e)});_.delay(function(){u.centerElement(e);e.addClass("Shown");$("body").addClass("ModalVisible")},100);e.waitForImages(function(){u.centerElement(e)});t.$broadcast(n.ModalShownBroadcastName,r,i.ModalModel)});e.on("click",function(n){s===!1&&h&&$(n.target).attr("class")==="ModalContainer Shown"&&(o.trigger("close"),n.stopPropagation())});l.on("click",function(n){s===!1&&o.parent().hasClass("Shown")&&($("#ModalIFrameContainer").remove(),o.trigger("close"),n.stopPropagation(),u.clearFindARepModalFormValues())})}}}}return n.Factory=function(){return function(t,i,r){return new n(t,i,r)}},n.prototype.LoadModalFromUrl=function(n,t,i,r){var u=this;t.addClass(i.CssClass);i.UseIFrame?(t.data("isLoaded",!1),$('<iframe id="ModalIFrameContainer" src="'+i.UrlToLoad+'" style="width: '+i.IFrameWidth+"; height: "+i.IFrameHeight+';" width="'+i.IFrameWidth+'" height="'+i.IFrameHeight+'" allowfullscreen />').appendTo(t),t.trigger("loaded")):(r&&t.data("isLoaded",!0),i.UrlToLoad?this.modalService.GetHtml(i.UrlToLoad).then(function(i){t.html(i);u.$compile(t.contents())(n);t.trigger("loaded")}):t.trigger("loaded"))},n.prototype.SetModalModel=function(n,t){if(t&&t.Model)if(AVON.TempModalModel=t.Model,t.ExtractModelToScope)for(var i in t.Model)n[i]=t.Model[i];else n.ModalModel=t.Model},n.prototype.UnsetModalModel=function(n,t){if(t&&t.Model)if(delete AVON.TempModalModel,t.ExtractModelToScope)for(var i in t.Model)delete n[i];else delete n.ModalModel},n.prototype.bindCloseButton=function(n){var i=this,t=$(".Close",n);t&&t.click(function(t){n.parent().hasClass("Shown")&&($("#ModalIFrameContainer").remove(),$("#select2-drop-mask").click(),n.trigger("close"),t.stopPropagation(),i.clearFindARepModalFormValues())})},n.prototype.createCloseButton=function(n,t,i,r,u){t.hasClass("Close")||(u?(i.find(".ModalCloseIcon").length==0&&i.children().prepend('<div class="ModalCloseIcon Close"><\/div>'),i.find(".Close").show(),this.bindCloseButton(n)):(i.find(".Close").hide(),r.off("click")))},n.prototype.clearFindARepModalFormValues=function(){$("#FindARepModal").length&&this.$rootScope.$broadcast("FindARepModalClosed")},n.prototype.centerElement=function(n){var o=$(document).height(),r=$(window).height(),u=n.height(),i=$(window).scrollTop(),f=i,e=o-u,t=i+r*.1;u>r&&(t=i+5);t<f?t=f:t>e&&(t=e);t<0&&(t=0);n.css("top",t+"px");n.find(".hideUntilCentered").length>0&&n.show()},n.ModalShownBroadcastName="ModalShown",n.ModalClosedBroadcastName="ModalClosed",n}();n.ModalDirective=t;app.directive("modal",["$rootScope","$compile","modalService",n.ModalDirective.Factory()]);$(document).ready(function(){var n=app.GetQuerystringParameterByName("overlay");n.length>0&&(n=="ForgottenPassword"?($("#LoginModal").trigger("modal"),_.delay(function(){$("#ForgotPasswordButton").click()},3e3)):AvonModule.AvonScope.SessionService.WhenReady().then(function(){if(n==="LoginModal"&&AvonModule.AvonScope.Session.Customer.IsLoggedIn){var t=app.GetQuerystringParameterByName("ReturnUrl");t&&(window.location.href=t);return}$("#"+n).trigger("modal")}))})}(ModalDirectiveModule||(ModalDirectiveModule={}));app.directive("numericField",numericField),function(n){var t=function(){function n(){this.restrict="A";this.scope={callback:"&ngOnload"};this.link=function(n,t){var i=t[0];if(i.complete&&i.naturalWidth>0)n.callback({event:event});else t.on("load",function(t){n.$apply(function(){n.callback({event:t})})})}}return n.Factory=function(){return function(t){return new n(t)}},n}();n.OnLoadDirective=t}(OnLoadDirectiveModule||(OnLoadDirectiveModule={}));app.directive("ngOnload",["$rootScope",OnLoadDirectiveModule.OnLoadDirective.Factory()]);app.directive("phoneNumber",["$filter","$browser",phoneNumber]);app.directive("phonenumberField",phonenumberField),function(n){var t=function(){function n(n,t,i){var r=this;this.$interval=i;this.require="";this.restrict="A";this.scope={ZoomEnabled:"=?pinchZoomCanvasEnabled",ImagePath:"=pinchZoomCanvasImagePath",EmptyImagePath:"=?emptyImagePath"};this.link=function(n,u,f){n.ZoomEnabled==undefined&&(n.ZoomEnabled=!0);n.EmptyImagePath==undefined&&(n.EmptyImagePath="/images/Responsive/Product/PhotoNotAvailable.png");f.$observe("zoomImage",function(t){u.data("zoom-image",t);n.ZoomEnabled?r.createZoomCanvas(n,u,n.ImagePath):r.removeZoomCanvas(n)});n.$watch(function(){return{Width:u.width(),Height:u.height()}},function(n,t,i){r.removeZoomCanvas(i);n.Width>0&&n.Height>0&&r.createZoomCanvas(i,u,i.ImagePath)},!0);n.$watch("ZoomEnabled",function(n,t,f){n!=t&&(f.CustomOffsetListener&&(i.cancel(f.CustomOffsetListener),f.CustomOffsetListener=null),n&&(r.createZoomCanvas(f,u,f.ImagePath),r.calculateOffset(f),f.CustomOffsetListener=r.createCustomOffsetListener(f,u)))});n.$on("$destroy",function(){r.removeZoomCanvas(n)});u.on("$destroy",function(){n.$destroy()});angular.element(t).bind("scroll",function(){r.calculateOffset(n)})}}return n.Factory=function(){return function(t,i,r){return new n(t,i,r)}},n.prototype.createCustomOffsetListener=function(n,t){var r=this,i;return this.$interval(function(){var u=t.offset();i&&u.top==i.top&&u.left==i.left||(i=u,r.calculateOffset(n))},200,10,!1)},n.prototype.calculateOffset=function(n){n.PinchZoomCanvas&&n.PinchZoomCanvas.calculateOffset()},n.prototype.removeZoomCanvas=function(n){n.PinchZoomCanvas&&(n.PinchZoomCanvas.destroy(),n.PinchZoomCanvas=null)},n.prototype.createZoomCanvas=function(n,t,i){n.PinchZoomCanvas=new PinchZoomCanvas({canvas:t[0],path:i,momentum:!0,zoomMax:2,doubletap:!0,onZoomEnd:function(){},onZoom:function(){},emptyImage:n.EmptyImagePath});n.PinchZoomCanvas.calculateOffset()},n}();n.PinchZoomCanvasDirective=t}(PinchZoomCanvasModule||(PinchZoomCanvasModule={}));app.directive("pinchZoomCanvas",["$rootScope","$window","$interval",PinchZoomCanvasModule.PinchZoomCanvasDirective.Factory()]);app.directive("preventdefault",preventDefault),function(n){var t=function(){function n(n,t,i,r){var u=this;t.Cdn=r;t.ThumbnailSlideClick=function(n){u.productImagesLargeCarouselScope.showSlide(n,!0);t.ImageToZoomIndex=n};t.SetProductImagesLargeCarouselScope=function(n){u.productImagesLargeCarouselScope=n;u.productImagesLargeCarouselScope.$watch("currentIndex",function(n){t.ImageToZoomIndex=n})};t.SetProductImagesThumbnailsCarouselScope=function(n){u.productImagesThumbnailsCarouselScope=n};t.IsImageZoomEnabled=function(n){return t.ZoomEnabled&&t.ImageToZoomIndex==n}}return n.$inject=["$rootScope","$scope","$element","cdnService"],n}();n.ProductImagesCarouselController=t}(ProductImagesCarouselModule||(ProductImagesCarouselModule={})),function(n){var t=function(){function t(){this.require="ng-model";this.restrict="EA";this.scope={Product:"=ngModel",ZoomEnabled:"=productImagesZoomEnabled",ClickEnabled:"=productImagesClickEnabled"};this.controller=n.ProductImagesCarouselController;this.link=function(n,t,i){n.RollOverToZoomText=i.productImagesRollOverToZoomText};this.templateUrl="/Scripts/Common/Core/Directives/ProductImagesCarousel/ProductImagesCarouselTemplate.html"}return t.Factory=function(){return function(n){return new t(n)}},t}();n.ProductImagesCarouselDirective=t}(ProductImagesCarouselModule||(ProductImagesCarouselModule={}));app.directive("productImagesCarousel",["$rootScope",ProductImagesCarouselModule.ProductImagesCarouselDirective.Factory()]);app.directive("secondaryImage",["$rootScope",SecondaryImageDirective]);app.directive("selectRegularExpressionValidator",SelectRegularExpressionValidator);app.directive("singleexpandable",SingleExpandableDirective),function(n){var r=function(){function n(){this.restrict="E";this.link=function(n,t){t.attr("gridheight")&&(t.css("height",t.attr("gridheight")+"px"),t.attr("rowcount")&&t.attr("colcount")&&(isNaN(t.attr("gridheight"))||isNaN(t.attr("rowcount"))||isNaN(t.attr("colcount"))||t.css("width",parseInt(t.attr("gridheight"))/parseInt(t.attr("rowcount"))*parseInt(t.attr("colcount"))+"px")))}}return n.instance=function(){return function(){return new n}},n}(),t,i;n.StackGridDirective=r;t=function(){function n(n,t){this.$scope=n;this.$element=t;var r=function(n,t,i){return Math.abs(n*parseInt(t.attr(i)))},u=function(n,t){return 100/parseInt(n.attr(t))},i=$(t),f=i.parent("stackgrid"),e=u(f,"rowcount"),o=u(f,"colcount");n.cellTop=r(e,i,"row");n.cellLeft=r(o,i,"col");n.cellHeight=r(e,i,"rowspan");n.cellWidth=r(o,i,"colspan")}return n.$inject=["$scope","$element"],n}();n.StackCellController=t;i=function(){function t(){this.scope={};this.template='<div class="StackCell" ng-attr-style="height:{{cellHeight}}%; width:{{cellWidth}}%; top:{{cellTop}}%; left:{{cellLeft}}%;" ng-transclude><\/div>';this.restrict="E";this.require="^stackgrid";this.replace=!0;this.transclude=!0;this.controller=n.StackCellController}return t.instance=function(){return function(){return new t}},t}();n.StackCellDirective=i}(StackGridModule||(StackGridModule={}));app.directive("stackgrid",StackGridModule.StackGridDirective.instance());app.directive("stackcell",StackGridModule.StackCellDirective.instance());app.directive("textarea",textareaWaterMark),function(n){var i=function(){function n(n,t,i,r){this.$scope=n;this.$rootScope=t;this.$element=i;this.$transclude=r;n.CloseTooltipInfo=function(){n.ExpandTooltipInfo=!1};n.OpenTooltipInfo=function(){n.ExpandTooltipInfo=!0;t.ScrollIntoView(i)};n.ToggleTooltipInfo=function(){n.ExpandTooltipInfo?n.CloseTooltipInfo():n.OpenTooltipInfo()};r(function(t){n.content=angular.element("<div>").append(t).html()})}return n.$inject=["$scope","$rootScope","$element","$transclude"],n}(),t;n.TooltipController=i;t=function(){function t(){this.scope={};this.template="<i class='{{className}}' data-ng-click='ToggleTooltipInfo()' data-ng-class='{Expanded: ExpandTooltipInfo}' data-ng-mouseenter='OpenTooltipInfo()' data-ng-mouseleave='CloseTooltipInfo()'><span>i<\/span><div class='InfoPanel'><div class='RotatedCaret45'><\/div><div data-ng-bind-html='content'><\/div><\/div><\/i>";this.restrict="E";this.replace=!1;this.transclude=!0;this.controller=n.TooltipController;this.link=function(n,t,i){n.className=i.classname}}return t.instance=function(){return function(){return new t}},t}();n.TooltipDirective=t}(TooltipModule||(TooltipModule={}));app.directive("tooltip",TooltipModule.TooltipDirective.instance());app.directive("viewmore",[ViewmoreDirective]);app.filter("noFractionCurrency",["$filter","$locale",function(n,t){var i=n("currency"),r=t.NUMBER_FORMATS;return function(n,t){var u=i(n,t),f=u.indexOf(r.DECIMAL_SEP);return n>=0?u.substring(0,f):u.substring(0,f)+")"}}]);app.filter("dayrange",function(){return function(n,t){var u=isNaN(t)?1:parseInt(t),r=31,i;switch(u){case 2:r=29;break;case 4:case 6:case 9:case 11:r=30}for(i=1;i<=r;i++)n.push(i);return n}});app.filter("htmlIsSafe",["$sce",function(n){return function(t){return n.trustAsHtml(t)}}]);app.filter("telephone",function(){return function(n){if(!n)return"";var t=n.toString().trim().replace(/^\+/,""),i="";return t.length>0&&(i=t.slice(0,3)),t.length>=4&&(i+="-"+t.slice(3,6)),t.length>=7&&(i+="-"+t.slice(6,10)),i}});app.filter("unique",[function(){return function(n,t){var i=[],r=[];return angular.forEach(n,function(n){var u=n[t];r.indexOf(u)===-1&&(r.push(u),i.push(n))}),i}}]),function(n){n[n.Add=0]="Add";n[n.Remove=1]="Remove"}(ApplyCouponType||(ApplyCouponType={})),function(n){n[n.None=0]="None";n[n.StandardCoupon=1]="StandardCoupon";n[n.DoesNotExist=2]="DoesNotExist";n[n.Expired=6]="Expired";n[n.SingleUseOnly=3]="SingleUseOnly";n[n.SpecificToEmailAddr=4]="SpecificToEmailAddr";n[n.SpecificToEmailAddrSc2=5]="SpecificToEmailAddrSc2";n[n.CustomerMustBeAttached=7]="CustomerMustBeAttached";n[n.CustomerMustBeUnAttached=8]="CustomerMustBeUnAttached";n[n.CustomerMustHaveSpecificShippingZipCode=11]="CustomerMustHaveSpecificShippingZipCode"}(CouponValidationCode||(CouponValidationCode={}));AddressHelper=function(){function n(){}return n.MapAddressIntoMyAddress=function(n,t){var i,r;return t===void 0&&(t=null),i=null,n.Zip!=null&&(i=n.Zip.substring(0,5)),r=n.PhoneNumber,t!==null&&(r={FullNumber:t,Area:"",Number:"",Prefix:""}),{Address1:n.Address1,Address2:n.Address2,City:n.City,Province:n.Province,PostalCode:n.PostalCode,CityStateFormatted:n.CityStateFormatted,Country:n.Country,FirstName:n.FirstName,LastName:n.LastName,PhoneNumber:r,State:n.State,Type:n.Type,Zip:{Code:i},Name:n.Name,Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.CreateEmptyAddressModel=function(){return{Address1:"",Address2:"",City:"",Province:"",PostalCode:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",FullNumber:"",Number:"",Prefix:""},State:"",Type:0,Zip:"",Name:"",Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.CreateEmptyMyAddressModel=function(){return{Address1:"",Address2:"",City:"",Province:"",PostalCode:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",FullNumber:"",Number:"",Prefix:""},State:"",Type:0,Zip:{Code:""},Name:"",Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n}(),function(n){n[n.Inactive=0]="Inactive";n[n.Active=1]="Active";n[n.Suspended=2]="Suspended";n[n.UserDeleted=3]="UserDeleted";n[n.CustomerServiceDeleted=4]="CustomerServiceDeleted";n[n.AvailableSoon=5]="AvailableSoon"}(AutoReplenishStatusCode||(AutoReplenishStatusCode={}));AutoReplenishStatusCodeHelper=function(){function n(){}return n.IsActive=function(t){return n.ActiveOrSuspendedStatuses.indexOf(t)>-1},n.IsInactive=function(t){return n.InactiveStatuses.indexOf(t)>-1},n.ActiveOrSuspendedStatuses=[AutoReplenishStatusCode.Active,AutoReplenishStatusCode.Suspended,AutoReplenishStatusCode.AvailableSoon],n.InactiveStatuses=[AutoReplenishStatusCode.Inactive,AutoReplenishStatusCode.UserDeleted,AutoReplenishStatusCode.CustomerServiceDeleted],n}(),function(n){n[n.None=0]="None";n[n.Updating=1]="Updating";n[n.UpdateSuccess=2]="UpdateSuccess"}(CreditCardUpdateStatus||(CreditCardUpdateStatus={})),function(n){n[n.None=0]="None";n[n.Home=1]="Home";n[n.Category=2]="Category";n[n.Subcategory=3]="Subcategory";n[n.Search=4]="Search";n[n.SearchTerm=5]="SearchTerm";n[n.Brand=6]="Brand";n[n.ProductName=7]="ProductName"}(BreadcrumbTypes||(BreadcrumbTypes={})),function(n){n[n.None=-1]="None";n[n.RegistrationViaCheckout=0]="RegistrationViaCheckout";n[n.PaymentPageModal=1]="PaymentPageModal";n[n.AttachRep=2]="AttachRep";n[n.EmailSignUp=4]="EmailSignUp";n[n.Registration=6]="Registration";n[n.MyPreferencesPage=7]="MyPreferencesPage";n[n.ForcedAttachmentConfirmation=9]="ForcedAttachmentConfirmation";n[n.RegistrationViaSweepstakes=12]="RegistrationViaSweepstakes";n[n.RegistrationViaAffiliate=13]="RegistrationViaAffiliate";n[n.AndroidMobileAppCreateCustomer=23]="AndroidMobileAppCreateCustomer";n[n.ApplePhoneMobileAppCreateCustomer=24]="ApplePhoneMobileAppCreateCustomer";n[n.ContactMePage=25]="ContactMePage";n[n.SignUpPopup=36]="SignUpPopup";n[n.Unknown=37]="Unknown"}(EmailSubscriptionSource||(EmailSubscriptionSource={})),function(n){n[n.None=0]="None";n[n.Featured=1]="Featured";n[n.Category=2]="Category";n[n.Brand=3]="Brand"}(ProductCategorySection||(ProductCategorySection={})),function(n){n[n.Level1=0]="Level1";n[n.Level2=1]="Level2";n[n.PDept=2]="PDept";n[n.Dept=3]="Dept"}(Level||(Level={})),function(n){n[n.None=0]="None";n[n.Default=1]="Default";n[n.Price=2]="Price";n[n.Rating=3]="Rating";n[n.Name=4]="Name";n[n.Relevance=5]="Relevance";n[n.Discount=6]="Discount";n[n.SearchRelevance=7]="SearchRelevance"}(SortOption||(SortOption={})),function(n){n[n.Celebros=0]="Celebros";n[n.Content=1]="Content";n[n.Default=2]="Default"}(SearchTermType||(SearchTermType={}));SliderFacetModelNames=function(){function n(){}return n.discountLevelModel="discountLevelModel",n.priceRangeModel="priceRangeModel",n}(),function(n){n[n.English=1]="English";n[n.Spanish=2]="Spanish"}(Language||(Language={})),function(n){n[n.Desktop=0]="Desktop";n[n.Mobile=1]="Mobile";n[n.Tablet=2]="Tablet"}(Platform||(Platform={})),function(n){n[n.Youtube=0]="Youtube";n[n.BrightCove=1]="BrightCove"}(VideoType||(VideoType={})),function(n){n[n.EntryScreen=0]="EntryScreen";n[n.QuestionScreen=1]="QuestionScreen";n[n.ResultsScreen=2]="ResultsScreen"}(QuizScreenType||(QuizScreenType={}));TrackingAddToCartType=function(){function n(){}return n.TrackingAddToCartType="",n.SearchResultsQuickshop="quickshop search results",n.ProductCategory="quick shop category",n.BrochureQuickshop="quickshop brochure",n.ProductDetailPage="product detail page",n.ProductDetailQuickshop="quickshop homepage",n.ProductDetailPageQuickShopModal="quick shop product detail",n.BlogQuickShop="blog",n.OrderHistoryQuickShop="order history",n.SkinCareAdvisor="skin care advisor app",n.WishListShared="wishlist-shared",n.WishListPersonal="wishlist-personal",n.ShopByProductNumber="shop by product number",n.ProductLinePage="product line",n.Causes="causes",n.Bag="bag",n}(),function(n){n[n.QuickShopProductView=0]="QuickShopProductView";n[n.ProductImageView=1]="ProductImageView";n[n.FarLocateMyRep=2]="FarLocateMyRep";n[n.FarRecommendaRep=3]="FarRecommendaRep";n[n.HowMayIAssistThankYou=4]="HowMayIAssistThankYou";n[n.SearchResults=5]="SearchResults";n[n.EmailConfirmMsg=6]="EmailConfirmMsg";n[n.CartNewCustAcct=9]="CartNewCustAcct";n[n.CartViewBag=10]="CartViewBag";n[n.CartViewBagSignInModal=11]="CartViewBagSignInModal";n[n.CartViewBagPayPalModal=12]="CartViewBagPayPalModal";n[n.CartViewBagPayPalContinue=13]="CartViewBagPayPalContinue";n[n.CartViewBagPayPalCancel=14]="CartViewBagPayPalCancel";n[n.CartViewBagCheckoutButtonClick=18]="CartViewBagCheckoutButtonClick";n[n.CartViewBagPayPalButtonClick=19]="CartViewBagPayPalButtonClick";n[n.CartCheckout1=21]="CartCheckout1";n[n.CartCheckout2=22]="CartCheckout2";n[n.EmailPopupServed=23]="EmailPopupServed";n[n.EmailPopupSubscribed=24]="EmailPopupSubscribed";n[n.LoginSuccessful=25]="LoginSuccessful";n[n.ForgotPassword=26]="ForgotPassword";n[n.ShopbyProductNumber=27]="ShopbyProductNumber";n[n.ShopbyProductNumberSearchResults=28]="ShopbyProductNumberSearchResults";n[n.RegistrationFullPage=29]="RegistrationFullPage";n[n.UpdateItemInBag=30]="UpdateItemInBag";n[n.WishListItemsAdded=31]="WishListItemsAdded";n[n.WishListShared=32]="WishListShared"}(TrackingEventType||(TrackingEventType={})),function(n){var t=function(n){function t(t,i,r){var u=this;n.call(this,t,i,r);this.$rootScope=t;this.GetAnalyticsAttributeValue=function(n,t){for(var r,f=[],i=0,e=t;i<e.length;i++)r=e[i],r&&f.push(u.CleanNavigationCaption(r.toLocaleLowerCase()));return n+":"+f.join(">")}}return __extends(t,n),t.prototype.CleanNavigationCaption=function(n){for(var r,u=[],i=0,f=n;i<f.length;i++)r=f[i],t.IsLetterOrDigit(r)&&u.push(r);return u.join("")},t.IsLetterOrDigit=function(n){return t.IsDigit(n)||t.IsLetter(n)},t.IsDigit=function(n){return!isNaN(parseInt(n,10))},t.IsLetter=function(n){return n.toLowerCase()!=n.toLocaleUpperCase()},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.AnalyticsService=t}(AnalyticsServiceModule||(AnalyticsServiceModule={}));app.service("analyticsService",AnalyticsServiceModule.AnalyticsService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.$http=i;this.$q=r;this.sessionService=u}return __extends(t,n),t.prototype.IsSubscribedToProductWithSku=function(n){for(var u,t=!1,i=0,r=this.$rootScope.Session.AutoReplenishSubscriptions;i<r.length;i++)if(u=r[i],t=_.any(u.Products,function(t){return t.Product&&t.Sku==n&&AutoReplenishStatusCodeHelper.IsActive(t.StatusId)}),t)break;return t},t.prototype.IsSubscribedToProductWithProductId=function(n){for(var u,t=!1,i=0,r=this.$rootScope.Session.AutoReplenishSubscriptions;i<r.length;i++)if(u=r[i],t=_.any(u.Products,function(t){return t.Product&&t.Product.Id==n&&AutoReplenishStatusCodeHelper.IsActive(t.StatusId)}),t)break;return t},t.prototype.HasSubscriptionWithFrequency=function(n){return _.any(this.$rootScope.Session.AutoReplenishSubscriptions,function(t){return t.Frequency==n&&_.any(t.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)})})},t.prototype.HasSubscriptionWithCreditCard=function(n){return _.any(this.$rootScope.Session.AutoReplenishSubscriptions,function(t){return t.CreditCardId==n&&_.any(t.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)})})},t.prototype.HasActiveSubscriptions=function(){for(var r,n=!1,t=0,i=this.$rootScope.Session.AutoReplenishSubscriptions;t<i.length;t++)if(r=i[t],n=_.any(r.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)}),n)break;return n},t.prototype.HasActiveHazardousSubscriptions=function(){for(var r,n=!1,t=0,i=this.$rootScope.Session.AutoReplenishSubscriptions;t<i.length;t++)if(r=i[t],n=_.any(r.Products,function(n){return n.Product&&n.Product.IsHazardous&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)}),n)break;return n},t.prototype.AreAllSubscriptionsHazardous=function(){var r=!1,t,n,i,u;if(this.HasActiveSubscriptions()){for(n=0,i=this.$rootScope.Session.AutoReplenishSubscriptions;n<i.length;n++)if(u=i[n],t=_.any(u.Products,function(n){return n.Product&&!n.Product.IsHazardous&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)}),t)break;r=!t}return r},t.prototype.GetActiveSubscriptionsProductIds=function(){var n=_.flatten(_.pluck(this.$rootScope.Session.AutoReplenishSubscriptions,"Products")),t=_.filter(n,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)});return _.unique(_.map(n,function(n){return n.Product.Id}))},t.prototype.GetProductSubscriptionFrequency=function(n){for(var i,f,r=null,t=0,u=this.$rootScope.Session.AutoReplenishSubscriptions;t<u.length;t++)if(i=u[t],f=_.any(i.Products,function(t){return t.Product&&t.Sku==n&&AutoReplenishStatusCodeHelper.IsActive(t.StatusId)}),f){r=i.Frequency;break}return r},t.prototype.GetNextShipmentDateByFrequency=function(n){var t=null,r=this.GetActiveSubscriptions(),i=_.find(r,function(t){return t.Frequency==n});return i&&(t=this.ConvertToDate(i.NextShipmentDate)),t},t.prototype.GetActiveSubscriptions=function(){return _.filter(this.$rootScope.Session.AutoReplenishSubscriptions,function(n){return _.any(n.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)})})},t.prototype.GetCancelledSubscriptions=function(){return _.filter(this.$rootScope.Session.AutoReplenishSubscriptions,function(n){return _.any(n.Products,function(n){return AutoReplenishStatusCodeHelper.IsInactive(n.StatusId)})})},t.prototype.ConvertToDate=function(n){var r,i;return typeof n=="string"?(i=t.MicrosoftDateFormatRegex.exec(n),r=i&&i[1]?new Date(+i[1]):new Date(n)):r=n instanceof Date?new Date(n.getTime()):null,r},t.$inject=["$rootScope","$http","$q","sessionService"],t.MicrosoftDateFormatRegex=/\/Date\((\d+)\)\//,t}(BaseAvonService);n.AutoReplenishService=t}(AutoReplenishModule||(AutoReplenishModule={}));app.service("autoReplenishService",AutoReplenishModule.AutoReplenishService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.Initialize=function(){return{ShowComments:!1,UseWebSessionId:!1,dopost:!1,customerid:"Avon",issecured:!0}},t.prototype.LogSearchResult=function(n){window.CelebrosAnalytics&&(this.MapAnalyticData(n),window.CelebrosAnalytics.AI_LogSearchResult())},t.prototype.LogProductResult=function(n){window.CelebrosAnalytics&&(this.MapAnalyticData(n),window.CelebrosAnalytics.AI_LogProduct())},t.prototype.MapAnalyticData=function(n){_.extend(window.CelebrosAnalytics,n)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.CelebrosService=t}(CelebrosServiceModule||(CelebrosServiceModule={}));app.service("celebrosService",CelebrosServiceModule.CelebrosService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.ChangeRepDesktop=function(n,i,r){this.PostJson("/api/login/changerepdesktop",{repId:n,returnUrl:i,redirect:r}).success(function(n){n&&t.rootScope.$broadcast("ChangeRepService.ChangeRepDesktop",n)})},t.prototype.ChangeRepMobile=function(n,i){this.PostJson("/api/login/changerepmobile",{useDbRep:!1,repId:n,returnUrl:i}).success(function(n){n&&t.rootScope.$broadcast("ChangeRepService.ChangeRepMobile",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ChangeRepService=t}(ChangeRepServiceModule||(ChangeRepServiceModule={}));app.service("changeRepService",ChangeRepServiceModule.ChangeRepService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.register=function(n,i){this.PostJson("/api/login/registerguestshopper",n,i).success(function(n){n!==null&&t.rootScope.$broadcast("ConfirmationService.RegisterResponse",n)}).error(function(n){t.rootScope.$broadcast("ConfirmationService.RegisterResponse",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ConfirmationService=t}(ConfirmationServiceModule||(ConfirmationServiceModule={}));app.service("confirmationService",ConfirmationServiceModule.ConfirmationService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.SendContactRequest=function(n,i){this.PostJson("/api/contact/contactmeform",{contactMeFormData:n,recaptchaEncodedResponse:i}).success(function(n){n!==null&&t.rootScope.$broadcast("ContactService.ContactRequestResponse",n)}).error(function(n){t.rootScope.$broadcast("ContactService.ContactRequestResponse",n)})},t.prototype.SaveContactPreferences=function(n,i){n.Source=i;this.PostJson("/api/contact/customercontactpreferencessave",n).success(function(n){n!==null&&(AVON.customerContactPreferences=n.Data,t.rootScope.$broadcast("ContactService.PreferencesUpdated",n))})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ContactService=t}(ContactServiceModule||(ContactServiceModule={}));app.service("contactService",ContactServiceModule.ContactService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.SaveMyAddresses=function(n,i,r,u){this.PostJson("/api/customer/updatemyaddresses",{addresses:n,saveInDatabase:i,isRequestFromBillingAndShippingPage:r,isFirstTime:u}).success(function(n){n!==null&&t.rootScope.$broadcast("CustomerService.UpdateAddress",n)}).error(function(n){t.rootScope.$broadcast("CustomerService.UpdateAddress",n)})},t.prototype.RegisterLead=function(n){this.PostJson("/api/customer/registerlead",{lead:n}).success(function(n){n!==null&&t.rootScope.$broadcast("CustomerService.RegisterLead",n)}).error(function(n){t.rootScope.$broadcast("CustomerService.RegisterLead",n)})},t.prototype.RefreshAddressFromPayPal=function(){this.PostJson("/api/customer/refreshcustomerpaypaladdress",{}).success(function(n){n!==null&&t.rootScope.$broadcast("CustomerService.RefreshPayPalAddress",n)}).error(function(n){t.rootScope.$broadcast("CustomerService.RefreshPayPalAddress",n)})},t.prototype.DiscontinueAllAutoReplenishmentProducts=function(){this.PostJson("/api/myaccount/autoreplenishmentdiscontinueall",{}).success(function(n){n!==null&&t.rootScope.$broadcast("MyAccountService.DiscontinueAllAutoReplenishmentProducts",n)}).error(function(n){t.rootScope.$broadcast("MyAccountService.DiscontinueAllAutoReplenishmentProducts",n)})},t.prototype.DiscontinueHazmatAutoReplenishmentProducts=function(){this.PostJson("/api/myaccount/autoreplenishmentdiscontinuehazmats",{}).success(function(n){n!==null&&t.rootScope.$broadcast("MyAccountService.DiscontinueHazmatAutoReplenishmentProducts",n)}).error(function(n){t.rootScope.$broadcast("MyAccountService.DiscontinueHazmatAutoReplenishmentProducts",n)})},t.prototype.ShowRestrictedStateInline=function(n){t.rootScope.$broadcast("MyAccountService.ShowRestrictedStateInline",n)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.CustomerService=t}(CustomerServiceModule||(CustomerServiceModule={}));app.service("customerService",CustomerServiceModule.CustomerService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.reDrawAllIcons=function(){try{window.FB&&window.FB.XFBML&&window.FB.XFBML.parse()}catch(n){}},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.FacebookService=t}(FacebookServiceModule||(FacebookServiceModule={}));app.service("facebookService",FacebookServiceModule.FacebookService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.modalService=u}return __extends(t,n),t.prototype.StartShoppingFundraiser=function(n){return this.PostJson("/api/fundraiser/startshopping",{fundraiserVanityName:n},null,!1).error(function(){})},t.prototype.StopShoppingFundraiser=function(){return this.PostJson("/api/fundraiser/stopshopping",{},null,!1).error(function(){})},t.prototype.RefreshIdentityFundraiser=function(){return this.PostJson("/api/fundraiser/refreshidentityfundraiser",{}).error(function(){}).then(function(n){return n.data.Data})},t.prototype.DisplayFundraiserHasEndedModel=function(){this.modalService.ShowModalUrl("/api/fundraiser/getfundraiserhasendedmodal")},t.ServiceName="fundraiserService",t.$inject=["$rootScope","$http","$q","modalService"],t}(BaseAvonService);n.FundraiserService=t}(FundraiserModule||(FundraiserModule={}));app.service(FundraiserModule.FundraiserService.ServiceName,FundraiserModule.FundraiserService),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r)}return __extends(t,n),t.prototype.getRepresentativeDetails=function(){return this.GetJson("/myavon/api/getrepresentativestoredetails",!0)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.GeminiRepDetailsService=t}(OnlineStoreModule||(OnlineStoreModule={}));app.service("geminiRepDetailsService",OnlineStoreModule.GeminiRepDetailsService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$window=u}return __extends(t,n),Object.defineProperty(t.prototype,"state",{get:function(){return this.$window.history.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsPushStateSupported",{get:function(){return this.$window.history.pushState?!0:!1},enumerable:!0,configurable:!0}),t.prototype.PushStateUrl=function(n){this.$window.history.pushState(this.state,"",n)},t.prototype.PushState=function(n,t,i,r){i===void 0&&(i=null);r===void 0&&(r=null);var u=this.mergeWithCurrentState(n,t);this.$window.history.pushState(u,i,r)},t.prototype.ReplaceStateUrl=function(n){this.$window.history.replaceState(this.state,"",n)},t.prototype.GetStateData=function(n){return this.state==null?null:this.state[n]},t.prototype.ReplaceState=function(n,t,i){i===void 0&&(i=null);var r=this.mergeWithCurrentState(n,t);this.$window.history.replaceState(r,"",i)},t.prototype.OnPopState=function(n,t){this.$window.addEventListener("popstate",function(i){var r={state:i.state[n],originalEvent:i};t(r)})},t.prototype.Back=function(n){this.$window.history.back(n)},t.prototype.Forward=function(n){this.$window.history.forward(n)},t.prototype.Go=function(n){this.$window.history.go(n)},t.prototype.mergeWithCurrentState=function(n,t){var r={},i=this.state,u;if(i&&typeof i!="string")for(u in i)r[u]=i[u];return r[n]=t,r},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.HistoryService=t}(HistoryServiceModule||(HistoryServiceModule={}));app.service("historyService",HistoryServiceModule.HistoryService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.GetActiveCampaigns=function(){this.GetJson("/api/getactivecampaigns",!0,!1,!1).then(function(n){n.ErrorCode===AjaxError.None&&t.rootScope.$broadcast("LpmContextMenuService.ActiveCampaignsReceived",n)})},t.prototype.GetActiveLookup=function(){this.GetJson("/api/lookups",!0,!1,!1).then(function(n){n.ErrorCode===AjaxError.None&&t.rootScope.$broadcast("LpmContextMenuService.ActiveLookupReceived",n)})},t.prototype.GetEnvironmentInfo=function(){this.GetJson("/api/environmentInfo",!0,!1,!1).then(function(n){n.ErrorCode===AjaxError.None&&t.rootScope.$broadcast("LpmContextMenuService.EnvironmentInfoReceived",n)})},t.prototype.SetCampaign=function(n,t){this.PostJson("/admin/campaign",{id:n,redirectUrl:t})},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.LpmContextMenuService=t}(LpmContextMenuServiceModule||(LpmContextMenuServiceModule={}));app.service("LpmContextMenuService",LpmContextMenuServiceModule.LpmContextMenuService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.GetMobileTopNavigationItems=function(){var n=this;t.rootScope.SessionService.WhenReady().then(function(){var r=AVON.languageId,u=AVON.campaign,i;r||(r=$("html").attr("lang").substr(0,2)==="es"?2:1);u||(u=t.rootScope.Session.Customer.Campaign);i="/api/category/topmenuitemsmobile";i+="?language="+r;i+="&campaign="+u;i+="&attached="+t.rootScope.Session.Customer.IsAttached;i+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;n.GetJson(i,!0,!1,!1).then(function(n){t.rootScope.$broadcast("NavigationService.MobileMenuLoaded",n)})})},t.prototype.GetTopNavigationCategories=function(){var n=this;t.rootScope.SessionService.WhenReady().then(function(){var i="/api/category/topmenuitems";i+="?language="+AVON.languageId;i+="&campaign="+AVON.campaign;i+="&attached="+t.rootScope.Session.Customer.IsAttached;i+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;n.GetJson(i,!0,!0,!1).then(function(n){t.rootScope.$broadcast("NavigationService.MenuLoaded",n)})})},t.prototype.GetFeaturedBrands=function(){var n=this;t.rootScope.SessionService.WhenReady().then(function(){n.GetJson("/api/category/featuredBrands",!0,!0,!1).then(function(){})})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.NavigationService=t}(NavigationModule||(NavigationModule={}));app.service("NavigationService",NavigationModule.NavigationService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.modalService=u}return __extends(t,n),t.prototype.NotifyMe=function(n){var i=this;return this.PostJson("/api/product/notifymemodal",n).then(function(n){return n!==null&&i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n.data),n.data.Data},function(n){i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n.data)})},t.prototype.NotifyMeQuickShop=function(n){var i=this;this.PostJson("/api/product/notifymemodal",n).success(function(n){n!==null&&i.$rootScope.$broadcast(t.NotifyMeQuickShopResponseBroadcastName,n)}).error(function(n){i.$rootScope.$broadcast(t.NotifyMeQuickShopResponseBroadcastName,n)})},t.prototype.OpenNotifyMeModal=function(n,t){var i,r;t===void 0&&(t=null);i=this.$rootScope.HomePageUrl+"product/notifymemodal?pfid="+n;t&&(i+="&fsc="+t);this.$rootScope.ShowLoading(AVON.messages.spinner_loading);r={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:i};this.modalService.ShowModalWithOptions("#ContentModal",r)},t.prototype.OpenNotifyMeModalSuccess=function(n){var i="/product/notifymemodalsuccess?lang="+n,t;this.$rootScope.ShowLoading(AVON.messages.spinner_loading);t={KeepLoaded:!0,AllowExit:!0,UrlToLoad:i};this.modalService.ShowModalWithOptions("#ContentModal",t)},t.$inject=["$rootScope","$http","$q","modalService"],t.NotifyMeResponseBroadcastName="NotifyMeService.NotifyMeResponse",t.NotifyMeQuickShopResponseBroadcastName="NotifyMeService.NotifyMeQuickShopResponse",t}(BaseAvonService);n.NotifyMeService=t}(NotifyMeSerivceModule||(NotifyMeSerivceModule={}));app.service("NotifyMeService",NotifyMeSerivceModule.NotifyMeService),function(n){var t=function(n){function t(t,i,r,u,f){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u;this.emailSignUpTrackingService=f}return __extends(t,n),t.prototype.register=function(n,t){var i=this;this.PostJson("/api/login/register",n,t).success(function(t){t!==null&&(t.ErrorCode!=AjaxError.None||n.IsGuestShopper||i.TrackRegisterEvent(n.mode,n.NotifySpecialOffers),i.$rootScope.$broadcast("RegistrationService.RegisterResponse",t))}).error(function(n){i.$rootScope.$broadcast("RegistrationService.RegisterResponse",n)})},t.prototype.getCustomerByEmail=function(n,t){var i=this;this.PostJson("/api/login/getCustomerByEmail",{email:n,saveInSession:t}).success(function(n){n!==null&&i.$rootScope.$broadcast("RegistrationService.RegisteredCustomerAsGuestResponse",n)}).error(function(n){i.$rootScope.$broadcast("RegistrationService.RegisteredCustomerAsGuestResponse",n)})},t.prototype.TrackRegisterEvent=function(n,t){if(this.trackingService.TrackEventItem({Type:TrackingEventType.CartNewCustAcct}),t){var i=n=="Checkout"?EmailSubscriptionSource.RegistrationViaCheckout:EmailSubscriptionSource.Registration;this.emailSignUpTrackingService.TrackEmailSignUp(i)}},t.$inject=["$rootScope","$http","$q","trackingService","emailSignUpTrackingService"],t}(BaseAvonService);n.RegistrationService=t}(RegistrationServiceModule||(RegistrationServiceModule={}));app.service("registrationService",RegistrationServiceModule.RegistrationService),function(n){var t=function(n){function t(i,r,u,f,e){n.call(this,i,r,u);this.$http=r;this.urlService=f;this.siteAreaService=e;this.searchTerm=this.getDefaultSearchTerm();this.searchContainsResults=!1;this.languagePrefix=AVON.LanguageCode==="es"?"/es/":"/";this.shopSearchActionUrl=""+this.getBaseUrl()+this.urlService.Action("Index","Search");this.blogSearchActionUrl=""+this.getBaseUrl()+this.languagePrefix+"blog/search/searchterm";this.searchPageLoading=!1;this.activeClass="active";this.celebrosSearchRegex={searchValue:/[^A-Za-z0-9]/g,replaceValue:"_"};this.suppliedSearchRegex={searchValue:/[^A-Za-z0-9_ ]/g,replaceValue:""};this.xmlToJson=new X2JS;this.maxNumberOfSuggestionsPerType=5;t.rootScope=i;this.CelebrosSearchEnabled=AVON.CelebrosSearchEnabled}return __extends(t,n),t.prototype.getDefaultSearchTerm=function(){return{value:"",type:SearchTermType.Default,resultObject:null}},t.prototype.languageCodePrefix=function(){return""},t.prototype.isSearchPageLoading=function(){return this.searchPageLoading},t.prototype.setSearchPageLoading=function(){this.searchPageLoading=!0},t.prototype.filterCelebrosSearchResults=function(n){return _.filter(n.AutoCompleteResultSet.SuggestionGroups.ArrayOfSug.sug,function(n){return n.r!=="0"})},t.prototype.mapCelebrosSearchSuggestions=function(n){return _.map(n,function(n){return{value:n.dc,id:n.r,type:SearchTermType.Celebros}})},t.prototype.getArticleResults=function(n){var t=this,i="/api/search/getarticlesbysearch/"+n,r={method:"GET",url:i,headers:{"Content-Type":"jsonp","X-Requested-With":"XMLHttpRequest"}},u=this.$http(r);return u.then(function(n){var r=[],u,o,i,f,e;if(t.searchContainsResults=r.length>0,u=n.data,u.Data)for(o=u.Data,i=0,f=o;i<f.length;i++)e=f[i],r.push({type:SearchTermType.Content,value:e.Title,resultObject:e});return r})},t.prototype.getCelebrosResults=function(n){var t=this,r,u,f,i;return this.CelebrosSearchEnabled?(r="https://avonv8-ac.celebros.com/AutoCompleteWebServiceV2/GetSuggestions.aspx?strPrefix="+n+"&strSiteKey=AvonV8",u=$.ajax({url:r,dataType:"jsonp"}),u.then(function(n){var i=[],f=n.data,r=t.xmlToJson.xml_str2json(f),u;return r.AutoCompleteResultSet.Succeeded==="true"&&(u=t.filterCelebrosSearchResults(r),i=t.mapCelebrosSearchSuggestions(u)),t.searchContainsResults=i.length>0,i})):(f=[],i=jQuery.Deferred(),i.resolve(f),i)},t.prototype.sanitizeSearchTerm=function(n,t){return n.replace(t.searchValue,t.replaceValue)},t.prototype.getShopSearchPageUrl=function(n,t){var i,r;return t.value?(i=this.sanitizeSearchTerm(t.value,this.celebrosSearchRegex),r=this.shopSearchActionUrl+"/"+i+"?cel_id="+n+"%7CT_"+i):(i=this.sanitizeSearchTerm(n,this.suppliedSearchRegex),r=this.shopSearchActionUrl+"/"+i),r},t.prototype.getBlogSearchPageUrl=function(n,t){var i=this.sanitizeSearchTerm(n,this.suppliedSearchRegex);return t.value?this.blogSearchActionUrl+"/"+n+"?cel_id="+n:this.blogSearchActionUrl+"/"+n},t.prototype.processSuppliedSearchTerm=function(n){var t=this.sanitizeSearchTerm(n,this.suppliedSearchRegex);return this.shopSearchActionUrl+"/"+t+"?cel_id="+t.substring(0,1)},t.prototype.processSelectedSearchTermByType=function(n,t){var i,r;t===void 0&&(t={value:"",type:SearchTermType.Default,resultObject:null});this.setSearchPageLoading();r=this.siteAreaService.GetCurrentSiteArea();switch(r){case AvonSiteArea.Shop:i=this.getShopSearchPageUrl(n.value,t);break;case AvonSiteArea.Blog:i=this.getBlogSearchPageUrl(n.value,t);break;default:i=this.processSuppliedSearchTerm(n.value)}return i},t.prototype.isMinimumInputLength=function(){return this.searchTerm.value.length>=1},t.$inject=["$rootScope","$http","$q","urlService","SiteAreaService"],t}(BaseAvonService);n.SearchService=t}(SearchServiceModule||(SearchServiceModule={}));app.service("searchService",SearchServiceModule.SearchService),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r)}return __extends(t,n),t.prototype.GetCurrentSiteArea=function(){return angular.element("html.Blog").length?AvonSiteArea.Blog:AvonSiteArea.Shop},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.SiteAreaService=t}(SiteAreaServiceModule||(SiteAreaServiceModule={}));app.service("SiteAreaService",SiteAreaServiceModule.SiteAreaService),function(n){var i=function(){function n(){}return n}(),t;n.SweepstakesFormData=i;t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.emailSignUpTrackingService=u}return __extends(t,n),t.prototype.SubmitSweepstakesForm=function(n,t){var i=this;this.PostJson("/api/sweepstakes/submit",{sweepstakesFormData:n,reCaptchaEncodedResponse:t}).success(function(n){i.$rootScope.$broadcast("SweepstakesService.SubmitSweepstakesForm",n);n&&i.emailSignUpTrackingService.TrackEmailSignUp(EmailSubscriptionSource.RegistrationViaSweepstakes)}).error(function(n){i.$rootScope.$broadcast("SweepstakesService.SubmitSweepstakesForm",n)})},t.$inject=["$rootScope","$http","$q","emailSignUpTrackingService"],t}(BaseAvonService);n.SweepstakesService=t}(SweepstakesModule||(SweepstakesModule={}));app.service("sweepstakesService",SweepstakesModule.SweepstakesService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u}return __extends(t,n),t.prototype.TrackItemsAddedToBag=function(n,t,i,r){for(var u,a,e=[],o=[],s=[],h=[],c=[],v=this.GetTrackingAddToBagFindingCategory(t),f=0,l=n;f<l.length;f++)u=l[f],s.push(u.Fsc),h.push(u.Sku),c.push(u.Quantity.toString()),e.push(u.ProductBusinessCategoryName.toLowerCase()),o.push(u.ProductBusinessUnitName.toLowerCase());this.trackingService.UTagData&&(this.trackingService.UTagData.cart_subtotal=i.toString(),this.trackingService.UTagData.cart_total_quantity=r.toString(),this.trackingService.UTagData.product_finding_method=t);a={event_name:"cart_add",product_fsc:s,product_sku:h,product_quantity:c,product_finding_method:t,product_finding_category:v,product_business_segment_name:e,product_business_unit_name:o};this.trackingService.TrackEvent(a)},t.prototype.GetTrackingAddToBagFindingCategory=function(n){var t,r=this.$rootScope.GetValueFromSessionStorage("AvonBreadcrumbs"),i,u,f,e;switch(n){case TrackingAddToCartType.ProductDetailQuickshop:t=r.length==1&&r[0].CrumbType==BreadcrumbTypes.Home?"homepage":""+this.GetFindingCategoryPath(!1);break;case TrackingAddToCartType.SearchResultsQuickshop:t="Search: results page";break;case TrackingAddToCartType.ProductCategory:t=""+this.GetFindingCategoryPath(!1);break;case TrackingAddToCartType.ProductDetailPage:if(i=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(product\/\S+?)(?:\?.*)?$/g.exec(document.referrer),i&&i.length){t="cross-sell-clickthru: "+i[1];break}if(u=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(?:\?.*)?$/g.exec(document.referrer),u&&u.length){t="homepage";break}if(f=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(products\/productline\/\S+?)(?:\?.*)?$/g.exec(document.referrer),f&&f.length){t="product line"+this.GetFindingProductLine();break}if(e=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(blog\/search\/searchterm\/\S+?)(?:\?.*)?$/g.exec(document.referrer),e&&e.length){t="blog search";break}t=_.any(r,function(n){return n.CrumbType==BreadcrumbTypes.SearchTerm})?"Search: product detail page":""+this.GetFindingCategoryPath(!1);break;case TrackingAddToCartType.ProductLinePage:t="product line"+this.GetFindingProductLine();break;case TrackingAddToCartType.ProductDetailPageQuickShopModal:t="cross-sell: "+this.GetFindingCategoryPath(!0);break;default:t=n}return t},t.prototype.GetFindingProductLine=function(){return this.$rootScope.GetValueFromSessionStorage("SelectedProductLineId")?" "+this.$rootScope.GetValueFromSessionStorage("SelectedProductLineId"):""},t.prototype.GetFindingCategoryPath=function(n){var t=this.$rootScope.GetValueFromSessionStorage("AvonBreadcrumbs");if(!t)return"";if(!n)while(!t[t.length-1].HasUrl)t.pop();return _.map(t,function(n){return n.Text}).splice(1).join("/")},t.$inject=["$rootScope","$http","$q","trackingService"],t}(BaseAvonService);n.AddToBagTrackingService=t}(TrackingServiceModule||(TrackingServiceModule={}));app.service("addToBagTrackingService",TrackingServiceModule.AddToBagTrackingService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u}return __extends(t,n),t.prototype.TrackEmailSignUp=function(n){var t={event_name:"email_signup",visitor_email_subscription_type:EmailSubscriptionSource[n]};this.trackingService.TrackEvent(t)},t.$inject=["$rootScope","$http","$q","trackingService"],t}(BaseAvonService);n.EmailSignUpTrackingService=t}(TrackingServiceModule||(TrackingServiceModule={}));app.service("emailSignUpTrackingService",TrackingServiceModule.EmailSignUpTrackingService),function(){String.prototype.isNullOrEmpty=function(){return this==null||this.length===0};String.prototype.isNullOrWhiteSpace=function(){return!this||this.match(/^\s*$/)};String.prototype.startsWith=function(n){return this.match("^"+n)===n};String.prototype.endsWith=function(n,t){"use strict";return t!==undefined&&t?n===this.substring(this.length-n.length):n.toLowerCase()===this.substring(this.length-n.length).toLowerCase()};String.prototype.replaceAll=function(n,t){for(var i=this,r=i.indexOf(n);r!==-1;)i=i.replace(n,t),r=i.indexOf(n);return i.toString()};String.prototype.removeLastOccurence=function(n){var t=this,i=t.lastIndexOf(n);return i>-1?t.substring(0,i):t};String.prototype.capitalize=function(n){return(n?this.toLowerCase():this).replace(/(?:^|\s)\S/g,function(n){return n.toUpperCase()})};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(StringExtensions||(StringExtensions={})),function(){Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var u=t||window,i=0,r=this.length;i<r;i+=1)n.call!==null&&n.call(u,this[i],i,this)})}(ArrayExtensions||(ArrayExtensions={})),function(n){var t=function(){function n(n,t,i){this.status=n;this.lat=t;this.lng=i}return n}(),i;n.GeocodeResult=t;i=function(){function n(){}return n.prototype.geocodeAddress=function(i,r,u,f){if(AVON.commonMvc.isQapEnvironment()){f(new t("OK",40.7121669,-73.9676956));return}AVON.Maps.loadGoogleMapsApi().done(function(){var e=[];i&&e.push(i);r&&(r=r.toUpperCase(),e.push(r));u&&e.push(u);var o=e.join(","),s={region:"US",address:o+",US"},h=new google.maps.Geocoder;h.geocode(s,function(e,o){var h,a,v,y,p;if(o==google.maps.GeocoderStatus.OK){var s=e[0],c=!1,l=!1;_.each(s.address_components,function(n){n.short_name==r?c=!0:n.short_name==u&&(l=!0)});h=!1;c&&l||i&&r&&u&&(i=null,h=!0);h?(a=new n,a.geocodeAddress(i,r,u,f)):(v=s.geometry.location.lat(),y=s.geometry.location.lng(),f(new t("OK",v,y)))}else p="Error: "+o,f(new t(p,0,0))})})},n}();n.GoogleGeocoder=i}(Geocode||(Geocode={}));ProductHelper=function(){function n(){}return n.DisplayVariantLineNumber=function(n,t){return!n.LineNumber||n.LineNumber=="000000"||n.LineNumber=="991025"||n.LineNumber.length<=3?"":(t?" - ":"")+n.LineNumber.substr(0,3)+"-"+n.LineNumber.substr(n.LineNumber.length-3)},n}();app.directive("validateAddress",validateAddress);app.directive("validateCity",validateCity),function(n){var t=function(){function n(){var n=this;this.simpleEmailAddressValidationRegex=/^\s*(?!.{254})([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)\s*$/;this.validateEmailList=function(t){return function(i){var f=0,r=!0,u;return i&&(u=n.getNonEmptyOrWhitespaceEmails(i),r=n.checkAllEmailsAreValid(u),f=u.length),r&&t.$setValidity("validateEmailList",r),t.$setValidity("validateMaxEmails",f<=n.maxNumberOfEmails),i}};this.checkAllEmailsAreValid=function(t){for(var f,r=!0,i=0,u=t;i<u.length;i++)if(f=u[i],!n.simpleEmailAddressValidationRegex.test(f)){r=!1;break}return r};this.getNonEmptyOrWhitespaceEmails=function(n){var u=[],f,t,i,r;if(n)for(f=n.split(/[,;]/),t=0,i=f;t<i.length;t++)r=i[t],r.isNullOrWhiteSpace()||u.push(r);return u};this.restrict="A";this.require="ngModel";this.link=function(t,i,r,u){n.maxNumberOfEmails=r.validateMaxEmails;i.on("blur",function(){var r=n.getNonEmptyOrWhitespaceEmails(i.val()),f=n.checkAllEmailsAreValid(r);u.$setValidity("validateEmailList",f);t.$apply()});u.$formatters.unshift(n.validateEmailList(u));u.$parsers.unshift(n.validateEmailList(u))}}return n.Factory=function(){return function(){return new n}},n}();n.ValidateEmailList=t}(Directives||(Directives={}));app.directive("validateEmailList",Directives.ValidateEmailList.Factory()),function(n){var t=function(){function n(){var n=this;this.validationRegex=/^[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\d\s\.\-!¡\""£$%^&*\(\)_\+€_-|\\,./\?\[\]{};:'@#~`¬¦¿\=]+$/;this.validateText=function(t){return function(i){var r=!i||n.validationRegex.test(i);return t.$setValidity("validateText",r),i}};this.restrict="A";this.require="ngModel";this.link=function(t,i,r,u){u.$formatters.unshift(n.validateText(u));u.$parsers.unshift(n.validateText(u))}}return n.Factory=function(){return function(){return new n}},n}();n.ValidateEnglishSpanishText=t}(Directives||(Directives={}));app.directive("validateText",Directives.ValidateEnglishSpanishText.Factory());app.directive("validateMustequalto",validateMustqqualto);app.directive("validateName",validateName),function(n){var t=function(){function n(){var n=this;this.validateTextNoUrl=function(n){return function(t){var i=!1,r=new RegExp("((((https?)(:)(/?/?))|(www\\.))[\\w]{1})","igm");return i=!t||!r.test(t),n.$setValidity("validateTextNoUrl",i),t}};this.restrict="A";this.require="ngModel";this.link=function(t,i,r,u){u.$formatters.unshift(n.validateTextNoUrl(u));u.$parsers.unshift(n.validateTextNoUrl(u))}}return n.Factory=function(){return function(){return new n}},n}();n.ValidateNoUrlsText=t}(Directives||(Directives={}));app.directive("validateNoUrls",Directives.ValidateNoUrlsText.Factory()),function(n){var t=function(){function n(){var n=this;this.validateNotAvailableSoonModel=function(n,t){return function(i){var r=!0,f=_.flatten(_.pluck(n.Product.VariantGroups,"Variants")),u;return i?(u=_.find(f,function(n){return n.Sku==i}),u&&u.Availability==CanBuy.AvailableSoon&&(r=!1)):n.Product.Availability==CanBuy.AvailableSoon&&(r=!1),t.$setValidity("availableSoon",r),i}};this.require="ng-model";this.restrict="A";this.scope={Product:"=validateNotAvailableSoon"};this.link=function(t,i,r,u){u.$formatters.unshift(n.validateNotAvailableSoonModel(t,u));u.$parsers.unshift(n.validateNotAvailableSoonModel(t,u))}}return n.Factory=function(){return function(t){return new n(t)}},n}();n.ValidateNotAvailableSoon=t}(ValidateNotAvailableSoonModule||(ValidateNotAvailableSoonModule={}));app.directive("validateNotAvailableSoon",["$rootScope",ValidateNotAvailableSoonModule.ValidateNotAvailableSoon.Factory()]);app.directive("validatePhone",validatePhone);app.directive("validateRegex",validateRegex),function(n){var t=function(){function n(n,t){var i=this;this.autoReplenishService=t;this.ValidateSkuNotSubscribedngModel=function(n,t){return function(n){var r=!0,u;return n&&(u=i.autoReplenishService.IsSubscribedToProductWithSku(n),r=u?!1:!0),t.$setValidity("skuNotSubscribed",r),n}};this.require="ng-model";this.restrict="A";this.link=function(n,t,r,u){u.$formatters.unshift(i.ValidateSkuNotSubscribedngModel(n,u));u.$parsers.unshift(i.ValidateSkuNotSubscribedngModel(n,u))}}return n.Factory=function(){return function(t,i){return new n(t,i)}},n}();n.ValidateSkuNotSubscribed=t}(ValidateSkuNotSubscribedModule||(ValidateSkuNotSubscribedModule={}));app.directive("validateSkuNotSubscribed",["$rootScope","autoReplenishService",ValidateSkuNotSubscribedModule.ValidateSkuNotSubscribed.Factory()]);app.directive("validateZipcode",validateZipcode),function(n){var t=function(){function n(n,t,i){return{restrict:"A",require:"ngModel",link:function(n,t,r,u){var f=t,e=function(n){n=n.toString();var r=!0;return t.addClass("LoadingImage"),$.ajax({async:!0,cache:!0,type:"GET",url:"/api/validation/validatezipandgetdetails/"+n,dataType:"json",success:function(n){n.zipDetails.IsValidZip||(r=!1);var u=t.parents(".billingAddress").length||t.context.id==="CheckoutStep1Model_BillingZipInput"||t.context.id==="CheckoutAddressesModel_BillingZipInput";i.$broadcast("AddressesScope.ZipCodeDetails",n.zipDetails,u);t.removeClass("LoadingImage")},error:function(){return t.removeClass("LoadingImage"),!0}}),r},o=function(n){var o=u.$name,r=!0,t,i;return(o==="CheckoutStep1Model_BillingZip"&&(t=f.closest("form"),t&&(i=t.find("input#SharedAddressDetailsInput"),i&&(r=!i[0].checked))),!n||n.length<5)?(u.$setValidity("validateZipcodeRecognized",!0),n):(r&&(e(n)?u.$setValidity("validateZipcodeRecognized",!0):u.$setValidity("validateZipcodeRecognized",!1)),n)};u.$parsers.unshift(o);u.$formatters.unshift(function(n){return u.$setValidity("validateZipcodeRecognized",!0),n})}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.ValidateZipCodeAndGetDetailsDirective=t}(ValidateZipCodeAndGetDetailsModule||(ValidateZipCodeAndGetDetailsModule={}));app.directive("validateZipcodeGetDetails",["$sce","$timeout","$rootScope",ValidateZipCodeAndGetDetailsModule.ValidateZipCodeAndGetDetailsDirective]);app.directive("validateZipcodeRecognized",validateZipCodeRecognized);validateZipCodeRecognized.$inject=["$http"];app.directive("validateZipcodeRequired",validateZipcodeRequired),function(n,t,i){function c(n){for(var i=n.attributes,r={},t=0;t<i.length;t++)i[t].specified&&!/^jQuery\d+/.test(i[t].name)&&(r[i[t].name]=i[t].value);return r}function e(){var t=n(this),i;if(t.is(":password")){f=!0;(t.val()==""||u&&t.val()==u)&&t.val("");t.removeClass("placeholder");return}t.data("password")?(i=t.next().show().focus(),n("label[for="+t.attr("id")+"]").attr("for",i.attr("id")),t.remove()):(u&&t.realVal()==u||t.realVal()==t.attr("placeholder"))&&(f=!0,t.val(""),t.removeClass("placeholder"))}function h(){var t=n(this),r,u=t.attr("placeholder"),i;n.trim(t.val()).length>0||(t.is(":password")?(i=t.attr("id")+"-clone",r=n("<input/>").attr(n.extend(c(this),{type:"text",value:u,"data-password":1,id:i})).addClass("placeholder"),t.before(r).hide(),n("label[for="+t.attr("id")+"]").attr("for",i)):(t.val(u),t.addClass("placeholder")))}var o="placeholder"in t.createElement("input"),s="placeholder"in t.createElement("textarea"),r=":input[placeholder]",f=!1,u=null;if(n.placeholder={input:o,textarea:s},!i&&o&&s){n.fn.placeholder=function(){};return}i||!o||s||(r="textarea[placeholder]");n.fn.realVal=n.fn.val;n.fn.val=function(){var t=n(this),i,r;return(r=t.attr("placeholder"),arguments.length>0)?(arguments[0]!==""&&arguments[0]!==null||f||(arguments[0]=r),f=!1,t.realVal.apply(this,arguments)):(i=t.realVal(),i==r?"":i)};n.fn.placeholder=function(){return this.filter(r).each(h),this};n.fn.changePlaceholder=function(n){return u=n,this.filter(r).each(e),u=null,this.filter(r).each(h),this};n.fn.removePasswordPlaceHolder=function(){u=null;this.filter(r).each(e)};n(function(n){var i=n(t);i.on("focus",r,e);i.on("blur",r,h);n(r).placeholder()})}(jQuery,document,window.debug)